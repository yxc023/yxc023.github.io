<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta property="og:type" content="website">
<meta property="og:title" content="æŠ€æœ¯è®°äº‹æœ¬">
<meta property="og:url" content="http://blog.yangxiaochen.com/index.html">
<meta property="og:site_name" content="æŠ€æœ¯è®°äº‹æœ¬">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="æŠ€æœ¯è®°äº‹æœ¬">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"right","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'åšä¸»'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://blog.yangxiaochen.com/"/>





  <title>æŠ€æœ¯è®°äº‹æœ¬</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">æŠ€æœ¯è®°äº‹æœ¬</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            é¦–é¡µ
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            å…³äº
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            å½’æ¡£
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            æ ‡ç­¾
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/07/18/gradleç®€æ˜æ•™ç¨‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/18/gradleç®€æ˜æ•™ç¨‹/" itemprop="url">gradleç®€æ˜æ•™ç¨‹</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-18T14:00:05+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ²¡æœ‰ gradle ä¸ maven å¯¹æ¯”ï¼Œä¹Ÿæ²¡æœ‰æ·±å…¥ gradle å®ç°ã€‚åªæœ‰ gradle ä» 0 å¼€å§‹ä½¿ç”¨çš„è¯´æ˜ã€‚</p>
<ul>
<li>ç®€ä»‹</li>
<li>å®‰è£…</li>
<li>æ–°å»ºä¸€ä¸ª gradle é¡¹ç›®</li>
<li>å¼•å…¥ä¸€ä¸ª gradle é¡¹ç›®</li>
<li>å¸¸è§é—®é¢˜</li>
<li>äº¤æµ</li>
</ul>
          <!--noindex-->
          <div class="post-button text-center">
            <a class="btn" href="/2017/07/18/gradleç®€æ˜æ•™ç¨‹/#more" rel="contents">
              é˜…è¯»å…¨æ–‡ &raquo;
            </a>
          </div>
          <!--/noindex-->
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/07/18/codeview/HashMap.java/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/18/codeview/HashMap.java/" itemprop="url">HashMap.java</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-18T14:00:05+08:00">
                2017-07-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="æ¦‚è¦"><a href="#æ¦‚è¦" class="headerlink" title="æ¦‚è¦"></a>æ¦‚è¦</h2><h3 id="å‰ç½®åŸºæœ¬çŸ¥è¯†"><a href="#å‰ç½®åŸºæœ¬çŸ¥è¯†" class="headerlink" title="å‰ç½®åŸºæœ¬çŸ¥è¯†"></a>å‰ç½®åŸºæœ¬çŸ¥è¯†</h3><p>æ•°æ®ç»“æ„: å“ˆå¸Œè¡¨(æ•£åˆ—è¡¨), äºŒå‰æŸ¥æ‰¾æ ‘, çº¢é»‘æ ‘(optional)</p>
<h3 id="åè¯"><a href="#åè¯" class="headerlink" title="åè¯"></a>åè¯</h3><ol>
<li>æ¡¶, æ§½: æ•£åˆ—ä½ç½®.</li>
<li>Entry, Node, TreeNode: Entryä¸ºä¸€ä¸ªé”®å€¼å¯¹, Nodeå’ŒTreeNodeéƒ½æ˜¯Entryçš„ä¸€ç§ç‰¹åˆ«ç±»å‹.</li>
</ol>
<h3 id="ç»“æ„"><a href="#ç»“æ„" class="headerlink" title="ç»“æ„"></a>ç»“æ„</h3><h4 id="åŸºæœ¬ç»“æ„"><a href="#åŸºæœ¬ç»“æ„" class="headerlink" title="åŸºæœ¬ç»“æ„"></a>åŸºæœ¬ç»“æ„</h4><ol>
<li>è”åˆ—è¡¨ç»“æ„, å†…éƒ¨ç»´æŠ¤ä¸€ä¸ª<code>Node&lt;Key, Value&gt;</code>æ•°ç»„, æ•°ç»„é•¿åº¦ä¸º2çš„å¹‚. æ•°ç»„é•¿åº¦ä¸ºhashæ¡¶æ•°é‡, ä¹Ÿç§°ä¸ºå®¹é‡(capacity), != size.</li>
<li>Nodeå¯¹è±¡é™¤äº†å«æœ‰key, valueå€¼, è¿˜æœ‰nextå€¼, æŒ‡å‘ä¸‹ä¸€ä¸ªè¢«æ•£åˆ—åœ¨åŒä¸€ä¸ªæ¡¶ä¸­çš„Entryå¯¹è±¡. æ‰€ä»¥æ¯ä¸ªæ¡¶ä¸­å¯ä»¥çœ‹åšä¸€ä¸ªé“¾è¡¨.</li>
<li>å½“ä¸€ä¸ªæ¡¶ä¸­çš„Nodeæ•°é‡å¤ªå¤š, é‚£ä¹ˆé“¾è¡¨ä¼šè½¬åŒ–ä¸ºTree, è¿™ä¸ªæ¡¶ä¸­çš„Nodeä¼šå˜ä¸ºTreeNode, æé«˜äº†å†²æ’åçš„æŸ¥è¯¢æ•ˆç‡.</li>
</ol>
<h3 id="ä¸»è¦æ–¹æ³•"><a href="#ä¸»è¦æ–¹æ³•" class="headerlink" title="ä¸»è¦æ–¹æ³•"></a>ä¸»è¦æ–¹æ³•</h3><ol>
<li>get()</li>
<li>put()</li>
<li>remove()</li>
<li>keySet()</li>
<li>values()</li>
</ol>
<h3 id="è¿›é˜¶"><a href="#è¿›é˜¶" class="headerlink" title="è¿›é˜¶"></a>è¿›é˜¶</h3><ol>
<li>æ ‘åŒ–</li>
<li>å®¹é‡ç­–ç•¥</li>
<li>hashç­–ç•¥</li>
<li>resizeç­–ç•¥</li>
</ol>
<h2 id="æºç æ³¨è§£"><a href="#æºç æ³¨è§£" class="headerlink" title="æºç æ³¨è§£"></a>æºç æ³¨è§£</h2><pre><code>package java.util;

import java.io.IOException;
import java.io.InvalidObjectException;
import java.io.Serializable;
import java.lang.reflect.ParameterizedType;
import java.lang.reflect.Type;
import java.util.function.BiConsumer;
import java.util.function.BiFunction;
import java.util.function.Consumer;
import java.util.function.Function;

/**
 * Hash table based implementation of the &lt;tt&gt;Map&lt;/tt&gt; interface.  This
 * implementation provides all of the optional map operations, and permits
 * &lt;tt&gt;null&lt;/tt&gt; values and the &lt;tt&gt;null&lt;/tt&gt; key.  (The &lt;tt&gt;HashMap&lt;/tt&gt;
 * class is roughly equivalent to &lt;tt&gt;Hashtable&lt;/tt&gt;, except that it is
 * unsynchronized and permits nulls.)  This class makes no guarantees as to
 * the order of the map; in particular, it does not guarantee that the order
 * will remain constant over time.
 *
 * keyå’Œvalueå¯ä»¥ä¸ºnull, æ˜¯HashTableçš„å»åŒæ­¥åŒ–ç‰ˆæœ¬. mapä¸­çš„é¡ºåºä¸å›ºå®š, å¹¶ä¸”å¯èƒ½ä¼šå˜åŒ–.
 *
 * &lt;p&gt;This implementation provides constant-time performance for the basic
 * operations (&lt;tt&gt;get&lt;/tt&gt; and &lt;tt&gt;put&lt;/tt&gt;), assuming the hash function
 * disperses the elements properly among the buckets.  Iteration over
 * collection views requires time proportional to the &quot;capacity&quot; of the
 * &lt;tt&gt;HashMap&lt;/tt&gt; instance (the number of buckets) plus its size (the number
 * of key-value mappings).  Thus, it&apos;s very important not to set the initial
 * capacity too high (or the load factor too low) if iteration performance is
 * important.
 *
 * åœ¨æ•£åˆ—çš„æ¯”è¾ƒå¼€çš„æƒ…å†µä¸‹æä¾›äº†å¸¸æ•°æ—¶é—´å¤æ‚åº¦çš„æ“ä½œ,
 * éå†è¿™ä¸ªmapçš„æ—¶é—´æ­£æ¯”äºå®¹é‡(hashæ§½çš„æ•°é‡)+é”®å€¼å¯¹æ•°é‡.
 * æ‰€ä»¥ä¸è¦æŠŠåˆå§‹å®¹é‡è®¾çš„å¤ªå¤§ä»¥åŠè®©è´Ÿè½½å› å­å¤ªå°
 *
 * &lt;p&gt;An instance of &lt;tt&gt;HashMap&lt;/tt&gt; has two parameters that affect its
 * performance: &lt;i&gt;initial capacity&lt;/i&gt; and &lt;i&gt;load factor&lt;/i&gt;.  The
 * &lt;i&gt;capacity&lt;/i&gt; is the number of buckets in the hash table, and the initial
 * capacity is simply the capacity at the time the hash table is created.  The
 * &lt;i&gt;load factor&lt;/i&gt; is a measure of how full the hash table is allowed to
 * get before its capacity is automatically increased.  When the number of
 * entries in the hash table exceeds the product of the load factor and the
 * current capacity, the hash table is &lt;i&gt;rehashed&lt;/i&gt; (that is, internal data
 * structures are rebuilt) so that the hash table has approximately twice the
 * number of buckets.
 *
 * å½±å“HashMapæ€§èƒ½çš„ä¸¤ä¸ªå‚æ•°: åˆå§‹å®¹é‡ä¸è´Ÿè½½å› å­.
 * å½“entriesæ•°é‡è¶…è¿‡è´Ÿè½½å, HashMapä¼šrehashed, å³å†…éƒ¨æ•°æ®ç»“æ„é‡å»º, å®¹é‡å˜ä¸ºä¸¤å€
 *
 * &lt;p&gt;As a general rule, the default load factor (.75) offers a good
 * tradeoff between time and space costs.  Higher values decrease the
 * space overhead but increase the lookup cost (reflected in most of
 * the operations of the &lt;tt&gt;HashMap&lt;/tt&gt; class, including
 * &lt;tt&gt;get&lt;/tt&gt; and &lt;tt&gt;put&lt;/tt&gt;).  The expected number of entries in
 * the map and its load factor should be taken into account when
 * setting its initial capacity, so as to minimize the number of
 * rehash operations.  If the initial capacity is greater than the
 * maximum number of entries divided by the load factor, no rehash
 * operations will ever occur.
 *
 * ä¸€èˆ¬æ¥è¯´è´Ÿè½½å› å­ä¸º0.75æ˜¯ä¸ªæ¯”è¾ƒé€‚ä¸­çš„å€¼. è¿‡é«˜èŠ‚çœç©ºé—´ä½†æ˜¯å¢åŠ æŸ¥æ‰¾ä»£ä»·(æ•£åˆ—ä¸å¼€)
 * åœ¨åˆå§‹åŒ–æ—¶è®¾å®šä¸€ä¸ªåˆé€‚çš„å€¼, å¯ä»¥æœ€å°åŒ–rehashçš„æ¬¡æ•°, ç”šè‡³ä¸è¿›è¡Œrehash
 *
 * &lt;p&gt;If many mappings are to be stored in a &lt;tt&gt;HashMap&lt;/tt&gt;
 * instance, creating it with a sufficiently large capacity will allow
 * the mappings to be stored more efficiently than letting it perform
 * automatic rehashing as needed to grow the table.  Note that using
 * many keys with the same {@code hashCode()} is a sure way to slow
 * down performance of any hash table. To ameliorate impact, when keys
 * are {@link Comparable}, this class may use comparison order among
 * keys to help break ties.
 *
 * è®¾å®šä¸ªæ¯”è¾ƒå¤§çš„åˆå§‹å€¼å¯¹å°†è¦è£…è®¸å¤šé”®å€¼å¯¹çš„mapå¯ä»¥æé«˜ä¸å°‘æ€§èƒ½, ç›¸æ¯”äºè‡ªåŠ¨å¢åŠ å®¹é‡æ¥è¯´
 * ä½¿ç”¨è®¸å¤šhashCode()ç›¸ç­‰çš„keyè‚¯å®šä¼šå½±å“ä»»ä½•å“ˆå¸Œè¡¨çš„æ€§èƒ½.
 * å¦‚æœkeyå®ç°äº†æ¯”è¾ƒæ¥å£, é‚£ä¹ˆæ¯”è¾ƒç»“æœå¯ä»¥å¸®åŠ©æ’é™¤å†²æ’
 *
 * &lt;p&gt;&lt;strong&gt;Note that this implementation is not synchronized.&lt;/strong&gt;
 * If multiple threads access a hash map concurrently, and at least one of
 * the threads modifies the map structurally, it &lt;i&gt;must&lt;/i&gt; be
 * synchronized externally.  (A structural modification is any operation
 * that adds or deletes one or more mappings; merely changing the value
 * associated with a key that an instance already contains is not a
 * structural modification.)  This is typically accomplished by
 * synchronizing on some object that naturally encapsulates the map.
 *
 * If no such object exists, the map should be &quot;wrapped&quot; using the
 * {@link Collections#synchronizedMap Collections.synchronizedMap}
 * method.  This is best done at creation time, to prevent accidental
 * unsynchronized access to the map:&lt;pre&gt;
 *   Map m = Collections.synchronizedMap(new HashMap(...));&lt;/pre&gt;
 *
 * éçº¿ç¨‹å®‰å…¨, æ·»åŠ ä¸åˆ é™¤è¦æ³¨æ„. ä½†æ˜¯æ”¹å˜å·²æœ‰çš„valueå€’æ˜¯æ²¡é—®é¢˜.
 * å¦‚æœæƒ³ä¿è¯çº¿ç¨‹å®‰å…¨é™¤äº†æ‰‹åŠ¨å¤„ç†ä»¥å¤–: Map m = Collections.synchronizedMap(new HashMap(...));
 *
 * &lt;p&gt;The iterators returned by all of this class&apos;s &quot;collection view methods&quot;
 * are &lt;i&gt;fail-fast&lt;/i&gt;: if the map is structurally modified at any time after
 * the iterator is created, in any way except through the iterator&apos;s own
 * &lt;tt&gt;remove&lt;/tt&gt; method, the iterator will throw a
 * {@link ConcurrentModificationException}.  Thus, in the face of concurrent
 * modification, the iterator fails quickly and cleanly, rather than risking
 * arbitrary, non-deterministic behavior at an undetermined time in the
 * future.
 *
 * collectionç±»çš„è¿­ä»£å™¨åœ¨è¿­ä»£æ—¶å¯¹åŸæœ‰é›†åˆä¿®æ”¹éƒ½ä¼šç›´æ¥æŠ¥å¼‚å¸¸
 *
 * &lt;p&gt;Note that the fail-fast behavior of an iterator cannot be guaranteed
 * as it is, generally speaking, impossible to make any hard guarantees in the
 * presence of unsynchronized concurrent modification.  Fail-fast iterators
 * throw &lt;tt&gt;ConcurrentModificationException&lt;/tt&gt; on a best-effort basis.
 * Therefore, it would be wrong to write a program that depended on this
 * exception for its correctness: &lt;i&gt;the fail-fast behavior of iterators
 * should be used only to detect bugs.&lt;/i&gt;
 *
 * è¿­ä»£ä¿®æ”¹å¼‚å¸¸ä¸èƒ½ä¿è¯å¼‚æ­¥ä¿®æ”¹. åªæ˜¯ç”¨æ¥æ£€æµ‹ä½ ä»£ç çš„bug.
 *
 * &lt;p&gt;This class is a member of the
 * &lt;a href=&quot;{@docRoot}/../technotes/guides/collections/index.html&quot;&gt;
 * Java Collections Framework&lt;/a&gt;.
 *
 * @param &lt;K&gt; the type of keys maintained by this map
 * @param &lt;V&gt; the type of mapped values
 *
 * @author  Doug Lea å¤§ç¥
 * @author  Josh Bloch
 * @author  Arthur van Hoff
 * @author  Neal Gafter
 * @see     Object#hashCode()
 * @see     Collection
 * @see     Map
 * @see     TreeMap
 * @see     Hashtable
 * @since   1.2
 */
public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;
    implements Map&lt;K,V&gt;, Cloneable, Serializable {

    private static final long serialVersionUID = 362498820763181265L;

    /*
     * Implementation notes.
     *
     * This map usually acts as a binned (bucketed) hash table, but
     * when bins get too large, they are transformed into bins of
     * TreeNodes, each structured similarly to those in
     * java.util.TreeMap. Most methods try to use normal bins, but
     * relay to TreeNode methods when applicable (simply by checking
     * instanceof a node).  Bins of TreeNodes may be traversed and
     * used like any others, but additionally support faster lookup
     * when overpopulated. However, since the vast majority of bins in
     * normal use are not overpopulated, checking for existence of
     * tree bins may be delayed in the course of table methods.
     *
     * å†…éƒ¨ç»“æ„æ˜¯ä¸ªå“ˆå¸Œè¡¨, ä½†æ˜¯ä¸€ä¸ªæ§½ä¸­å…ƒç´ å¦‚æœå¤ªå¤šä¼šå˜æˆTreeNode, å°±åƒTreeMap.
     * å¦‚æœä¸€ä¸ªnodeæ˜¯TreeNode, å°±ä¼šä½¿ç”¨ç”¨TreeNodeçš„æ–¹æ³•
     *
     * Tree bins (i.e., bins whose elements are all TreeNodes) are
     * ordered primarily by hashCode, but in the case of ties, if two
     * elements are of the same &quot;class C implements Comparable&lt;C&gt;&quot;,
     * type then their compareTo method is used for ordering. (We
     * conservatively check generic types via reflection to validate
     * this -- see method comparableClassFor).  The added complexity
     * of tree bins is worthwhile in providing worst-case O(log n)
     * operations when keys either have distinct hashes or are
     * orderable, Thus, performance degrades gracefully under
     * accidental or malicious usages in which hashCode() methods
     * return values that are poorly distributed, as well as those in
     * which many keys share a hashCode, so long as they are also
     * Comparable. (If neither of these apply, we may waste about a
     * factor of two in time and space compared to taking no
     * precautions. But the only known cases stem from poor user
     * programming practices that are already so slow that this makes
     * little difference.)
     *
     * TreeMap æ ¹æ®hashCodeæ’åº, å¦‚æœç›¸ç­‰åˆ™æ ¹æ®æ¯”è¾ƒå™¨æ’åº(å¯¹è±¡ç±»å‹é¡»ä¸€æ ·).
     * TreeNodeæ“ä½œçš„æ—¶é—´å¤æ‚åº¦ä¸ºO(log n), è¿™æ˜¯å½“keyå€¼éƒ½ä¸ç›¸åŒæˆ–è€…è¯´æ˜¯æœ‰åºçš„æƒ…å†µä¸‹, å¹¶ä¸”åªè¦æœ‰åº, å¤æ‚åº¦è¡°å‡å¾ˆæ…¢.
     * å¦‚æœkeyéƒ½å®Œå…¨ä¸€æ ·, é‚£ä¹ˆå°†èŠ±è´¹ä¸¤å€æ—¶é—´ (èƒ½è¿™æ ·åšçš„sbä¹Ÿä¸åœ¨ä¹è¿™äº› - -! )
     *
     * Because TreeNodes are about twice the size of regular nodes, we
     * use them only when bins contain enough nodes to warrant use
     * (see TREEIFY_THRESHOLD). And when they become too small (due to
     * removal or resizing) they are converted back to plain bins.  In
     * usages with well-distributed user hashCodes, tree bins are
     * rarely used.  Ideally, under random hashCodes, the frequency of
     * nodes in bins follows a Poisson distribution
     * (http://en.wikipedia.org/wiki/Poisson_distribution) with a
     * parameter of about 0.5 on average for the default resizing
     * threshold of 0.75, although with a large variance because of
     * resizing granularity. Ignoring variance, the expected
     * occurrences of list size k are (exp(-0.5) * pow(0.5, k) /
     * factorial(k)). The first values are:
     *
     * 0:    0.60653066
     * 1:    0.30326533
     * 2:    0.07581633
     * 3:    0.01263606
     * 4:    0.00157952
     * 5:    0.00015795
     * 6:    0.00001316
     * 7:    0.00000094
     * 8:    0.00000006
     * more: less than 1 in ten million
     *
     * TreeNodeå¾ˆå¤§,æ‰€ä»¥ä¸å¸¸ç”¨, é™¤éè¶…è¿‡TREEIFY_THRESHOLD.
     * éšæœºHashæ¥è¯´, æ•£åˆ—è¿‘ä¼¼æ³Šæ¾åˆ†å¸ƒ. è¿™æ˜¯æœŸæœ›çš„åŒä¸€ä¸ªhashCodeå¯¹åº”çš„keyçš„æ•°é‡çš„æ¦‚ç‡å€¼.
     *
     * The root of a tree bin is normally its first node.  However,
     * sometimes (currently only upon Iterator.remove), the root might
     * be elsewhere, but can be recovered following parent links
     * (method TreeNode.root()).
     *
     * Tree binçš„rootä¸€èˆ¬ä¸ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹, ä½†ç”±äºåˆ é™¤æ“ä½œå¯èƒ½ä¸æ˜¯.
     *
     * All applicable internal methods accept a hash code as an
     * argument (as normally supplied from a public method), allowing
     * them to call each other without recomputing user hashCodes.
     * Most internal methods also accept a &quot;tab&quot; argument, that is
     * normally the current table, but may be a new or old one when
     * resizing or converting.
     *
     * å†…éƒ¨æ–¹æ³•ä¸€èˆ¬éƒ½ä¼ hashCodeå‚æ•°, é¿å…é‡å¤è®¡ç®—.
     * tabä¸€èˆ¬å°±æ˜¯table
     *
     * When bin lists are treeified, split, or untreeified, we keep
     * them in the same relative access/traversal order (i.e., field
     * Node.next) to better preserve locality, and to slightly
     * simplify handling of splits and traversals that invoke
     * iterator.remove. When using comparators on insertion, to keep a
     * total ordering (or as close as is required here) across
     * rebalancings, we compare classes and identityHashCodes as
     * tie-breakers.
     *
     * åŒä¸€ä¸ªhashæ§½é‡Œçš„å€¼ç›¸å¯¹é¡ºåºå›ºå®š(é“¾è¡¨).åœ¨éå†åˆ é™¤æ—¶ä¹Ÿæ“ä½œç®€å•.
     *
     *
     * The use and transitions among plain vs tree modes is
     * complicated by the existence of subclass LinkedHashMap. See
     * below for hook methods defined to be invoked upon insertion,
     * removal and access that allow LinkedHashMap internals to
     * otherwise remain independent of these mechanics. (This also
     * requires that a map instance be passed to some utility methods
     * that may create new nodes.)
     *
     * æ™®é€šhashtable å’Œæ ‘çŠ¶hashtalbeè½¬æ¢ åœ¨LinkedHashMapä¸­æ›´å¤æ‚...
     *
     * The concurrent-programming-like SSA-based coding style helps
     * avoid aliasing errors amid all of the twisty pointer operations.
     */

    /**
     * The default initial capacity - MUST be a power of two. åˆå§‹å®¹é‡16
     */
    static final int DEFAULT_INITIAL_CAPACITY = 1 &lt;&lt; 4; // aka 16

    /**
     * The maximum capacity, used if a higher value is implicitly specified
     * by either of the constructors with arguments. æœ€å¤šå°±è£…è¿™ä¹ˆå¤š
     * MUST be a power of two &lt;= 1&lt;&lt;30.
     */
    static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;

    /**
     * The load factor used when none specified in constructor.
     */
    static final float DEFAULT_LOAD_FACTOR = 0.75f;

    /**
     * The bin count threshold for using a tree rather than list for a
     * bin.  Bins are converted to trees when adding an element to a
     * bin with at least this many nodes. The value must be greater
     * than 2 and should be at least 8 to mesh with assumptions in
     * tree removal about conversion back to plain bins upon
     * shrinkage.
     *
     *
     * ä¸€ä¸ªæ§½ä¸­çš„é”®å€¼å¯¹æ•°é‡è¶…è¿‡8å°±ä¼šå˜ä¸ºTreeNode
     */
    static final int TREEIFY_THRESHOLD = 8;

    /**
     * The bin count threshold for untreeifying a (split) bin during a
     * resize operation. Should be less than TREEIFY_THRESHOLD, and at
     * most 6 to mesh with shrinkage detection under removal.
     *
     * å°äº6å°±å˜å›æ¥
     */
    static final int UNTREEIFY_THRESHOLD = 6;

    /**
     * The smallest table capacity for which bins may be treeified.
     * (Otherwise the table is resized if too many nodes in a bin.)
     * Should be at least 4 * TREEIFY_THRESHOLD to avoid conflicts
     * between resizing and treeification thresholds.
     *
     * æ§½çš„æ•°é‡éœ€è¦å¤šäº64, å­˜å‚¨å…ƒç´ å¤šçš„æ§½æ‰ä¼šæ ‘åŒ–, å¦åˆ™å°±æ˜¯resize
     */
    static final int MIN_TREEIFY_CAPACITY = 64;

    /**
     * Basic hash bin node, used for most entries.  (See below for
     * TreeNode subclass, and in LinkedHashMap for its Entry subclass.)
     *
     * æ¯ä¸ªhashæ§½å°±æ˜¯Nodeçš„é“¾è¡¨
     */
    static class Node&lt;K,V&gt; implements Map.Entry&lt;K,V&gt; {
        final int hash;
        final K key;
        V value;
        Node&lt;K,V&gt; next;

        Node(int hash, K key, V value, Node&lt;K,V&gt; next) {
            this.hash = hash;
            this.key = key;
            this.value = value;
            this.next = next;
        }

        public final K getKey()        { return key; }
        public final V getValue()      { return value; }
        public final String toString() { return key + &quot;=&quot; + value; }

        public final int hashCode() {
            return Objects.hashCode(key) ^ Objects.hashCode(value);
        }

        public final V setValue(V newValue) {
            V oldValue = value;
            value = newValue;
            return oldValue;
        }

        public final boolean equals(Object o) {
            if (o == this)
                return true;
            if (o instanceof Map.Entry) {
                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;)o;
                if (Objects.equals(key, e.getKey()) &amp;&amp;
                    Objects.equals(value, e.getValue()))
                    return true;
            }
            return false;
        }
    }

    /* ---------------- Static utilities -------------- */

    /**
     * Computes key.hashCode() and spreads (XORs) higher bits of hash
     * to lower.  Because the table uses power-of-two masking, sets of
     * hashes that vary only in bits above the current mask will
     * always collide. (Among known examples are sets of Float keys
     * holding consecutive whole numbers in small tables.)  So we
     * apply a transform that spreads the impact of higher bits
     * downward. There is a tradeoff between speed, utility, and
     * quality of bit-spreading. Because many common sets of hashes
     * are already reasonably distributed (so don&apos;t benefit from
     * spreading), and because we use trees to handle large sets of
     * collisions in bins, we just XOR some shifted bits in the
     * cheapest possible way to reduce systematic lossage, as well as
     * to incorporate impact of the highest bits that would otherwise
     * never be used in index calculations because of table bounds.
     *
     * hashæ–¹æ³•ä¸ºkeyçš„hashCodeå€¼ä¸å…¶é«˜16ä½è¿›è¡Œå¼‚æˆ–æ“ä½œçš„ç»“æœ. ä»¥ä¾¿æ•£åˆ—çš„æ›´å¼€
     *
     */
    static final int hash(Object key) {
        int h;
        return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);
    }

    /**
     * Returns x&apos;s Class if it is of the form &quot;class C implements
     * Comparable&lt;C&gt;&quot;, else null.
     *
     * å¦‚æœæœ‰æ¯”è¾ƒå™¨å°±è¿”å›, å› ä¸ºStringæ˜¯å¸¸ç”¨keyç±»å‹, æ‰€ä»¥åšäº†ç‰¹æ®Šåˆ¤æ–­
     */
    static Class&lt;?&gt; comparableClassFor(Object x) {
        if (x instanceof Comparable) {
            Class&lt;?&gt; c; Type[] ts, as; Type t; ParameterizedType p;
            if ((c = x.getClass()) == String.class) // bypass checks å› ä¸ºStringæ˜¯æ¯”è¾ƒå¸¸è§çš„Key
                return c;
            if ((ts = c.getGenericInterfaces()) != null) {
                for (int i = 0; i &lt; ts.length; ++i) {
                    if (((t = ts[i]) instanceof ParameterizedType) &amp;&amp;
                        ((p = (ParameterizedType)t).getRawType() ==
                         Comparable.class) &amp;&amp;
                        (as = p.getActualTypeArguments()) != null &amp;&amp;
                        as.length == 1 &amp;&amp; as[0] == c) // type arg is c
                        return c;
                }
            }
        }
        return null;
    }

    /**
     * Returns k.compareTo(x) if x matches kc (k&apos;s screened comparable
     * class), else 0.
     *
     * è¿”å›æ¯”è¾ƒç»“æœ
     */
    @SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;}) // for cast to Comparable
    static int compareComparables(Class&lt;?&gt; kc, Object k, Object x) {
        return (x == null || x.getClass() != kc ? 0 :
                ((Comparable)k).compareTo(x));
    }

    /**
     * Returns a power of two size for the given target capacity.
     * è¿”å›2çš„næ¬¡æ–¹æ•°, åˆšåˆšå¤§äºç­‰äºcap
     */
    static final int tableSizeFor(int cap) {
        int n = cap - 1;
        n |= n &gt;&gt;&gt; 1;
        n |= n &gt;&gt;&gt; 2;
        n |= n &gt;&gt;&gt; 4;
        n |= n &gt;&gt;&gt; 8;
        n |= n &gt;&gt;&gt; 16;
        return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;
    }

    /* ---------------- Fields -------------- */

    /**
     * The table, initialized on first use, and resized as
     * necessary. When allocated, length is always a power of two.
     * (We also tolerate length zero in some operations to allow
     * bootstrapping mechanics that are currently not needed.)
     */
    transient Node&lt;K,V&gt;[] table;

    /**
     * Holds cached entrySet(). Note that AbstractMap fields are used
     * for keySet() and values().
     *
     * ç¼“å­˜entrySet, keySet(), values()ç”¨è¿™ä¸ªå­—æ®µå®ç°
     */
    transient Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet;

    /**
     * The number of key-value mappings contained in this map.
     */
    transient int size;

    /**
     * The number of times this HashMap has been structurally modified
     * Structural modifications are those that change the number of mappings in
     * the HashMap or otherwise modify its internal structure (e.g.,
     * rehash).  This field is used to make iterators on Collection-views of
     * the HashMap fail-fast.  (See ConcurrentModificationException).
     *
     * ç»“æ„æ›´æ”¹æ¬¡æ•°, å¯ä»¥çœ‹åšæ˜¯ç‰ˆæœ¬å·, å½“è¿­ä»£é›†åˆè§†å›¾æ—¶æ—¶å¦‚æœè¿”ç°modCountå˜åŒ–, åˆ™æŠ›å‡ºConcurrentModificationException
     */
    transient int modCount;

    /**
     * The next size value at which to resize (capacity * load factor).
     *
     * @serial
     *
     * ä¸‹ä¸€æ¬¡å®¹é‡å˜åŒ–çš„é˜ˆ
     */
    // (The javadoc description is true upon serialization.
    // Additionally, if the table array has not been allocated, this
    // field holds the initial array capacity, or zero signifying
    // DEFAULT_INITIAL_CAPACITY.)
    int threshold;

    /**
     * The load factor for the hash table.
     *
     * @serial
     *
     * å½“å‰å¯¹è±¡çš„è´Ÿè½½å› å­
     */
    final float loadFactor;

    /* ---------------- Public operations -------------- */

    /**
     * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the specified initial
     * capacity and load factor.
     *
     * @param  initialCapacity the initial capacity
     * @param  loadFactor      the load factor
     * @throws IllegalArgumentException if the initial capacity is negative
     *         or the load factor is nonpositive
     */
    public HashMap(int initialCapacity, float loadFactor) {
        if (initialCapacity &lt; 0)
            throw new IllegalArgumentException(&quot;Illegal initial capacity: &quot; +
                                               initialCapacity);
        if (initialCapacity &gt; MAXIMUM_CAPACITY)
            initialCapacity = MAXIMUM_CAPACITY;
        if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))
            throw new IllegalArgumentException(&quot;Illegal load factor: &quot; +
                                               loadFactor);
        this.loadFactor = loadFactor;
        this.threshold = tableSizeFor(initialCapacity);
    }

    /**
     * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the specified initial
     * capacity and the default load factor (0.75).
     *
     * @param  initialCapacity the initial capacity.
     * @throws IllegalArgumentException if the initial capacity is negative.
     */
    public HashMap(int initialCapacity) {
        this(initialCapacity, DEFAULT_LOAD_FACTOR);
    }

    /**
     * Constructs an empty &lt;tt&gt;HashMap&lt;/tt&gt; with the default initial capacity
     * (16) and the default load factor (0.75).
     */
    public HashMap() {
        this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted
    }

    /**
     * Constructs a new &lt;tt&gt;HashMap&lt;/tt&gt; with the same mappings as the
     * specified &lt;tt&gt;Map&lt;/tt&gt;.  The &lt;tt&gt;HashMap&lt;/tt&gt; is created with
     * default load factor (0.75) and an initial capacity sufficient to
     * hold the mappings in the specified &lt;tt&gt;Map&lt;/tt&gt;.
     *
     * @param   m the map whose mappings are to be placed in this map
     * @throws  NullPointerException if the specified map is null
     */
    public HashMap(Map&lt;? extends K, ? extends V&gt; m) {
        this.loadFactor = DEFAULT_LOAD_FACTOR;
        putMapEntries(m, false);
    }

    /**
     * Implements Map.putAll and Map constructor
     *
     * @param m the map
     * @param evict false when initially constructing this map, else
     * true (relayed to method afterNodeInsertion).
     */
    final void putMapEntries(Map&lt;? extends K, ? extends V&gt; m, boolean evict) {
        int s = m.size();
        if (s &gt; 0) {
            if (table == null) { // pre-size
                float ft = ((float)s / loadFactor) + 1.0F; // æ ¹æ®è´Ÿè½½å› å­ç®—å‡ºæœ€å°å®¹é‡
                int t = ((ft &lt; (float)MAXIMUM_CAPACITY) ?
                         (int)ft : MAXIMUM_CAPACITY);
                if (t &gt; threshold)
                    threshold = tableSizeFor(t); // æ ¹æ®è¿™ä¸ªå®¹é‡äº§ç”Ÿæ–°çš„2çš„næ¬¡æ–¹ä½œä¸ºæ–°å®¹é‡
            }
            else if (s &gt; threshold)
                resize();
            for (Map.Entry&lt;? extends K, ? extends V&gt; e : m.entrySet()) {
                K key = e.getKey();
                V value = e.getValue();
                putVal(hash(key), key, value, false, evict);
            }
        }
    }

    /**
     * Returns the number of key-value mappings in this map.
     *
     * @return the number of key-value mappings in this map
     */
    public int size() {
        return size;
    }

    /**
     * Returns &lt;tt&gt;true&lt;/tt&gt; if this map contains no key-value mappings.
     *
     * @return &lt;tt&gt;true&lt;/tt&gt; if this map contains no key-value mappings
     */
    public boolean isEmpty() {
        return size == 0;
    }

    /**
     * Returns the value to which the specified key is mapped,
     * or {@code null} if this map contains no mapping for the key.
     *
     * &lt;p&gt;More formally, if this map contains a mapping from a key
     * {@code k} to a value {@code v} such that {@code (key==null ? k==null :
     * key.equals(k))}, then this method returns {@code v}; otherwise
     * it returns {@code null}.  (There can be at most one such mapping.)
     *
     * &lt;p&gt;A return value of {@code null} does not &lt;i&gt;necessarily&lt;/i&gt;
     * indicate that the map contains no mapping for the key; it&apos;s also
     * possible that the map explicitly maps the key to {@code null}.
     * The {@link #containsKey containsKey} operation may be used to
     * distinguish these two cases.
     *
     * @see #put(Object, Object)
     */
    public V get(Object key) {
        Node&lt;K,V&gt; e;
        return (e = getNode(hash(key), key)) == null ? null : e.value;
    }

    /**
     * Implements Map.get and related methods
     *
     * @param hash hash for key
     * @param key the key
     * @return the node, or null if none
     *
     * å…³é”®æ–¹æ³•, get
     * è¯¥æ–¹æ³•åœ¨æŸ¥æ‰¾åˆ°ç›¸åº”çš„æ¡¶çš„æ—¶å€™ä¸ç®¡ä¸‰ä¸ƒäºŒåä¸€å…ˆæ£€æŸ¥ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ä¸æ˜¯, å› ä¸ºå¾ˆå¤§æ¦‚ç‡æ˜¯.
     * ç„¶åæ‰çœ‹è¿™ä¸ªæ¡¶æ˜¯å¦æ˜¯TreeNode
     */
    final Node&lt;K,V&gt; getNode(int hash, Object key) {
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;

        // tableä¸ä¸ºç©º, ä¸”å¯¹åº”æ¡¶ä¸­æœ‰å…ƒç´ 
        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
            (first = tab[(n - 1) &amp; hash]) != null) {
            if (first.hash == hash &amp;&amp; // always check first node
                ((k = first.key) == key || (key != null &amp;&amp; key.equals(k))))
                return first;
            if ((e = first.next) != null) {
                if (first instanceof TreeNode)
                    // å¦‚æœæ˜¯TreeNode, è°ƒç”¨TreeNodeçš„æŸ¥æ‰¾æ–¹æ³•
                    return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
                do {
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        return e;
                } while ((e = e.next) != null);
            }
        }
        return null;
    }

    /**
     * Returns &lt;tt&gt;true&lt;/tt&gt; if this map contains a mapping for the
     * specified key.
     *
     * @param   key   The key whose presence in this map is to be tested
     * @return &lt;tt&gt;true&lt;/tt&gt; if this map contains a mapping for the specified
     * key.
     */
    public boolean containsKey(Object key) {
        return getNode(hash(key), key) != null;
    }

    /**
     * Associates the specified value with the specified key in this map.
     * If the map previously contained a mapping for the key, the old
     * value is replaced.
     *
     * @param key key with which the specified value is to be associated
     * @param value value to be associated with the specified key
     * @return the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or
     *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.
     *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map
     *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)
     */
    public V put(K key, V value) {
        return putVal(hash(key), key, value, false, true);
    }

    /**
     * Implements Map.put and related methods
     *
     * @param hash hash for key
     * @param key the key
     * @param value the value to put
     * @param onlyIfAbsent if true, don&apos;t change existing value
     * @param evict if false, the table is in creation mode.
     * @return previous value, or null if none
     *
     * å…³é”®æ–¹æ³• put
     *
     */
    final V putVal(int hash, K key, V value, boolean onlyIfAbsent,
                   boolean evict) {
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;
        if ((tab = table) == null || (n = tab.length) == 0)
            n = (tab = resize()).length;

        // å¦‚æœæ¡¶ä¸­ç©º, ç›´æ¥èµ‹å€¼
        if ((p = tab[i = (n - 1) &amp; hash]) == null)
            tab[i] = newNode(hash, key, value, null);
        else {
            Node&lt;K,V&gt; e; K k;
            // keyç›¸ç­‰, æ›¿æ¢
            if (p.hash == hash &amp;&amp;
                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
                e = p;
            // keyä¸ç›¸ç­‰, ä½†æ¡¶ä¸ºTreeNode, è°ƒç”¨TreeNodeçš„putæ–¹æ³•
            else if (p instanceof TreeNode)
                e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);
            // keyä¸ç›¸ç­‰, æ¡¶ä¸ºæ­£å¸¸çš„,
            else {
                // éå†é“¾è¡¨
                for (int binCount = 0; ; ++binCount) {
                    // æ‰¾åˆ°å¯æ’å…¥ä½ç½®
                    if ((e = p.next) == null) {
                        p.next = newNode(hash, key, value, null);
                        // å¦‚æœè¾¾åˆ°å˜æˆTreeNodeçš„é˜ˆå€¼, å˜æ ‘
                        if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st
                            treeifyBin(tab, hash);
                        break;
                    }
                    // æ‰¾åˆ°ç›¸åŒçš„key, è·³å‡ºå¾ªç¯
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))
                        break;
                    // å‘åéå†
                    p = e;
                }
            }
            // å­˜åœ¨è¿™ä¸ªkey
            if (e != null) { // existing mapping for key
                V oldValue = e.value;
                if (!onlyIfAbsent || oldValue == null)
                    e.value = value;
                // TODO
                afterNodeAccess(e);

                // ç»“æ„æ²¡æœ‰å˜åŒ–, modCount, sizeä¸ç”¨æ”¹
                return oldValue;
            }
        }
        // æ›´æ”¹ç‰ˆæœ¬
        ++modCount;
        if (++size &gt; threshold)
            resize();
        // TODO
        afterNodeInsertion(evict);
        return null;
    }

    /**
     * Initializes or doubles table size.  If null, allocates in
     * accord with initial capacity target held in field threshold.
     * Otherwise, because we are using power-of-two expansion, the
     * elements from each bin must either stay at same index, or move
     * with a power of two offset in the new table.
     *
     * @return the table
     * å…³é”®æ–¹æ³•, resize ,é‡å»ºhashè¡¨
     */
    final Node&lt;K,V&gt;[] resize() {
        Node&lt;K,V&gt;[] oldTab = table;
        int oldCap = (oldTab == null) ? 0 : oldTab.length;
        int oldThr = threshold;
        int newCap, newThr = 0;
        if (oldCap &gt; 0) {
            if (oldCap &gt;= MAXIMUM_CAPACITY) {
                threshold = Integer.MAX_VALUE;
                return oldTab;
            }
            else if ((newCap = oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;
                     oldCap &gt;= DEFAULT_INITIAL_CAPACITY)
                newThr = oldThr &lt;&lt; 1; // double threshold
        }
        else if (oldThr &gt; 0) // initial capacity was placed in threshold
            newCap = oldThr;
        else {               // zero initial threshold signifies using defaults
            newCap = DEFAULT_INITIAL_CAPACITY;
            newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);
        }
        if (newThr == 0) {
            float ft = (float)newCap * loadFactor;
            newThr = (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?
                      (int)ft : Integer.MAX_VALUE);
        }
        threshold = newThr;
        @SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;})
            Node&lt;K,V&gt;[] newTab = (Node&lt;K,V&gt;[])new Node[newCap];
        table = newTab;
        if (oldTab != null) {
            for (int j = 0; j &lt; oldCap; ++j) {
                Node&lt;K,V&gt; e;
                if ((e = oldTab[j]) != null) {
                    oldTab[j] = null;
                    if (e.next == null)
                        newTab[e.hash &amp; (newCap - 1)] = e;
                    else if (e instanceof TreeNode)
                        ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);
                    else { // preserve order
                        Node&lt;K,V&gt; loHead = null, loTail = null;
                        Node&lt;K,V&gt; hiHead = null, hiTail = null;
                        Node&lt;K,V&gt; next;
                        do {
                            next = e.next;
                            if ((e.hash &amp; oldCap) == 0) {
                                if (loTail == null)
                                    loHead = e;
                                else
                                    loTail.next = e;
                                loTail = e;
                            }
                            else {
                                if (hiTail == null)
                                    hiHead = e;
                                else
                                    hiTail.next = e;
                                hiTail = e;
                            }
                        } while ((e = next) != null);
                        if (loTail != null) {
                            loTail.next = null;
                            newTab[j] = loHead;
                        }
                        if (hiTail != null) {
                            hiTail.next = null;
                            newTab[j + oldCap] = hiHead;
                        }
                    }
                }
            }
        }
        return newTab;
    }

    /**
     * Replaces all linked nodes in bin at index for given hash unless
     * table is too small, in which case resizes instead.
     *
     * å°è¯•å¯¹ä¸€ä¸ªæ¡¶è¿›è¡Œæ ‘åŒ–æ“ä½œ
     */
    final void treeifyBin(Node&lt;K,V&gt;[] tab, int hash) {
        int n, index; Node&lt;K,V&gt; e;
        // å¦‚æœè¡¨æ¯”è¾ƒå°, resize, ä¸æ ‘åŒ–
        if (tab == null || (n = tab.length) &lt; MIN_TREEIFY_CAPACITY)
            resize();
        else if ((e = tab[index = (n - 1) &amp; hash]) != null) {
            // æ‰¾åˆ°è¦ğŸŒ²åŒ–çš„æ¡¶, å¯¹æ¯ä¸ªNodeå…ƒç´ æ›¿æ¢æˆTreeNode, ç»„è£…ä¸€ä¸ªTreeNodeé“¾è¡¨
            TreeNode&lt;K,V&gt; hd = null, tl = null;
            do {
                TreeNode&lt;K,V&gt; p = replacementTreeNode(e, null);
                if (tl == null)
                    hd = p;
                else {
                    p.prev = tl;
                    tl.next = p;
                }
                tl = p;
            } while ((e = e.next) != null);

            // å¯¹TreeNodeé“¾è¡¨å˜æˆTreeç»“æ„
            if ((tab[index] = hd) != null)
                hd.treeify(tab);
        }
    }

    /**
     * Copies all of the mappings from the specified map to this map.
     * These mappings will replace any mappings that this map had for
     * any of the keys currently in the specified map.
     *
     * @param m mappings to be stored in this map
     * @throws NullPointerException if the specified map is null
     */
    public void putAll(Map&lt;? extends K, ? extends V&gt; m) {
        putMapEntries(m, true);
    }

    /**
     * Removes the mapping for the specified key from this map if present.
     *
     * @param  key key whose mapping is to be removed from the map
     * @return the previous value associated with &lt;tt&gt;key&lt;/tt&gt;, or
     *         &lt;tt&gt;null&lt;/tt&gt; if there was no mapping for &lt;tt&gt;key&lt;/tt&gt;.
     *         (A &lt;tt&gt;null&lt;/tt&gt; return can also indicate that the map
     *         previously associated &lt;tt&gt;null&lt;/tt&gt; with &lt;tt&gt;key&lt;/tt&gt;.)
     */
    public V remove(Object key) {
        Node&lt;K,V&gt; e;
        return (e = removeNode(hash(key), key, null, false, true)) == null ?
            null : e.value;
    }

    /**
     * Implements Map.remove and related methods
     *
     * @param hash hash for key
     * @param key the key
     * @param value the value to match if matchValue, else ignored
     * @param matchValue if true only remove if value is equal
     * @param movable if false do not move other nodes while removing
     * @return the node, or null if none
     *
     * å…³é”®æ“ä½œ, remove
     */
    final Node&lt;K,V&gt; removeNode(int hash, Object key, Object value,
                               boolean matchValue, boolean movable) {
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, index;
        if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;
            (p = tab[index = (n - 1) &amp; hash]) != null) {
            Node&lt;K,V&gt; node = null, e; K k; V v;
            if (p.hash == hash &amp;&amp;
                ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))
                node = p;
            else if ((e = p.next) != null) {
                if (p instanceof TreeNode)
                    node = ((TreeNode&lt;K,V&gt;)p).getTreeNode(hash, key);
                else {
                    do {
                        if (e.hash == hash &amp;&amp;
                            ((k = e.key) == key ||
                             (key != null &amp;&amp; key.equals(k)))) {
                            node = e;
                            break;
                        }
                        p = e;
                    } while ((e = e.next) != null);
                }
            }
            if (node != null &amp;&amp; (!matchValue || (v = node.value) == value ||
                                 (value != null &amp;&amp; value.equals(v)))) {
                if (node instanceof TreeNode)
                    ((TreeNode&lt;K,V&gt;)node).removeTreeNode(this, tab, movable);
                else if (node == p)
                    tab[index] = node.next;
                else
                    p.next = node.next;
                ++modCount;
                --size;
                afterNodeRemoval(node);
                return node;
            }
        }
        return null;
    }

    /**
     * Removes all of the mappings from this map.
     * The map will be empty after this call returns.
     */
    public void clear() {
        Node&lt;K,V&gt;[] tab;
        modCount++;
        if ((tab = table) != null &amp;&amp; size &gt; 0) {
            size = 0;
            for (int i = 0; i &lt; tab.length; ++i)
                tab[i] = null;
        }
    }

    /**
     * Returns &lt;tt&gt;true&lt;/tt&gt; if this map maps one or more keys to the
     * specified value.
     *
     * @param value value whose presence in this map is to be tested
     * @return &lt;tt&gt;true&lt;/tt&gt; if this map maps one or more keys to the
     *         specified value
     *
     * éå†æ“ä½œæŸ¥è¯¢value
     */
    public boolean containsValue(Object value) {
        Node&lt;K,V&gt;[] tab; V v;
        if ((tab = table) != null &amp;&amp; size &gt; 0) {
            for (int i = 0; i &lt; tab.length; ++i) {
                for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next) {
                    if ((v = e.value) == value ||
                        (value != null &amp;&amp; value.equals(v)))
                        return true;
                }
            }
        }
        return false;
    }

    /**
     * Returns a {@link Set} view of the keys contained in this map.
     * The set is backed by the map, so changes to the map are
     * reflected in the set, and vice-versa.  If the map is modified
     * while an iteration over the set is in progress (except through
     * the iterator&apos;s own &lt;tt&gt;remove&lt;/tt&gt; operation), the results of
     * the iteration are undefined.  The set supports element removal,
     * which removes the corresponding mapping from the map, via the
     * &lt;tt&gt;Iterator.remove&lt;/tt&gt;, &lt;tt&gt;Set.remove&lt;/tt&gt;,
     * &lt;tt&gt;removeAll&lt;/tt&gt;, &lt;tt&gt;retainAll&lt;/tt&gt;, and &lt;tt&gt;clear&lt;/tt&gt;
     * operations.  It does not support the &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt;
     * operations.
     *
     * @return a set view of the keys contained in this map
     *
     * KeySet() ç”¨KeySetå†…éƒ¨ç±»å®ç°
     */
    public Set&lt;K&gt; keySet() {
        Set&lt;K&gt; ks;
        return (ks = keySet) == null ? (keySet = new KeySet()) : ks;
    }

    final class KeySet extends AbstractSet&lt;K&gt; {
        public final int size()                 { return size; }
        public final void clear()               { HashMap.this.clear(); }
        public final Iterator&lt;K&gt; iterator()     { return new KeyIterator(); }
        public final boolean contains(Object o) { return containsKey(o); }
        public final boolean remove(Object key) {
            return removeNode(hash(key), key, null, false, true) != null;
        }
        public final Spliterator&lt;K&gt; spliterator() {
            return new KeySpliterator&lt;&gt;(HashMap.this, 0, -1, 0, 0);
        }
        public final void forEach(Consumer&lt;? super K&gt; action) {
            Node&lt;K,V&gt;[] tab;
            if (action == null)
                throw new NullPointerException();
            if (size &gt; 0 &amp;&amp; (tab = table) != null) {
                int mc = modCount;
                for (int i = 0; i &lt; tab.length; ++i) {
                    for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next)
                        action.accept(e.key);
                }
                if (modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }
    }

    /**
     * Returns a {@link Collection} view of the values contained in this map.
     * The collection is backed by the map, so changes to the map are
     * reflected in the collection, and vice-versa.  If the map is
     * modified while an iteration over the collection is in progress
     * (except through the iterator&apos;s own &lt;tt&gt;remove&lt;/tt&gt; operation),
     * the results of the iteration are undefined.  The collection
     * supports element removal, which removes the corresponding
     * mapping from the map, via the &lt;tt&gt;Iterator.remove&lt;/tt&gt;,
     * &lt;tt&gt;Collection.remove&lt;/tt&gt;, &lt;tt&gt;removeAll&lt;/tt&gt;,
     * &lt;tt&gt;retainAll&lt;/tt&gt; and &lt;tt&gt;clear&lt;/tt&gt; operations.  It does not
     * support the &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt; operations.
     *
     * @return a view of the values contained in this map
     *
     * ä½¿ç”¨Valueså†…éƒ¨ç±»å®ç°
     */
    public Collection&lt;V&gt; values() {
        Collection&lt;V&gt; vs;
        return (vs = values) == null ? (values = new Values()) : vs;
    }

    final class Values extends AbstractCollection&lt;V&gt; {
        public final int size()                 { return size; }
        public final void clear()               { HashMap.this.clear(); }
        public final Iterator&lt;V&gt; iterator()     { return new ValueIterator(); }
        public final boolean contains(Object o) { return containsValue(o); }
        public final Spliterator&lt;V&gt; spliterator() {
            return new ValueSpliterator&lt;&gt;(HashMap.this, 0, -1, 0, 0);
        }
        public final void forEach(Consumer&lt;? super V&gt; action) {
            Node&lt;K,V&gt;[] tab;
            if (action == null)
                throw new NullPointerException();
            if (size &gt; 0 &amp;&amp; (tab = table) != null) {
                int mc = modCount;
                for (int i = 0; i &lt; tab.length; ++i) {
                    for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next)
                        action.accept(e.value);
                }
                if (modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }
    }

    /**
     * Returns a {@link Set} view of the mappings contained in this map.
     * The set is backed by the map, so changes to the map are
     * reflected in the set, and vice-versa.  If the map is modified
     * while an iteration over the set is in progress (except through
     * the iterator&apos;s own &lt;tt&gt;remove&lt;/tt&gt; operation, or through the
     * &lt;tt&gt;setValue&lt;/tt&gt; operation on a map entry returned by the
     * iterator) the results of the iteration are undefined.  The set
     * supports element removal, which removes the corresponding
     * mapping from the map, via the &lt;tt&gt;Iterator.remove&lt;/tt&gt;,
     * &lt;tt&gt;Set.remove&lt;/tt&gt;, &lt;tt&gt;removeAll&lt;/tt&gt;, &lt;tt&gt;retainAll&lt;/tt&gt; and
     * &lt;tt&gt;clear&lt;/tt&gt; operations.  It does not support the
     * &lt;tt&gt;add&lt;/tt&gt; or &lt;tt&gt;addAll&lt;/tt&gt; operations.
     *
     * @return a set view of the mappings contained in this map
     *
     * ä½¿ç”¨EntrySetå†…éƒ¨ç±»å®ç°
     */
    public Set&lt;Map.Entry&lt;K,V&gt;&gt; entrySet() {
        Set&lt;Map.Entry&lt;K,V&gt;&gt; es;
        return (es = entrySet) == null ? (entrySet = new EntrySet()) : es;
    }

    final class EntrySet extends AbstractSet&lt;Map.Entry&lt;K,V&gt;&gt; {
        public final int size()                 { return size; }
        public final void clear()               { HashMap.this.clear(); }
        public final Iterator&lt;Map.Entry&lt;K,V&gt;&gt; iterator() {
            return new EntryIterator();
        }
        public final boolean contains(Object o) {
            if (!(o instanceof Map.Entry))
                return false;
            Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;
            Object key = e.getKey();
            Node&lt;K,V&gt; candidate = getNode(hash(key), key);
            return candidate != null &amp;&amp; candidate.equals(e);
        }
        public final boolean remove(Object o) {
            if (o instanceof Map.Entry) {
                Map.Entry&lt;?,?&gt; e = (Map.Entry&lt;?,?&gt;) o;
                Object key = e.getKey();
                Object value = e.getValue();
                return removeNode(hash(key), key, value, true, true) != null;
            }
            return false;
        }
        public final Spliterator&lt;Map.Entry&lt;K,V&gt;&gt; spliterator() {
            return new EntrySpliterator&lt;&gt;(HashMap.this, 0, -1, 0, 0);
        }
        public final void forEach(Consumer&lt;? super Map.Entry&lt;K,V&gt;&gt; action) {
            Node&lt;K,V&gt;[] tab;
            if (action == null)
                throw new NullPointerException();
            if (size &gt; 0 &amp;&amp; (tab = table) != null) {
                int mc = modCount;
                for (int i = 0; i &lt; tab.length; ++i) {
                    for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next)
                        action.accept(e);
                }
                if (modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }
    }

    // Overrides of JDK8 Map extension methods

    @Override
    public V getOrDefault(Object key, V defaultValue) {
        Node&lt;K,V&gt; e;
        return (e = getNode(hash(key), key)) == null ? defaultValue : e.value;
    }

    @Override
    public V putIfAbsent(K key, V value) {
        return putVal(hash(key), key, value, true, true);
    }

    @Override
    public boolean remove(Object key, Object value) {
        return removeNode(hash(key), key, value, true, true) != null;
    }

    @Override
    public boolean replace(K key, V oldValue, V newValue) {
        Node&lt;K,V&gt; e; V v;
        if ((e = getNode(hash(key), key)) != null &amp;&amp;
            ((v = e.value) == oldValue || (v != null &amp;&amp; v.equals(oldValue)))) {
            e.value = newValue;
            afterNodeAccess(e);
            return true;
        }
        return false;
    }

    @Override
    public V replace(K key, V value) {
        Node&lt;K,V&gt; e;
        if ((e = getNode(hash(key), key)) != null) {
            V oldValue = e.value;
            e.value = value;
            afterNodeAccess(e);
            return oldValue;
        }
        return null;
    }

    @Override
    public V computeIfAbsent(K key,
                             Function&lt;? super K, ? extends V&gt; mappingFunction) {
        if (mappingFunction == null)
            throw new NullPointerException();
        int hash = hash(key);
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; int n, i;
        int binCount = 0;
        TreeNode&lt;K,V&gt; t = null;
        Node&lt;K,V&gt; old = null;
        if (size &gt; threshold || (tab = table) == null ||
            (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((first = tab[i = (n - 1) &amp; hash]) != null) {
            if (first instanceof TreeNode)
                old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
            else {
                Node&lt;K,V&gt; e = first; K k;
                do {
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) {
                        old = e;
                        break;
                    }
                    ++binCount;
                } while ((e = e.next) != null);
            }
            V oldValue;
            if (old != null &amp;&amp; (oldValue = old.value) != null) {
                afterNodeAccess(old);
                return oldValue;
            }
        }
        V v = mappingFunction.apply(key);
        if (v == null) {
            return null;
        } else if (old != null) {
            old.value = v;
            afterNodeAccess(old);
            return v;
        }
        else if (t != null)
            t.putTreeVal(this, tab, hash, key, v);
        else {
            tab[i] = newNode(hash, key, v, first);
            if (binCount &gt;= TREEIFY_THRESHOLD - 1)
                treeifyBin(tab, hash);
        }
        ++modCount;
        ++size;
        afterNodeInsertion(true);
        return v;
    }

    public V computeIfPresent(K key,
                              BiFunction&lt;? super K, ? super V, ? extends V&gt; remappingFunction) {
        if (remappingFunction == null)
            throw new NullPointerException();
        Node&lt;K,V&gt; e; V oldValue;
        int hash = hash(key);
        if ((e = getNode(hash, key)) != null &amp;&amp;
            (oldValue = e.value) != null) {
            V v = remappingFunction.apply(key, oldValue);
            if (v != null) {
                e.value = v;
                afterNodeAccess(e);
                return v;
            }
            else
                removeNode(hash, key, null, false, true);
        }
        return null;
    }

    @Override
    public V compute(K key,
                     BiFunction&lt;? super K, ? super V, ? extends V&gt; remappingFunction) {
        if (remappingFunction == null)
            throw new NullPointerException();
        int hash = hash(key);
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; int n, i;
        int binCount = 0;
        TreeNode&lt;K,V&gt; t = null;
        Node&lt;K,V&gt; old = null;
        if (size &gt; threshold || (tab = table) == null ||
            (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((first = tab[i = (n - 1) &amp; hash]) != null) {
            if (first instanceof TreeNode)
                old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
            else {
                Node&lt;K,V&gt; e = first; K k;
                do {
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) {
                        old = e;
                        break;
                    }
                    ++binCount;
                } while ((e = e.next) != null);
            }
        }
        V oldValue = (old == null) ? null : old.value;
        V v = remappingFunction.apply(key, oldValue);
        if (old != null) {
            if (v != null) {
                old.value = v;
                afterNodeAccess(old);
            }
            else
                removeNode(hash, key, null, false, true);
        }
        else if (v != null) {
            if (t != null)
                t.putTreeVal(this, tab, hash, key, v);
            else {
                tab[i] = newNode(hash, key, v, first);
                if (binCount &gt;= TREEIFY_THRESHOLD - 1)
                    treeifyBin(tab, hash);
            }
            ++modCount;
            ++size;
            afterNodeInsertion(true);
        }
        return v;
    }

    @Override
    public V merge(K key, V value,
                   BiFunction&lt;? super V, ? super V, ? extends V&gt; remappingFunction) {
        if (value == null)
            throw new NullPointerException();
        if (remappingFunction == null)
            throw new NullPointerException();
        int hash = hash(key);
        Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first; int n, i;
        int binCount = 0;
        TreeNode&lt;K,V&gt; t = null;
        Node&lt;K,V&gt; old = null;
        if (size &gt; threshold || (tab = table) == null ||
            (n = tab.length) == 0)
            n = (tab = resize()).length;
        if ((first = tab[i = (n - 1) &amp; hash]) != null) {
            if (first instanceof TreeNode)
                old = (t = (TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);
            else {
                Node&lt;K,V&gt; e = first; K k;
                do {
                    if (e.hash == hash &amp;&amp;
                        ((k = e.key) == key || (key != null &amp;&amp; key.equals(k)))) {
                        old = e;
                        break;
                    }
                    ++binCount;
                } while ((e = e.next) != null);
            }
        }
        if (old != null) {
            V v;
            if (old.value != null)
                v = remappingFunction.apply(old.value, value);
            else
                v = value;
            if (v != null) {
                old.value = v;
                afterNodeAccess(old);
            }
            else
                removeNode(hash, key, null, false, true);
            return v;
        }
        if (value != null) {
            if (t != null)
                t.putTreeVal(this, tab, hash, key, value);
            else {
                tab[i] = newNode(hash, key, value, first);
                if (binCount &gt;= TREEIFY_THRESHOLD - 1)
                    treeifyBin(tab, hash);
            }
            ++modCount;
            ++size;
            afterNodeInsertion(true);
        }
        return value;
    }

    @Override
    public void forEach(BiConsumer&lt;? super K, ? super V&gt; action) {
        Node&lt;K,V&gt;[] tab;
        if (action == null)
            throw new NullPointerException();
        if (size &gt; 0 &amp;&amp; (tab = table) != null) {
            int mc = modCount;
            for (int i = 0; i &lt; tab.length; ++i) {
                for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next)
                    action.accept(e.key, e.value);
            }
            if (modCount != mc)
                throw new ConcurrentModificationException();
        }
    }

    @Override
    public void replaceAll(BiFunction&lt;? super K, ? super V, ? extends V&gt; function) {
        Node&lt;K,V&gt;[] tab;
        if (function == null)
            throw new NullPointerException();
        if (size &gt; 0 &amp;&amp; (tab = table) != null) {
            int mc = modCount;
            for (int i = 0; i &lt; tab.length; ++i) {
                for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next) {
                    e.value = function.apply(e.key, e.value);
                }
            }
            if (modCount != mc)
                throw new ConcurrentModificationException();
        }
    }

    /* ------------------------------------------------------------ */
    // Cloning and serialization

    /**
     * Returns a shallow copy of this &lt;tt&gt;HashMap&lt;/tt&gt; instance: the keys and
     * values themselves are not cloned.
     *
     * @return a shallow copy of this map
     */
    @SuppressWarnings(&quot;unchecked&quot;)
    @Override
    public Object clone() {
        HashMap&lt;K,V&gt; result;
        try {
            result = (HashMap&lt;K,V&gt;)super.clone();
        } catch (CloneNotSupportedException e) {
            // this shouldn&apos;t happen, since we are Cloneable
            throw new InternalError(e);
        }
        result.reinitialize();
        result.putMapEntries(this, false);
        return result;
    }

    // These methods are also used when serializing HashSets
    final float loadFactor() { return loadFactor; }
    final int capacity() {
        return (table != null) ? table.length :
            (threshold &gt; 0) ? threshold :
            DEFAULT_INITIAL_CAPACITY;
    }

    /**
     * Save the state of the &lt;tt&gt;HashMap&lt;/tt&gt; instance to a stream (i.e.,
     * serialize it).
     *
     * @serialData The &lt;i&gt;capacity&lt;/i&gt; of the HashMap (the length of the
     *             bucket array) is emitted (int), followed by the
     *             &lt;i&gt;size&lt;/i&gt; (an int, the number of key-value
     *             mappings), followed by the key (Object) and value (Object)
     *             for each key-value mapping.  The key-value mappings are
     *             emitted in no particular order.
     */
    private void writeObject(java.io.ObjectOutputStream s)
        throws IOException {
        int buckets = capacity();
        // Write out the threshold, loadfactor, and any hidden stuff
        s.defaultWriteObject();
        s.writeInt(buckets);
        s.writeInt(size);
        internalWriteEntries(s);
    }

    /**
     * Reconstitute the {@code HashMap} instance from a stream (i.e.,
     * deserialize it).
     */
    private void readObject(java.io.ObjectInputStream s)
        throws IOException, ClassNotFoundException {
        // Read in the threshold (ignored), loadfactor, and any hidden stuff
        s.defaultReadObject();
        reinitialize();
        if (loadFactor &lt;= 0 || Float.isNaN(loadFactor))
            throw new InvalidObjectException(&quot;Illegal load factor: &quot; +
                                             loadFactor);
        s.readInt();                // Read and ignore number of buckets
        int mappings = s.readInt(); // Read number of mappings (size)
        if (mappings &lt; 0)
            throw new InvalidObjectException(&quot;Illegal mappings count: &quot; +
                                             mappings);
        else if (mappings &gt; 0) { // (if zero, use defaults)
            // Size the table using given load factor only if within
            // range of 0.25...4.0
            float lf = Math.min(Math.max(0.25f, loadFactor), 4.0f);
            float fc = (float)mappings / lf + 1.0f;
            int cap = ((fc &lt; DEFAULT_INITIAL_CAPACITY) ?
                       DEFAULT_INITIAL_CAPACITY :
                       (fc &gt;= MAXIMUM_CAPACITY) ?
                       MAXIMUM_CAPACITY :
                       tableSizeFor((int)fc));
            float ft = (float)cap * lf;
            threshold = ((cap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; MAXIMUM_CAPACITY) ?
                         (int)ft : Integer.MAX_VALUE);
            @SuppressWarnings({&quot;rawtypes&quot;,&quot;unchecked&quot;})
                Node&lt;K,V&gt;[] tab = (Node&lt;K,V&gt;[])new Node[cap];
            table = tab;

            // Read the keys and values, and put the mappings in the HashMap
            for (int i = 0; i &lt; mappings; i++) {
                @SuppressWarnings(&quot;unchecked&quot;)
                    K key = (K) s.readObject();
                @SuppressWarnings(&quot;unchecked&quot;)
                    V value = (V) s.readObject();
                putVal(hash(key), key, value, false, false);
            }
        }
    }

    /* ------------------------------------------------------------ */
    // iterators

    abstract class HashIterator {
        Node&lt;K,V&gt; next;        // next entry to return
        Node&lt;K,V&gt; current;     // current entry
        int expectedModCount;  // for fast-fail
        int index;             // current slot

        HashIterator() {
            expectedModCount = modCount;
            Node&lt;K,V&gt;[] t = table;
            current = next = null;
            index = 0;
            if (t != null &amp;&amp; size &gt; 0) { // advance to first entry
                do {} while (index &lt; t.length &amp;&amp; (next = t[index++]) == null);
            }
        }

        public final boolean hasNext() {
            return next != null;
        }

        final Node&lt;K,V&gt; nextNode() {
            Node&lt;K,V&gt;[] t;
            Node&lt;K,V&gt; e = next;
            if (modCount != expectedModCount)
                throw new ConcurrentModificationException();
            if (e == null)
                throw new NoSuchElementException();
            if ((next = (current = e).next) == null &amp;&amp; (t = table) != null) {
                do {} while (index &lt; t.length &amp;&amp; (next = t[index++]) == null);
            }
            return e;
        }

        public final void remove() {
            Node&lt;K,V&gt; p = current;
            if (p == null)
                throw new IllegalStateException();
            if (modCount != expectedModCount)
                throw new ConcurrentModificationException();
            current = null;
            K key = p.key;
            removeNode(hash(key), key, null, false, false);
            expectedModCount = modCount;
        }
    }

    final class KeyIterator extends HashIterator
        implements Iterator&lt;K&gt; {
        public final K next() { return nextNode().key; }
    }

    final class ValueIterator extends HashIterator
        implements Iterator&lt;V&gt; {
        public final V next() { return nextNode().value; }
    }

    final class EntryIterator extends HashIterator
        implements Iterator&lt;Map.Entry&lt;K,V&gt;&gt; {
        public final Map.Entry&lt;K,V&gt; next() { return nextNode(); }
    }

    /* ------------------------------------------------------------ */
    // spliterators

    static class HashMapSpliterator&lt;K,V&gt; {
        final HashMap&lt;K,V&gt; map;
        Node&lt;K,V&gt; current;          // current node
        int index;                  // current index, modified on advance/split
        int fence;                  // one past last index
        int est;                    // size estimate
        int expectedModCount;       // for comodification checks

        HashMapSpliterator(HashMap&lt;K,V&gt; m, int origin,
                           int fence, int est,
                           int expectedModCount) {
            this.map = m;
            this.index = origin;
            this.fence = fence;
            this.est = est;
            this.expectedModCount = expectedModCount;
        }

        final int getFence() { // initialize fence and size on first use
            int hi;
            if ((hi = fence) &lt; 0) {
                HashMap&lt;K,V&gt; m = map;
                est = m.size;
                expectedModCount = m.modCount;
                Node&lt;K,V&gt;[] tab = m.table;
                hi = fence = (tab == null) ? 0 : tab.length;
            }
            return hi;
        }

        public final long estimateSize() {
            getFence(); // force init
            return (long) est;
        }
    }

    static final class KeySpliterator&lt;K,V&gt;
        extends HashMapSpliterator&lt;K,V&gt;
        implements Spliterator&lt;K&gt; {
        KeySpliterator(HashMap&lt;K,V&gt; m, int origin, int fence, int est,
                       int expectedModCount) {
            super(m, origin, fence, est, expectedModCount);
        }

        public KeySpliterator&lt;K,V&gt; trySplit() {
            int hi = getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; 1;
            return (lo &gt;= mid || current != null) ? null :
                new KeySpliterator&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= 1,
                                        expectedModCount);
        }

        public void forEachRemaining(Consumer&lt;? super K&gt; action) {
            int i, hi, mc;
            if (action == null)
                throw new NullPointerException();
            HashMap&lt;K,V&gt; m = map;
            Node&lt;K,V&gt;[] tab = m.table;
            if ((hi = fence) &lt; 0) {
                mc = expectedModCount = m.modCount;
                hi = fence = (tab == null) ? 0 : tab.length;
            }
            else
                mc = expectedModCount;
            if (tab != null &amp;&amp; tab.length &gt;= hi &amp;&amp;
                (i = index) &gt;= 0 &amp;&amp; (i &lt; (index = hi) || current != null)) {
                Node&lt;K,V&gt; p = current;
                current = null;
                do {
                    if (p == null)
                        p = tab[i++];
                    else {
                        action.accept(p.key);
                        p = p.next;
                    }
                } while (p != null || i &lt; hi);
                if (m.modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }

        public boolean tryAdvance(Consumer&lt;? super K&gt; action) {
            int hi;
            if (action == null)
                throw new NullPointerException();
            Node&lt;K,V&gt;[] tab = map.table;
            if (tab != null &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= 0) {
                while (current != null || index &lt; hi) {
                    if (current == null)
                        current = tab[index++];
                    else {
                        K k = current.key;
                        current = current.next;
                        action.accept(k);
                        if (map.modCount != expectedModCount)
                            throw new ConcurrentModificationException();
                        return true;
                    }
                }
            }
            return false;
        }

        public int characteristics() {
            return (fence &lt; 0 || est == map.size ? Spliterator.SIZED : 0) |
                Spliterator.DISTINCT;
        }
    }

    static final class ValueSpliterator&lt;K,V&gt;
        extends HashMapSpliterator&lt;K,V&gt;
        implements Spliterator&lt;V&gt; {
        ValueSpliterator(HashMap&lt;K,V&gt; m, int origin, int fence, int est,
                         int expectedModCount) {
            super(m, origin, fence, est, expectedModCount);
        }

        public ValueSpliterator&lt;K,V&gt; trySplit() {
            int hi = getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; 1;
            return (lo &gt;= mid || current != null) ? null :
                new ValueSpliterator&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= 1,
                                          expectedModCount);
        }

        public void forEachRemaining(Consumer&lt;? super V&gt; action) {
            int i, hi, mc;
            if (action == null)
                throw new NullPointerException();
            HashMap&lt;K,V&gt; m = map;
            Node&lt;K,V&gt;[] tab = m.table;
            if ((hi = fence) &lt; 0) {
                mc = expectedModCount = m.modCount;
                hi = fence = (tab == null) ? 0 : tab.length;
            }
            else
                mc = expectedModCount;
            if (tab != null &amp;&amp; tab.length &gt;= hi &amp;&amp;
                (i = index) &gt;= 0 &amp;&amp; (i &lt; (index = hi) || current != null)) {
                Node&lt;K,V&gt; p = current;
                current = null;
                do {
                    if (p == null)
                        p = tab[i++];
                    else {
                        action.accept(p.value);
                        p = p.next;
                    }
                } while (p != null || i &lt; hi);
                if (m.modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }

        public boolean tryAdvance(Consumer&lt;? super V&gt; action) {
            int hi;
            if (action == null)
                throw new NullPointerException();
            Node&lt;K,V&gt;[] tab = map.table;
            if (tab != null &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= 0) {
                while (current != null || index &lt; hi) {
                    if (current == null)
                        current = tab[index++];
                    else {
                        V v = current.value;
                        current = current.next;
                        action.accept(v);
                        if (map.modCount != expectedModCount)
                            throw new ConcurrentModificationException();
                        return true;
                    }
                }
            }
            return false;
        }

        public int characteristics() {
            return (fence &lt; 0 || est == map.size ? Spliterator.SIZED : 0);
        }
    }

    static final class EntrySpliterator&lt;K,V&gt;
        extends HashMapSpliterator&lt;K,V&gt;
        implements Spliterator&lt;Map.Entry&lt;K,V&gt;&gt; {
        EntrySpliterator(HashMap&lt;K,V&gt; m, int origin, int fence, int est,
                         int expectedModCount) {
            super(m, origin, fence, est, expectedModCount);
        }

        public EntrySpliterator&lt;K,V&gt; trySplit() {
            int hi = getFence(), lo = index, mid = (lo + hi) &gt;&gt;&gt; 1;
            return (lo &gt;= mid || current != null) ? null :
                new EntrySpliterator&lt;&gt;(map, lo, index = mid, est &gt;&gt;&gt;= 1,
                                          expectedModCount);
        }

        public void forEachRemaining(Consumer&lt;? super Map.Entry&lt;K,V&gt;&gt; action) {
            int i, hi, mc;
            if (action == null)
                throw new NullPointerException();
            HashMap&lt;K,V&gt; m = map;
            Node&lt;K,V&gt;[] tab = m.table;
            if ((hi = fence) &lt; 0) {
                mc = expectedModCount = m.modCount;
                hi = fence = (tab == null) ? 0 : tab.length;
            }
            else
                mc = expectedModCount;
            if (tab != null &amp;&amp; tab.length &gt;= hi &amp;&amp;
                (i = index) &gt;= 0 &amp;&amp; (i &lt; (index = hi) || current != null)) {
                Node&lt;K,V&gt; p = current;
                current = null;
                do {
                    if (p == null)
                        p = tab[i++];
                    else {
                        action.accept(p);
                        p = p.next;
                    }
                } while (p != null || i &lt; hi);
                if (m.modCount != mc)
                    throw new ConcurrentModificationException();
            }
        }

        public boolean tryAdvance(Consumer&lt;? super Map.Entry&lt;K,V&gt;&gt; action) {
            int hi;
            if (action == null)
                throw new NullPointerException();
            Node&lt;K,V&gt;[] tab = map.table;
            if (tab != null &amp;&amp; tab.length &gt;= (hi = getFence()) &amp;&amp; index &gt;= 0) {
                while (current != null || index &lt; hi) {
                    if (current == null)
                        current = tab[index++];
                    else {
                        Node&lt;K,V&gt; e = current;
                        current = current.next;
                        action.accept(e);
                        if (map.modCount != expectedModCount)
                            throw new ConcurrentModificationException();
                        return true;
                    }
                }
            }
            return false;
        }

        public int characteristics() {
            return (fence &lt; 0 || est == map.size ? Spliterator.SIZED : 0) |
                Spliterator.DISTINCT;
        }
    }

    /* ------------------------------------------------------------ */
    // LinkedHashMap support


    /*
     * The following package-protected methods are designed to be
     * overridden by LinkedHashMap, but not by any other subclass.
     * Nearly all other internal methods are also package-protected
     * but are declared final, so can be used by LinkedHashMap, view
     * classes, and HashSet.
     */

    // Create a regular (non-tree) node
    Node&lt;K,V&gt; newNode(int hash, K key, V value, Node&lt;K,V&gt; next) {
        return new Node&lt;&gt;(hash, key, value, next);
    }

    // For conversion from TreeNodes to plain nodes
    Node&lt;K,V&gt; replacementNode(Node&lt;K,V&gt; p, Node&lt;K,V&gt; next) {
        return new Node&lt;&gt;(p.hash, p.key, p.value, next);
    }

    // Create a tree bin node
    TreeNode&lt;K,V&gt; newTreeNode(int hash, K key, V value, Node&lt;K,V&gt; next) {
        return new TreeNode&lt;&gt;(hash, key, value, next);
    }

    // For treeifyBin
    TreeNode&lt;K,V&gt; replacementTreeNode(Node&lt;K,V&gt; p, Node&lt;K,V&gt; next) {
        return new TreeNode&lt;&gt;(p.hash, p.key, p.value, next);
    }

    /**
     * Reset to initial default state.  Called by clone and readObject.
     */
    void reinitialize() {
        table = null;
        entrySet = null;
        keySet = null;
        values = null;
        modCount = 0;
        threshold = 0;
        size = 0;
    }

    // Callbacks to allow LinkedHashMap post-actions
    void afterNodeAccess(Node&lt;K,V&gt; p) { }
    void afterNodeInsertion(boolean evict) { }
    void afterNodeRemoval(Node&lt;K,V&gt; p) { }

    // Called only from writeObject, to ensure compatible ordering.
    void internalWriteEntries(java.io.ObjectOutputStream s) throws IOException {
        Node&lt;K,V&gt;[] tab;
        if (size &gt; 0 &amp;&amp; (tab = table) != null) {
            for (int i = 0; i &lt; tab.length; ++i) {
                for (Node&lt;K,V&gt; e = tab[i]; e != null; e = e.next) {
                    s.writeObject(e.key);
                    s.writeObject(e.value);
                }
            }
        }
    }

    /* ------------------------------------------------------------ */
    // Tree bins

    /**
     * Entry for Tree bins. Extends LinkedHashMap.Entry (which in turn
     * extends Node) so can be used as extension of either regular or
     * linked node.
     */
    static final class TreeNode&lt;K,V&gt; extends LinkedHashMap.Entry&lt;K,V&gt; {
        TreeNode&lt;K,V&gt; parent;  // red-black tree links
        TreeNode&lt;K,V&gt; left;
        TreeNode&lt;K,V&gt; right;
        TreeNode&lt;K,V&gt; prev;    // needed to unlink next upon deletion
        boolean red;
        TreeNode(int hash, K key, V val, Node&lt;K,V&gt; next) {
            super(hash, key, val, next);
        }

        /**
         * Returns root of tree containing this node.
         */
        final TreeNode&lt;K,V&gt; root() {
            for (TreeNode&lt;K,V&gt; r = this, p;;) {
                if ((p = r.parent) == null)
                    return r;
                r = p;
            }
        }

        /**
         * Ensures that the given root is the first node of its bin.
         */
        static &lt;K,V&gt; void moveRootToFront(Node&lt;K,V&gt;[] tab, TreeNode&lt;K,V&gt; root) {
            int n;
            if (root != null &amp;&amp; tab != null &amp;&amp; (n = tab.length) &gt; 0) {
                int index = (n - 1) &amp; root.hash;
                TreeNode&lt;K,V&gt; first = (TreeNode&lt;K,V&gt;)tab[index];
                if (root != first) {
                    Node&lt;K,V&gt; rn;
                    tab[index] = root;
                    TreeNode&lt;K,V&gt; rp = root.prev;
                    if ((rn = root.next) != null)
                        ((TreeNode&lt;K,V&gt;)rn).prev = rp;
                    if (rp != null)
                        rp.next = rn;
                    if (first != null)
                        first.prev = root;
                    root.next = first;
                    root.prev = null;
                }
                assert checkInvariants(root);
            }
        }

        /**
         * Finds the node starting at root p with the given hash and key.
         * The kc argument caches comparableClassFor(key) upon first use
         * comparing keys.
         */
        final TreeNode&lt;K,V&gt; find(int h, Object k, Class&lt;?&gt; kc) {
            TreeNode&lt;K,V&gt; p = this;
            do {
                int ph, dir; K pk;
                TreeNode&lt;K,V&gt; pl = p.left, pr = p.right, q;
                if ((ph = p.hash) &gt; h)
                    p = pl;
                else if (ph &lt; h)
                    p = pr;
                else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk)))
                    return p;
                else if (pl == null)
                    p = pr;
                else if (pr == null)
                    p = pl;
                else if ((kc != null ||
                          (kc = comparableClassFor(k)) != null) &amp;&amp;
                         (dir = compareComparables(kc, k, pk)) != 0)
                    p = (dir &lt; 0) ? pl : pr;
                else if ((q = pr.find(h, k, kc)) != null)
                    return q;
                else
                    p = pl;
            } while (p != null);
            return null;
        }

        /**
         * Calls find for root node.
         */
        final TreeNode&lt;K,V&gt; getTreeNode(int h, Object k) {
            return ((parent != null) ? root() : this).find(h, k, null);
        }

        /**
         * Tie-breaking utility for ordering insertions when equal
         * hashCodes and non-comparable. We don&apos;t require a total
         * order, just a consistent insertion rule to maintain
         * equivalence across rebalancings. Tie-breaking further than
         * necessary simplifies testing a bit.
         */
        static int tieBreakOrder(Object a, Object b) {
            int d;
            if (a == null || b == null ||
                (d = a.getClass().getName().
                 compareTo(b.getClass().getName())) == 0)
                d = (System.identityHashCode(a) &lt;= System.identityHashCode(b) ?
                     -1 : 1);
            return d;
        }

        /**
         * Forms tree of the nodes linked from this node.
         * @return root of tree
         */
        final void treeify(Node&lt;K,V&gt;[] tab) {
            TreeNode&lt;K,V&gt; root = null;
            for (TreeNode&lt;K,V&gt; x = this, next; x != null; x = next) {
                next = (TreeNode&lt;K,V&gt;)x.next;
                x.left = x.right = null;
                if (root == null) {
                    x.parent = null;
                    x.red = false;
                    root = x;
                }
                else {
                    K k = x.key;
                    int h = x.hash;
                    Class&lt;?&gt; kc = null;
                    for (TreeNode&lt;K,V&gt; p = root;;) {
                        int dir, ph;
                        K pk = p.key;
                        if ((ph = p.hash) &gt; h)
                            dir = -1;
                        else if (ph &lt; h)
                            dir = 1;
                        else if ((kc == null &amp;&amp;
                                  (kc = comparableClassFor(k)) == null) ||
                                 (dir = compareComparables(kc, k, pk)) == 0)
                            dir = tieBreakOrder(k, pk);

                        TreeNode&lt;K,V&gt; xp = p;
                        if ((p = (dir &lt;= 0) ? p.left : p.right) == null) {
                            x.parent = xp;
                            if (dir &lt;= 0)
                                xp.left = x;
                            else
                                xp.right = x;
                            root = balanceInsertion(root, x);
                            break;
                        }
                    }
                }
            }
            moveRootToFront(tab, root);
        }

        /**
         * Returns a list of non-TreeNodes replacing those linked from
         * this node.
         */
        final Node&lt;K,V&gt; untreeify(HashMap&lt;K,V&gt; map) {
            Node&lt;K,V&gt; hd = null, tl = null;
            for (Node&lt;K,V&gt; q = this; q != null; q = q.next) {
                Node&lt;K,V&gt; p = map.replacementNode(q, null);
                if (tl == null)
                    hd = p;
                else
                    tl.next = p;
                tl = p;
            }
            return hd;
        }

        /**
         * Tree version of putVal.
         */
        final TreeNode&lt;K,V&gt; putTreeVal(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab,
                                       int h, K k, V v) {
            Class&lt;?&gt; kc = null;
            boolean searched = false;
            TreeNode&lt;K,V&gt; root = (parent != null) ? root() : this;
            for (TreeNode&lt;K,V&gt; p = root;;) {
                int dir, ph; K pk;
                if ((ph = p.hash) &gt; h)
                    dir = -1;
                else if (ph &lt; h)
                    dir = 1;
                else if ((pk = p.key) == k || (k != null &amp;&amp; k.equals(pk)))
                    return p;
                else if ((kc == null &amp;&amp;
                          (kc = comparableClassFor(k)) == null) ||
                         (dir = compareComparables(kc, k, pk)) == 0) {
                    if (!searched) {
                        TreeNode&lt;K,V&gt; q, ch;
                        searched = true;
                        if (((ch = p.left) != null &amp;&amp;
                             (q = ch.find(h, k, kc)) != null) ||
                            ((ch = p.right) != null &amp;&amp;
                             (q = ch.find(h, k, kc)) != null))
                            return q;
                    }
                    dir = tieBreakOrder(k, pk);
                }

                TreeNode&lt;K,V&gt; xp = p;
                if ((p = (dir &lt;= 0) ? p.left : p.right) == null) {
                    Node&lt;K,V&gt; xpn = xp.next;
                    TreeNode&lt;K,V&gt; x = map.newTreeNode(h, k, v, xpn);
                    if (dir &lt;= 0)
                        xp.left = x;
                    else
                        xp.right = x;
                    xp.next = x;
                    x.parent = x.prev = xp;
                    if (xpn != null)
                        ((TreeNode&lt;K,V&gt;)xpn).prev = x;
                    moveRootToFront(tab, balanceInsertion(root, x));
                    return null;
                }
            }
        }

        /**
         * Removes the given node, that must be present before this call.
         * This is messier than typical red-black deletion code because we
         * cannot swap the contents of an interior node with a leaf
         * successor that is pinned by &quot;next&quot; pointers that are accessible
         * independently during traversal. So instead we swap the tree
         * linkages. If the current tree appears to have too few nodes,
         * the bin is converted back to a plain bin. (The test triggers
         * somewhere between 2 and 6 nodes, depending on tree structure).
         */
        final void removeTreeNode(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab,
                                  boolean movable) {
            int n;
            if (tab == null || (n = tab.length) == 0)
                return;
            int index = (n - 1) &amp; hash;
            TreeNode&lt;K,V&gt; first = (TreeNode&lt;K,V&gt;)tab[index], root = first, rl;
            TreeNode&lt;K,V&gt; succ = (TreeNode&lt;K,V&gt;)next, pred = prev;
            if (pred == null)
                tab[index] = first = succ;
            else
                pred.next = succ;
            if (succ != null)
                succ.prev = pred;
            if (first == null)
                return;
            if (root.parent != null)
                root = root.root();
            if (root == null || root.right == null ||
                (rl = root.left) == null || rl.left == null) {
                tab[index] = first.untreeify(map);  // too small
                return;
            }
            TreeNode&lt;K,V&gt; p = this, pl = left, pr = right, replacement;
            if (pl != null &amp;&amp; pr != null) {
                TreeNode&lt;K,V&gt; s = pr, sl;
                while ((sl = s.left) != null) // find successor
                    s = sl;
                boolean c = s.red; s.red = p.red; p.red = c; // swap colors
                TreeNode&lt;K,V&gt; sr = s.right;
                TreeNode&lt;K,V&gt; pp = p.parent;
                if (s == pr) { // p was s&apos;s direct parent
                    p.parent = s;
                    s.right = p;
                }
                else {
                    TreeNode&lt;K,V&gt; sp = s.parent;
                    if ((p.parent = sp) != null) {
                        if (s == sp.left)
                            sp.left = p;
                        else
                            sp.right = p;
                    }
                    if ((s.right = pr) != null)
                        pr.parent = s;
                }
                p.left = null;
                if ((p.right = sr) != null)
                    sr.parent = p;
                if ((s.left = pl) != null)
                    pl.parent = s;
                if ((s.parent = pp) == null)
                    root = s;
                else if (p == pp.left)
                    pp.left = s;
                else
                    pp.right = s;
                if (sr != null)
                    replacement = sr;
                else
                    replacement = p;
            }
            else if (pl != null)
                replacement = pl;
            else if (pr != null)
                replacement = pr;
            else
                replacement = p;
            if (replacement != p) {
                TreeNode&lt;K,V&gt; pp = replacement.parent = p.parent;
                if (pp == null)
                    root = replacement;
                else if (p == pp.left)
                    pp.left = replacement;
                else
                    pp.right = replacement;
                p.left = p.right = p.parent = null;
            }

            TreeNode&lt;K,V&gt; r = p.red ? root : balanceDeletion(root, replacement);

            if (replacement == p) {  // detach
                TreeNode&lt;K,V&gt; pp = p.parent;
                p.parent = null;
                if (pp != null) {
                    if (p == pp.left)
                        pp.left = null;
                    else if (p == pp.right)
                        pp.right = null;
                }
            }
            if (movable)
                moveRootToFront(tab, r);
        }

        /**
         * Splits nodes in a tree bin into lower and upper tree bins,
         * or untreeifies if now too small. Called only from resize;
         * see above discussion about split bits and indices.
         *
         * @param map the map
         * @param tab the table for recording bin heads
         * @param index the index of the table being split
         * @param bit the bit of hash to split on
         */
        final void split(HashMap&lt;K,V&gt; map, Node&lt;K,V&gt;[] tab, int index, int bit) {
            TreeNode&lt;K,V&gt; b = this;
            // Relink into lo and hi lists, preserving order
            TreeNode&lt;K,V&gt; loHead = null, loTail = null;
            TreeNode&lt;K,V&gt; hiHead = null, hiTail = null;
            int lc = 0, hc = 0;
            for (TreeNode&lt;K,V&gt; e = b, next; e != null; e = next) {
                next = (TreeNode&lt;K,V&gt;)e.next;
                e.next = null;
                if ((e.hash &amp; bit) == 0) {
                    if ((e.prev = loTail) == null)
                        loHead = e;
                    else
                        loTail.next = e;
                    loTail = e;
                    ++lc;
                }
                else {
                    if ((e.prev = hiTail) == null)
                        hiHead = e;
                    else
                        hiTail.next = e;
                    hiTail = e;
                    ++hc;
                }
            }

            if (loHead != null) {
                if (lc &lt;= UNTREEIFY_THRESHOLD)
                    tab[index] = loHead.untreeify(map);
                else {
                    tab[index] = loHead;
                    if (hiHead != null) // (else is already treeified)
                        loHead.treeify(tab);
                }
            }
            if (hiHead != null) {
                if (hc &lt;= UNTREEIFY_THRESHOLD)
                    tab[index + bit] = hiHead.untreeify(map);
                else {
                    tab[index + bit] = hiHead;
                    if (loHead != null)
                        hiHead.treeify(tab);
                }
            }
        }

        /* ------------------------------------------------------------ */
        // Red-black tree methods, all adapted from CLR

        static &lt;K,V&gt; TreeNode&lt;K,V&gt; rotateLeft(TreeNode&lt;K,V&gt; root,
                                              TreeNode&lt;K,V&gt; p) {
            TreeNode&lt;K,V&gt; r, pp, rl;
            if (p != null &amp;&amp; (r = p.right) != null) {
                if ((rl = p.right = r.left) != null)
                    rl.parent = p;
                if ((pp = r.parent = p.parent) == null)
                    (root = r).red = false;
                else if (pp.left == p)
                    pp.left = r;
                else
                    pp.right = r;
                r.left = p;
                p.parent = r;
            }
            return root;
        }

        static &lt;K,V&gt; TreeNode&lt;K,V&gt; rotateRight(TreeNode&lt;K,V&gt; root,
                                               TreeNode&lt;K,V&gt; p) {
            TreeNode&lt;K,V&gt; l, pp, lr;
            if (p != null &amp;&amp; (l = p.left) != null) {
                if ((lr = p.left = l.right) != null)
                    lr.parent = p;
                if ((pp = l.parent = p.parent) == null)
                    (root = l).red = false;
                else if (pp.right == p)
                    pp.right = l;
                else
                    pp.left = l;
                l.right = p;
                p.parent = l;
            }
            return root;
        }

        static &lt;K,V&gt; TreeNode&lt;K,V&gt; balanceInsertion(TreeNode&lt;K,V&gt; root,
                                                    TreeNode&lt;K,V&gt; x) {
            x.red = true;
            for (TreeNode&lt;K,V&gt; xp, xpp, xppl, xppr;;) {
                if ((xp = x.parent) == null) {
                    x.red = false;
                    return x;
                }
                else if (!xp.red || (xpp = xp.parent) == null)
                    return root;
                if (xp == (xppl = xpp.left)) {
                    if ((xppr = xpp.right) != null &amp;&amp; xppr.red) {
                        xppr.red = false;
                        xp.red = false;
                        xpp.red = true;
                        x = xpp;
                    }
                    else {
                        if (x == xp.right) {
                            root = rotateLeft(root, x = xp);
                            xpp = (xp = x.parent) == null ? null : xp.parent;
                        }
                        if (xp != null) {
                            xp.red = false;
                            if (xpp != null) {
                                xpp.red = true;
                                root = rotateRight(root, xpp);
                            }
                        }
                    }
                }
                else {
                    if (xppl != null &amp;&amp; xppl.red) {
                        xppl.red = false;
                        xp.red = false;
                        xpp.red = true;
                        x = xpp;
                    }
                    else {
                        if (x == xp.left) {
                            root = rotateRight(root, x = xp);
                            xpp = (xp = x.parent) == null ? null : xp.parent;
                        }
                        if (xp != null) {
                            xp.red = false;
                            if (xpp != null) {
                                xpp.red = true;
                                root = rotateLeft(root, xpp);
                            }
                        }
                    }
                }
            }
        }

        static &lt;K,V&gt; TreeNode&lt;K,V&gt; balanceDeletion(TreeNode&lt;K,V&gt; root,
                                                   TreeNode&lt;K,V&gt; x) {
            for (TreeNode&lt;K,V&gt; xp, xpl, xpr;;)  {
                if (x == null || x == root)
                    return root;
                else if ((xp = x.parent) == null) {
                    x.red = false;
                    return x;
                }
                else if (x.red) {
                    x.red = false;
                    return root;
                }
                else if ((xpl = xp.left) == x) {
                    if ((xpr = xp.right) != null &amp;&amp; xpr.red) {
                        xpr.red = false;
                        xp.red = true;
                        root = rotateLeft(root, xp);
                        xpr = (xp = x.parent) == null ? null : xp.right;
                    }
                    if (xpr == null)
                        x = xp;
                    else {
                        TreeNode&lt;K,V&gt; sl = xpr.left, sr = xpr.right;
                        if ((sr == null || !sr.red) &amp;&amp;
                            (sl == null || !sl.red)) {
                            xpr.red = true;
                            x = xp;
                        }
                        else {
                            if (sr == null || !sr.red) {
                                if (sl != null)
                                    sl.red = false;
                                xpr.red = true;
                                root = rotateRight(root, xpr);
                                xpr = (xp = x.parent) == null ?
                                    null : xp.right;
                            }
                            if (xpr != null) {
                                xpr.red = (xp == null) ? false : xp.red;
                                if ((sr = xpr.right) != null)
                                    sr.red = false;
                            }
                            if (xp != null) {
                                xp.red = false;
                                root = rotateLeft(root, xp);
                            }
                            x = root;
                        }
                    }
                }
                else { // symmetric
                    if (xpl != null &amp;&amp; xpl.red) {
                        xpl.red = false;
                        xp.red = true;
                        root = rotateRight(root, xp);
                        xpl = (xp = x.parent) == null ? null : xp.left;
                    }
                    if (xpl == null)
                        x = xp;
                    else {
                        TreeNode&lt;K,V&gt; sl = xpl.left, sr = xpl.right;
                        if ((sl == null || !sl.red) &amp;&amp;
                            (sr == null || !sr.red)) {
                            xpl.red = true;
                            x = xp;
                        }
                        else {
                            if (sl == null || !sl.red) {
                                if (sr != null)
                                    sr.red = false;
                                xpl.red = true;
                                root = rotateLeft(root, xpl);
                                xpl = (xp = x.parent) == null ?
                                    null : xp.left;
                            }
                            if (xpl != null) {
                                xpl.red = (xp == null) ? false : xp.red;
                                if ((sl = xpl.left) != null)
                                    sl.red = false;
                            }
                            if (xp != null) {
                                xp.red = false;
                                root = rotateRight(root, xp);
                            }
                            x = root;
                        }
                    }
                }
            }
        }

        /**
         * Recursive invariant check
         */
        static &lt;K,V&gt; boolean checkInvariants(TreeNode&lt;K,V&gt; t) {
            TreeNode&lt;K,V&gt; tp = t.parent, tl = t.left, tr = t.right,
                tb = t.prev, tn = (TreeNode&lt;K,V&gt;)t.next;
            if (tb != null &amp;&amp; tb.next != t)
                return false;
            if (tn != null &amp;&amp; tn.prev != t)
                return false;
            if (tp != null &amp;&amp; t != tp.left &amp;&amp; t != tp.right)
                return false;
            if (tl != null &amp;&amp; (tl.parent != t || tl.hash &gt; t.hash))
                return false;
            if (tr != null &amp;&amp; (tr.parent != t || tr.hash &lt; t.hash))
                return false;
            if (t.red &amp;&amp; tl != null &amp;&amp; tl.red &amp;&amp; tr != null &amp;&amp; tr.red)
                return false;
            if (tl != null &amp;&amp; !checkInvariants(tl))
                return false;
            if (tr != null &amp;&amp; !checkInvariants(tr))
                return false;
            return true;
        }
    }

}
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/07/12/java/gradleç®€æ˜æ•™ç¨‹/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/07/12/java/gradleç®€æ˜æ•™ç¨‹/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-07-12T16:27:30+08:00">
                2017-07-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2017-07-16T10:19:32+08:00â€<br>draft = false<br>title = â€œgradleç®€æ˜æ•™ç¨‹â€<br>categories = [ â€œjavaâ€, â€œgradleâ€, â€œgroovyâ€ ]<br>type=â€javaâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="gradleç®€æ˜æ•™ç¨‹"><a href="#gradleç®€æ˜æ•™ç¨‹" class="headerlink" title="gradleç®€æ˜æ•™ç¨‹"></a>gradleç®€æ˜æ•™ç¨‹</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ²¡æœ‰ gradle ä¸ maven å¯¹æ¯”ï¼Œä¹Ÿæ²¡æœ‰æ·±å…¥ gradle å®ç°ã€‚åªæœ‰ gradle ä» 0 å¼€å§‹ä½¿ç”¨çš„è¯´æ˜ã€‚</p>
<ul>
<li>ç®€ä»‹</li>
<li>å®‰è£…</li>
<li>æ–°å»ºä¸€ä¸ª gradle é¡¹ç›®</li>
<li>å¼•å…¥ä¸€ä¸ª gradle é¡¹ç›®</li>
<li>å¸¸è§é—®é¢˜</li>
<li>äº¤æµ</li>
</ul>
<h2 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h2><p>gradle æ˜¯ä¸€ä¸ªæ„å»ºå·¥å…·ã€‚è´Ÿè´£ç®¡ç†é¡¹ç›®ä¾èµ–ï¼Œç»„ç»‡é¡¹ç›®ç»“æ„ï¼Œå®Œæˆé¡¹ç›®æ„å»ºçš„å·¥ä½œã€‚</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>ä» å®˜ç½‘ ä¸‹è½½ï¼Œè§£å‹å³å¯ï¼Œå¹¶å°† bin/gradle å‘½ä»¤åŠ å…¥åˆ° path ä¸­ã€‚</p>
<h2 id="æ–°å»ºä¸€ä¸ª-gradle-é¡¹ç›®"><a href="#æ–°å»ºä¸€ä¸ª-gradle-é¡¹ç›®" class="headerlink" title="æ–°å»ºä¸€ä¸ª gradle é¡¹ç›®"></a>æ–°å»ºä¸€ä¸ª gradle é¡¹ç›®</h2><ol>
<li><p>æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ä½œä¸ºé¡¹ç›®æ–‡ä»¶å¤¹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">mkdir project-example</div><div class="line">cd project-example</div></pre></td></tr></table></figure>
</li>
<li><p>ä½¿ç”¨ gradle åˆå§‹åŒ–</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle init</div></pre></td></tr></table></figure>
<p>ç„¶åç›®å½•ä¸‹ä¼šç”Ÿæˆè¿™äº›æ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">build.gradle     // æ„å»ºè„šæœ¬æ–‡ä»¶ï¼Œä¸»è¦çš„æ„å»ºé…ç½®éƒ½åœ¨è¿™é‡Œå†™</div><div class="line">gradle           // å­˜æ”¾gradle wrapper æ‰§è¡Œé…ç½®å’Œå·¥å…·çš„æ–‡ä»¶å¤¹ï¼Œ</div><div class="line">gradlew          // gradle wrapper æ‰§è¡Œè„šæœ¬æ–‡ä»¶ï¼Œç”¨æ¥åœ¨æ²¡æœ‰å®‰è£… gradle çš„æƒ…å†µä¸‹æ‰§è¡Œ gradle å‘½ä»¤ã€‚å½“ç„¶ï¼Œç¬¬ä¸€æ¬¡æ‰§è¡Œæ—¶ä¼šä¸‹è½½ gradleã€‚</div><div class="line">gradlew.bat      // gradle wrapper æ‰§è¡Œè„šæœ¬æ–‡ä»¶çš„ windows ç‰ˆ</div><div class="line">settings.gradle  // é¡¹ç›®é…ç½®ï¼ŒæŒ‡æ˜æ ¹é¡¹ç›®åå­—å’Œå¼•å…¥çš„ module</div></pre></td></tr></table></figure>
</li>
<li><p>ä¿®æ”¹ build.gradle æ–‡ä»¶ï¼Œç»“æœåƒä¸‹é¢è¿™æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line">å£°æ˜æ’ä»¶ï¼Œå£°æ˜æ’ä»¶çš„æ–¹å¼æœ‰ä¸¤ç§ï¼Œä¸‹é¢è¿™ç§æ˜¯ 2.* ç‰ˆæœ¬ä¹‹åçš„æ–°çš„å®šä¹‰æ–¹å¼ã€‚å¯ä»¥å£°æ˜ä¸¤ç§æ’ä»¶ï¼š</div><div class="line">1. å®˜æ–¹å†…ç½®æ’ä»¶ï¼Œå¦‚ javaï¼Œideaã€‚</div><div class="line">2. åœ¨ gradle æ’ä»¶ä¸­å¿ƒæ³¨å†Œè¿‡çš„æ’ä»¶ï¼Œå¦‚ç¬¬ä¸‰ä¸ªå°±æ˜¯ï¼Œè¿™ç§è¦è¿˜è¦å£°æ˜ç‰ˆæœ¬ã€‚</div><div class="line">å£°æ˜æ’ä»¶çš„ç›®çš„æ˜¯å› ä¸ºæ’ä»¶ä¼šæä¾›å¾ˆå¤š taskï¼Œè€Œæ¯ä¸€ä¸ª task å°±æ˜¯ä¸€æ®µæ„å»ºè„šæœ¬ï¼Œå¯ä»¥æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚æ¯”å¦‚ compileJavaï¼Œtest ç­‰ã€‚</div><div class="line">*/</div><div class="line">plugins &#123;</div><div class="line">    id &apos;java&apos;</div><div class="line">    id &apos;idea&apos;</div><div class="line">    id &quot;com.yangxiaochen.scaffold&quot; version &quot;1.0.2&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line">å£°æ˜ group å’Œ ç‰ˆæœ¬ï¼Œè€Œ project çš„åå­—åœ¨ settings.gradle æ–‡ä»¶ä¸­ï¼Œè€Œå­ module ï¼Œæˆ–è€…åˆç§°ä¸º sub projects çš„åå­—é€šå¸¸å’Œæ–‡ä»¶å¤¹åå­—ä¸€æ ·ã€‚</div><div class="line">*/</div><div class="line">group &apos;com.yangxiaochen.gradle&apos;</div><div class="line">version &apos;1.0.0-SNAPSHOT&apos;</div><div class="line"></div><div class="line">/*</div><div class="line">å£°æ˜ä¾èµ–ä»“åº“ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯ jcenterï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–çš„å¦‚ mavenCentral ç­‰ã€‚ä¹Ÿå¯ä»¥å£°æ˜å¤šä¸ªï¼Œä¼šæŒ‰é¡ºåºæŸ¥æ‰¾ã€‚</div><div class="line">*/</div><div class="line">repositories &#123;</div><div class="line">    jcenter()</div><div class="line">&#125;</div><div class="line"></div><div class="line">/*</div><div class="line">å£°æ˜ä¾èµ–</div><div class="line">*/</div><div class="line">dependencies &#123;</div><div class="line">    compile &apos;org.slf4j:slf4j-api:1.7.21&apos;</div><div class="line">    testCompile &apos;junit:junit:4.12&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ç¼–è¾‘ settings.gradle æ–‡ä»¶å¦‚ä¸‹ï¼Œå£°æ˜äº†project name</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">rootProject.name = &apos;project-example&apos;</div><div class="line">// include &apos;sub-project&apos;</div></pre></td></tr></table></figure>
</li>
<li><p>å¼•å…¥åˆ° Idea IDE ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle idea</div></pre></td></tr></table></figure>
<p>ç›®å½•ä¸‹æ–°ç”Ÿæˆäº†ä¸‰ä¸ªæ–‡ä»¶</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">project-example.iml</div><div class="line">project-example.ipr</div><div class="line">project-example.iws</div></pre></td></tr></table></figure>
<p>æ¥ä¸‹æ¥åªè¦ç”¨ Idea IDE æ¥ open project-example.ipr æ–‡ä»¶ï¼Œå°±å¯ä»¥å¼•å…¥ project äº†ï¼Œ ä¹‹åæ¯å½“</p>
<ol>
<li><p>ä¾èµ–æ›´æ”¹</p>
</li>
<li><p>ç›®å½•ç»“æ„æ›´æ”¹</p>
</li>
</ol>
<p>åªè¦æ‰§è¡Œ <code>gradle cleanIdea idea</code> å°±å¯ä»¥åˆ·æ–°è¿™ä¸‰ä¸ªæ–‡ä»¶ï¼ŒIdea IDE å°±ä¼šé‡æ–°åŠ è½½è¯†åˆ«é¡¹ç›®äº†ã€‚</p>
<blockquote>
<p>æˆ‘çš„ç»éªŒæ˜¯ä¸è¦ä½¿ç”¨ Idea IDE æ¥ç›´æ¥ç”¨ build.gradle æ¥æ‰“å¼€æ–‡ä»¶ï¼Œå› ä¸º Idea IDE åœ¨è§£æ build.gradle æ–‡ä»¶æ—¶æœ‰å…¶ä»–æ“ä½œï¼Œè€Œä¸” Idea IDE ä¸ gradle ç‰ˆæœ¬æœ‰æ—¶ä¼šä¸å¤ªå…¼å®¹ï¼Œå¯¼è‡´é¡¹ç›®è§£æé”™è¯¯ï¼›è€Œä½¿ç”¨ gradle æ¥ç”Ÿæˆ Idea IDE å·¥ç¨‹æ–‡ä»¶çš„æ–¹å¼å°±ä¸ä¼šæœ‰é—®é¢˜ï¼Œè€Œä¸”é€Ÿåº¦æ›´å¿«ï¼Œæ›´å®¹æ˜“debugã€‚</p>
</blockquote>
</li>
<li><p>å¼•å…¥ä¹‹åï¼Œè¿˜éœ€è¦ç”Ÿæˆ src æ–‡ä»¶å¤¹å’Œ sub project</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">gradle createSrc idea</div><div class="line">gradle createModule --name foo idea</div></pre></td></tr></table></figure>
<p><code>createSrc</code> å’Œ<code>createModule</code>éƒ½æ˜¯æ’ä»¶ <code>com.yangxiaochen.scaffold</code>é‡Œçš„ taskï¼Œè€Œ <code>idea</code>å’Œ<code>cleanIdea</code> æ˜¯æ’ä»¶ <code>idea</code>æä¾›çš„ task</p>
</li>
</ol>
<h2 id="å¼•å…¥ä¸€ä¸ª-gradle-é¡¹ç›®"><a href="#å¼•å…¥ä¸€ä¸ª-gradle-é¡¹ç›®" class="headerlink" title="å¼•å…¥ä¸€ä¸ª gradle é¡¹ç›®"></a>å¼•å…¥ä¸€ä¸ª gradle é¡¹ç›®</h2><p>è·Ÿä¸Šä¸€èŠ‚åˆ›å»ºä¸€ä¸ª gradle é¡¹ç›®ç±»ä¼¼ï¼Œå¼•å…¥<code>idea</code>æ’ä»¶ï¼Œç„¶åç”Ÿæˆ Idea IDE çš„å·¥ç¨‹æ–‡ä»¶ï¼Œå† open å³å¯</p>
<h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><h3 id="æ’ä»¶é€‰æ‹©"><a href="#æ’ä»¶é€‰æ‹©" class="headerlink" title="æ’ä»¶é€‰æ‹©"></a>æ’ä»¶é€‰æ‹©</h3><p>å†…ç½®æ’ä»¶éƒ½åœ¨å®˜æ–¹æ–‡æ¡£ä¸­æœ‰è¯´æ˜ï¼Œé™¤äº†å†…ç½®æ’ä»¶å¤–, å¯ä»¥ <a href="https://plugins.gradle.org/" target="_blank" rel="external">Search Gradle plugins</a>ï¼Œgradle æ’ä»¶çš„å®˜æ–¹ä»“åº“ã€‚</p>
<h3 id="buildé€Ÿåº¦æ…¢"><a href="#buildé€Ÿåº¦æ…¢" class="headerlink" title="buildé€Ÿåº¦æ…¢"></a>buildé€Ÿåº¦æ…¢</h3><p>é€Ÿåº¦æ…¢ä¸€èˆ¬æ¥è¯´æ˜¯ä¾èµ–æ›´æ–°æ…¢ï¼Œå› ä¸ºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œå›½å†…ä½¿ç”¨å›½å¤–çš„ä»“åº“é€Ÿåº¦å¹¶ä¸ä¹è§‚ï¼Œæ‰€ä»¥å¯ä»¥æ›¿æ¢<code>repositories</code>, ä½¿ç”¨é˜¿é‡Œäº‘çš„ä»“åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">repositories &#123;</div><div class="line">  maven &#123;</div><div class="line">  	url &quot;http://maven.aliyun.com/nexus/content/groups/public&quot;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†è€…, æœ‰çš„åŒå­¦ä½¿ç”¨ç§æœ, å¯èƒ½æ˜¯å…¬å¸æ­å»ºçš„. è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰ä¸ç¨³å®š, ä¸”æœ‰æ—¶éœ€è¦è®¤è¯çš„æƒ…å†µ. çœ‹ç¨åçš„ç« èŠ‚.</p>
<h3 id="å¦‚ä½•debug"><a href="#å¦‚ä½•debug" class="headerlink" title="å¦‚ä½•debug"></a>å¦‚ä½•debug</h3><p>gradle è¿è¡Œä¸­çš„æç¤ºå¹¶ä¸ç®—å¾ˆå‹å¥½, å°¤å…¶åœ¨é“¾æ¥ä»“åº“å’Œä¸‹è½½jaråŒ…æ—¶, åœ¨è¿æ¥æœ‰é—®é¢˜çš„æ—¶å€™, ç»å¸¸æ²¡æœ‰æç¤º(æ–°ç‰ˆæœ¬çš„å¯èƒ½å¥½ä¸€äº›.)</p>
<p>ç»å¸¸ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">gradle idea -i</div><div class="line">gradle idea -id</div><div class="line"></div><div class="line">è¿˜å¯ä»¥åŠ å…¥ --no-daemon å‚æ•°æ¥é¿å…daemonå¯åŠ¨äº§ç”Ÿçš„æ—¥å¿—å¹²æ‰°</div><div class="line">gradle idea -id --no-daemon</div><div class="line">ä¸€èˆ¬æ¥è¯´å°±èƒ½å®šä½åˆ°æ„å»ºé—®é¢˜.</div></pre></td></tr></table></figure>
<p>æ¥è·å–æ›´å¤šçš„ä¿¡æ¯. æ¯”è¾ƒå¸¸è§çš„å¡ä½æ˜¯å› ä¸º<code>ä»“åº“é“¾æ¥ä¸ä¸Š</code>, <code>jaråŒ…ä¸‹è½½é“¾æ¥ä¸ä¸Š, åˆä¸è¿”å› response (ç§æœ‰ä»“åº“å¶å°”æœ‰é—®é¢˜)</code>, <code>èµ„æºä¸‹è½½ç¼“æ…¢</code>, <code>ä»“åº“éœ€è¦è®¤è¯ç™»é™†</code></p>
<ul>
<li>ä»“åº“è¿æ¥ä¸ä¸Š: æ£€æŸ¥ä»“åº“åœ°å€, æ£€æŸ¥ç½‘ç»œ.</li>
<li>èµ„æºæ— æ³•è¿æ¥åˆæ²¡æœ‰response: è¿™ç§é€šå¸¸ä¼šåœ¨ä¸Šé¢æ‰“å‡ºçš„æ—¥å¿—ä¸­ä½“ç°, è¯·æ±‚ä¸€ä¸ª url ä¾¿æ²¡æœ‰å“åº”.</li>
<li>ä¸‹è½½ç¼“æ…¢: æ›´æ¢ä»“åº“, æˆ–è€…å¿è€ä¸‹ç¬¬ä¸€æ¬¡, ä»¥åä¼šå¥½å¾ˆå¤š</li>
</ul>
<p>åœ¨ IDEA åˆ·æ–°æœ‰é—®é¢˜æ—¶, å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤debug, ä¸€èˆ¬è¿™ä¸ªå‘½ä»¤èƒ½æˆåŠŸ, é‚£ä¹ˆ IDEA åˆ·æ–°é€šå¸¸ä¹Ÿèƒ½æˆåŠŸ. (è¯·æ³¨æ„ç‰ˆæœ¬é—®é¢˜, å‘½ä»¤è¡Œé‡Œæ‰§è¡Œçš„ gradle ç‰ˆæœ¬éœ€è¦è·Ÿ IDEA é‡Œé…ç½®çš„ gradle ç‰ˆæœ¬ä¸€è‡´)</p>
<h3 id="ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜"><a href="#ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜" class="headerlink" title="ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜"></a>ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜</h3><p>ç§æœä½¿ç”¨ä¸­ä¼šæœ‰ä»¥ä¸‹é—®é¢˜: </p>
<ol>
<li><p>ä¸ç¨³å®š, å¶å°”æœåŠ¡æ— å“åº”.</p>
</li>
<li><p>é…ç½®å‡ºé”™, æ— æ³• proxy maven ä¸»ä»“åº“. æˆ–è€…å‡ºç°ç§æœä¸­å­˜åœ¨ç¬¬ä¸‰æ–¹åŒ…ä½†æ˜¯å´ä¸å®Œæ•´åˆ°æ—¶æ— æ³•ä¸‹è½½.</p>
<p>ä¸€èˆ¬æ¥è¯´ä¼šå°è¯•æŠŠç¬¬ä¸‰æ–¹ä»“åº“é…ç½®åˆ°ç§æœä¹‹å‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">maven &#123;</div><div class="line">  url &quot;http://maven.aliyun.com/nexus/content/groups/public&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">maven &#123;</div><div class="line">  url &quot;http://ä½ å®¶ç§æœåœ°å€/&quot;</div><div class="line">  credentials &#123;</div><div class="line">    username &quot;xxx&quot;</div><div class="line">    password &quot;xxx&quot;</div><div class="line">  &#125;</div><div class="line">  authentication &#123;</div><div class="line">  	basic(BasicAuthentication)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å…ˆå»ç¬¬ä¸‰æ–¹æŸ¥æ‰¾, å†åˆ°ç§æœæŸ¥æ‰¾.</p>
</li>
<li><p>ç§æœæœ‰è®¤è¯. å¯ä»¥å‚ç…§ç¬¬äºŒæ¡ç§æœçš„è®¤è¯æ–¹å¼. å…¶ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">authentication &#123;</div><div class="line">	basic(BasicAuthentication)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ˜¯å¯é€‰å¡«çš„, ä¸å¡«çš„è¯ä¼šè‡ªåŠ¨è¯†åˆ«è®¤è¯æ–¹å¼.</p>
</li>
<li><p>æ‰“åŒ…æ–¹å¼ä¸å®Œæ•´. æœ‰çš„åŒå­¦ä¸Šä¼ åŒ…çš„æ—¶å€™è™½ç„¶åŒ…å«äº†ç¼–è¯‘åçš„jaråŒ…, pomæ–‡ä»¶, ä½†æ˜¯æœ‰æ—¶å´æ²¡æœ‰æŠŠsourceåŒ…ä¸Šä¼ , gradle é»˜è®¤æ˜¯ä¼šä¸‹è½½sourceçš„, å¦‚æœæ²¡æœ‰, ç§æœè¿”å›404è¿˜å¥½, æœ€æ€•ä¼šå¡ä¸»(é‡åˆ°è¿‡ç§æœè™½ç„¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å´è¿Ÿè¿Ÿä¸è¿”å›responseçš„æƒ…å†µ.), æ‰€ä»¥, å¦‚æœé‡åˆ°è¿™ç§é—®é¢˜, å¯ä»¥: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">idea &#123;</div><div class="line">	module &#123;</div><div class="line">		downloadJavadoc = false</div><div class="line">		downloadSources = false</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸è®© IDEA åˆ·æ–°çš„æ—¶å€™ä¸‹è½½æºç å’Œæ–‡æ¡£, ä¸‡ä¸å¾—å·²è¿˜æ˜¯ä¸è¦ç”¨.</p>
</li>
</ol>
<h3 id="å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°"><a href="#å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°" class="headerlink" title="å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°"></a>å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°</h3><p><code>--refresh-dependencies</code>   åˆ·æ–°ä¾èµ–ï¼Œåˆ·æ–°é‚£äº›SNAPSHOTçš„ä¾èµ–ï¼Œç±»ä¼¼äº maven çš„ -U å‚æ•°</p>
<p><code>gradle tasks</code> åˆ—å‡ºæ‰€æœ‰å¯æ‰§è¡Œçš„task</p>
<p><code>gradle tasks --all</code> åˆ—å‡ºæ‰€æœ‰å¯æ‰§è¡Œçš„task, å¹¶é™„åŠ ä¸Š mudole</p>
<p><code>gradle help --task taskName</code>  æŸ¥çœ‹ä¸€ä¸ªtaskçš„å¸®åŠ©, ä¸è¿‡å¹¶ä¸æ˜¯æ‰€æœ‰taskéƒ½æœ‰, å› ä¸ºtaskéƒ½æ˜¯å¯ä»¥è‡ªå·±æ¥å®ç°çš„.</p>
<p><code>gradle idea -id</code> ç”¨æ¥debug IDEAè¿›è¡Œåˆ·æ–°æ—¶é‡åˆ°çš„é—®é¢˜, ä¸€èˆ¬è¿™ä¸ªä»»åŠ¡èƒ½æˆåŠŸ, åˆ·æ–°å°±èƒ½æˆåŠŸ. æ³¨æ„ä½¿ç”¨çš„ gradle ç‰ˆæœ¬è¦ä¸€è‡´.</p>
<p><code>--no-daemon</code> ä¸æ˜¯ä½¿ç”¨daemonè¿›è¡Œæ„å»º. daemonçš„ä½œç”¨æ˜¯ä¸ç”¨æ¯æ¬¡ build éƒ½å†å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹, èŠ‚çœæ—¶é—´. ä½†å´ä¼šåœ¨æˆ‘ä»¬ debug é—®é¢˜çš„æ—¶å€™ä¸åœçš„ç”Ÿäº§æ—¥å¿—, äº§ç”Ÿå¹²æ‰°.</p>
<h3 id="ä¾èµ–å†²çªå¤„ç†"><a href="#ä¾èµ–å†²çªå¤„ç†" class="headerlink" title="ä¾èµ–å†²çªå¤„ç†"></a>ä¾èµ–å†²çªå¤„ç†</h3><p>å¯ä»¥é€šè¿‡å‘½ä»¤æ¥æŸ¥çœ‹ä¸€ä¸ªé¡¹ç›®çš„ä¾èµ–</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle webapp:dependencies --configuration=compile</div></pre></td></tr></table></figure>
<p>ä¸åŒäºmavençš„<strong>æœ€è¿‘</strong>åŸåˆ™ï¼Œgradle ä¾èµ–ä½¿ç”¨çš„æ˜¯<strong>æœ€æ–°</strong>åŸåˆ™. æ¯”å¦‚ä½ æ„å»ºå¤„äºä¾èµ–é¡¶å±‚çš„ module , é‚£ä¹ˆç‰ˆæœ¬ä¼šä¼˜å…ˆä½¿ç”¨è¿™ä¸ªé¡¶å±‚module çš„<code>build.grale</code> ä¸­å®šä¹‰çš„ç‰ˆæœ¬. æ‰€ä»¥å¯ä»¥åœ¨é¡¶å±‚module ä¸­å¼ºåˆ¶å®šä¹‰ç‰ˆæœ¬</p>
<p>ä¾èµ–æ’é™¤, é€šå¸¸å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;) &#123;</div><div class="line">    exclude module: &quot;spring-boot-starter-logging&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¯­æ³•, è¿˜æœ‰æ›´ä¸ºç²—æš´ç›´æ¥çš„: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">configurations &#123;</div><div class="line">    all*.exclude group: &apos;ch.qos.logback&apos;, module: &apos;logback-classic&apos;</div><div class="line">    all*.exclude group: &apos;ch.qos.logback&apos;, module: &apos;logback-core&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p>å®˜æ–¹æ–‡æ¡£ç›¸å½“çš„è¯¦ç»†ï¼Œä¸”é™„æœ‰å¾ˆå¤šexampleï¼Œé…åˆ gradle å®‰è£…åŒ…é‡Œçš„ example æºæ–‡ä»¶é˜…è¯»</p>
<h2 id="äº¤æµ"><a href="#äº¤æµ" class="headerlink" title="äº¤æµ"></a>äº¤æµ</h2><p>æ¬¢è¿åŠ å…¥ç¾¤ 536890082ï¼Œgradleï¼Œspringï¼Œactiviti äº¤æµ</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/06/25/java/å¼‚å¸¸å®è·µ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/25/java/å¼‚å¸¸å®è·µ/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-06-25T18:50:22+08:00">
                2017-06-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2017-07-10T10:19:32+08:00â€<br>draft = false<br>title = â€œJava web é¡¹ç›®å¼‚å¸¸è®¾è®¡å®è·µâ€<br>categories = [ â€œjavaâ€, â€œexceptionâ€, â€œå®è·µâ€ ]<br>type=â€javaâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="å¼‚å¸¸å®è·µ"><a href="#å¼‚å¸¸å®è·µ" class="headerlink" title="å¼‚å¸¸å®è·µ"></a>å¼‚å¸¸å®è·µ</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>æœ¬æ–‡æ˜¯æˆ‘åœ¨é¡¹ç›®ä¸­è®¾è®¡å’Œå¤„ç†å¼‚å¸¸çš„ä¸€äº›å®è·µï¼Œä¸»è¦æ˜¯å›´ç»•ç€å¸¸è§çš„webé¡¹ç›®ï¼Œæ¬¢è¿å¤§å®¶æŒ‡æ­£ã€‚</p>
<p>æœ¬æ–‡åˆ†ä¸ºä¸¤ä¸ªä¸ªéƒ¨åˆ†</p>
<ol>
<li>å¼‚å¸¸è®¾è®¡</li>
<li>å¼‚å¸¸å¤„ç†</li>
</ol>
<h2 id="å¼‚å¸¸è®¾è®¡"><a href="#å¼‚å¸¸è®¾è®¡" class="headerlink" title="å¼‚å¸¸è®¾è®¡"></a>å¼‚å¸¸è®¾è®¡</h2><p>é€šå¸¸è€ƒè™‘å¼‚å¸¸è®¾è®¡æ—¶å¤§è‡´åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†</p>
<ol>
<li>æ¥å£å±‚</li>
<li>ä¸šåŠ¡å±‚</li>
<li>ç±»åº“</li>
</ol>
<p>æ¥å£å±‚å°±æ˜¯æˆ‘ä»¬é€šå¸¸è¯´çš„ controller å±‚ï¼Œä»¥åŠæä¾› rpc æœåŠ¡çš„æ¥å£å±‚ã€‚</p>
<p>ä¸šåŠ¡å±‚å°±æ˜¯ä¸»è¦çš„ä¸šåŠ¡ä»£ç æ¨¡å—ï¼Œä¸»è¦æ˜¯ service å±‚ã€‚</p>
<p>ç±»åº“ä¸»è¦æ˜¯æŒ‡ä¸€äº›å…¬å…±æ¨¡å—ï¼Œå¯ä»¥åœ¨å„ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨çš„ï¼Œæ¯”å¦‚ jsonï¼Œåˆ†å¸ƒå¼é”ç­‰ã€‚</p>
<h3 id="ä¸šåŠ¡å±‚"><a href="#ä¸šåŠ¡å±‚" class="headerlink" title="ä¸šåŠ¡å±‚"></a>ä¸šåŠ¡å±‚</h3><p>åœ¨ä¸šåŠ¡å±‚ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯è¦è®¾è®¡<strong>ä¸šåŠ¡å¼‚å¸¸</strong>ã€‚ä»€ä¹ˆæ˜¯ä¸šåŠ¡å¼‚å¸¸ï¼Ÿä¸šåŠ¡å¼‚å¸¸å°±æ˜¯æˆ‘ä»¬èƒ½å¤Ÿäººä¸ºçš„åˆ¤æ–­å‡ºä¸šåŠ¡é€»è¾‘èµ°åˆ°æŸä¸€ä¸ªä½ç½®æ˜¯ä¸å¯¹çš„ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬è¦æ ¹æ®ä¸€ä¸ª uid æ¥ä¿®æ”¹ä¸€ä¸ª user çš„ nameï¼Œä½†æˆ‘ä»¬å‘ç°å¹¶æ²¡æœ‰è¿™ä¸ª uid å¯¹åº”çš„ user æ•°æ®ï¼Œè¿™æ—¶å€™å°±åº”è¯¥æŠ›å‡ºä¸€ä¸ªä¸šåŠ¡å¼‚å¸¸ã€‚åœ¨å‘ç”Ÿä¸šåŠ¡å¼‚å¸¸æ—¶ï¼Œè¦é¿å…æŠ›å‡º npeï¼ŒRuntimeException ç­‰å…¶ä»–å†…ç½®å¼‚å¸¸ï¼Œä»¥æ–¹ä¾¿ä¸Šå±‚æ¥åˆ†è¾¨åˆ°åº•æ˜¯ä¸šåŠ¡é”™è¯¯è¿˜æ˜¯ç¨‹åº bugã€‚</p>
<p>æˆ‘ä¸€èˆ¬ä¼šè®¾è®¡ä¸€ä¸ªä¸šåŠ¡å¼‚å¸¸çš„åŸºç±» <code>ServiceException</code>ï¼Œå°†æ‰€æœ‰ä¸šåŠ¡å¼‚å¸¸ä»¥è¿™ç§ç±»å‹æ¥æŠ›å‡ºï¼Œå¹¶å¸¦æœ‰å¿…è¦çš„ messageã€‚</p>
<p>ä¸ºäº†æŠŠç”¨æˆ·å¯è¯»çš„æ¶ˆæ¯å’Œå¼€å‘äººå‘˜å¯è¯»çš„æ¶ˆæ¯åŒºåˆ«å¼€ï¼Œ<code>ServiceException</code> è¿˜éœ€è¦å®ç°ä¸€ä¸ªæ¥å£ <code>UserMessage</code>ï¼Œå¹¶å®ç°å…¶ä¸­æ–¹æ³• <code>getUserMessage()</code>æ¥è¿”å›ç”¨æˆ·å¯è¯»çš„ä¿¡æ¯ï¼Œè€Œ getMessage() å¯ä»¥æºå¸¦æ›´è¯¦ç»†çš„å¼€å‘äººå‘˜å¯è¯»çš„é”™è¯¯ä¿¡æ¯</p>
<p>è®¾è®¡ä¸€ä¸ª <code>ServiceErrorException</code>ï¼Œç»§æ‰¿ <code>ServiceException</code>ã€‚<code>ServiceErrorException</code> çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è¡¨æ˜è¿™ä¸ªå¼‚å¸¸çš„é”™è¯¯ç¨‹åº¦é«˜ï¼Œéœ€è¦è®°å½• errorã€‚</p>
<p>ä»¥ä¸Šå°±å®šå‹äº†ä¸šåŠ¡å¼‚å¸¸çš„åŸºæœ¬ç»“æ„ï¼Œä¸Šé¢ä¸€äº›ç‰¹æ®Šè®¾è®¡ä¼šåœ¨<strong>å¼‚å¸¸å¤„ç†</strong>ä¸­ç”¨åˆ°ï¼Œæˆ‘ä»¬åé¢æ¥è¯´ï¼Œå†åšå‰åå¯¹ç…§ã€‚æˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦æ¥å®ç°è‹¥å¹²å­ç±»æ¥è¡¨ç¤ºä¸šåŠ¡å±‚ä¸­ä¸åŒæ¨¡å—çš„é”™è¯¯ã€‚</p>
<h3 id="æ¥å£å±‚"><a href="#æ¥å£å±‚" class="headerlink" title="æ¥å£å±‚"></a>æ¥å£å±‚</h3><p>å¯¹äºæ¥å£å±‚ï¼Œç‰¹åˆ«æ˜¯rpcè°ƒç”¨ï¼Œæ¯”å¦‚æˆ‘ä»¬çš„dubboè°ƒç”¨ï¼Œéœ€è¦æŠŠapiçš„jaråŒ…æ”¾åœ¨è°ƒç”¨æ–¹ã€‚æˆ‘ä»¬éœ€è¦æŠŠå¼‚å¸¸ç±»ç»™åŒ…æ‹¬è¿›å»ï¼Œä½†è°ƒç”¨æ–¹ä¸èƒ½ä¹Ÿä¸åº”è¯¥æ‹¿åˆ°æˆ‘ä»¬ä¸šåŠ¡å±‚çš„ <code>ServiceException</code>ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ¥å£å±‚å®šä¹‰æ–°çš„ä¸šåŠ¡å¼‚å¸¸ç±»å‹ï¼Œæ¯”å¦‚ï¼Œå°±å«<code>ApiServiceException</code>ï¼Œæ”¾åœ¨apiçš„jaråŒ…é‡Œç»™è°ƒç”¨æ–¹ã€‚</p>
<p>æ¥å£å®ç°éœ€è¦æŠŠä¸šåŠ¡å±‚çš„<code>ServiceException</code>ç»™catchåˆ°ï¼Œé‡æ–°å°è£…ä¸º<code>ApiServiceException</code>æŠ›å‡ºã€‚</p>
<p>è¿™æ ·ï¼Œè°ƒç”¨æ–¹åœ¨åˆ¤æ–­è°ƒç”¨æ—¶å‘ç”Ÿçš„å¼‚å¸¸æ—¶ï¼Œæœ‰ä¸‰ç§å¯èƒ½ï¼š</p>
<ol>
<li>rpcæ¡†æ¶å¼‚å¸¸ã€‚æ¯”å¦‚åˆdubboæ¡†æ¶æŠ›å‡ºçš„å¼‚å¸¸ï¼Œè¿™ä¸€ç‰ˆä¸¤ç§å¯èƒ½ï¼š1. ç½‘ç»œå¼‚å¸¸ï¼Œæˆ‘ä»¬éœ€è¦é‡è¯•ï¼›2. è°ƒç”¨æœªèƒ½è¾¾æˆï¼Œè¿™ç§ä¸€èˆ¬æ˜¯æ¥å£æ²¡æœ‰åŒ¹é…ä¸Šï¼Œåœ¨å¼€å‘æµ‹è¯•æ—¶éƒ½å¯ä»¥å‘ç°çš„é”™è¯¯ï¼Œæ”¹æ‰å³å¯ã€‚æ‰€ä»¥ï¼Œå½“å‘ç”Ÿrpcæ¡†æ¶å¼‚å¸¸æ—¶ï¼Œè°ƒç”¨æ–¹çš„ç­–ç•¥å°±åº”è¯¥æ˜¯é‡è¯•ã€‚</li>
<li>ApiServiceExceptionã€‚è¿™è¡¨ç¤ºè¢«è°ƒç”¨æ–¹å‡ºç°äº†ä¸šåŠ¡å¼‚å¸¸ï¼Œè°ƒç”¨æ–¹ä¹Ÿéœ€è¦ä½œä¸ºä¸šåŠ¡å¼‚å¸¸æ¥å¤„ç†ã€‚</li>
<li>å…¶ä»–å¼‚å¸¸ã€‚è¿™è¡¨ç¤ºè¢«è°ƒç”¨æ–¹çš„ç¨‹åºæœ‰bugæŠ¥å‡ºäº†å¼‚å¸¸é€ä¼ ç»™äº†è°ƒç”¨æ–¹ï¼Œè¿™æ˜¯è°ƒç”¨æ–¹åº”åŠæ—¶è”ç³»æ¥å£å®ç°æ–¹æ¥ä¿®è¡¥bugã€‚</li>
</ol>
<p>ä»¥ä¸Šï¼Œå°±èƒ½å¤Ÿåˆ†ç±»å‡†ç¡®åº”å¯¹rpcè¿‡ç¨‹ä¸­çš„å¼‚å¸¸æƒ…å†µã€‚</p>
<p>httpæ–¹å¼çš„æ¥å£å±‚ä¹Ÿå¯ä»¥è¿™ä¹ˆåšï¼Œä¸è¿‡ç”±äºapiå¹¶ä¸å¯¹å¤–ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥å®Œå…¨ç”±è‡ªèº«æ¥å¤„ç†å¼‚å¸¸ç±»å‹ï¼Œè¯¦è§<strong>å¼‚å¸¸å¤„ç†</strong>éƒ¨åˆ†ã€‚</p>
<h3 id="ç±»åº“"><a href="#ç±»åº“" class="headerlink" title="ç±»åº“"></a>ç±»åº“</h3><p>ä½œä¸ºç±»åº“ï¼Œå› ä¸ºé€šå¸¸æ²¡æœ‰ä¸šåŠ¡æ„ä¹‰ï¼Œæ‰€ä»¥åœ¨å‘ç”Ÿé€»è¾‘ä¸Šçš„å¼‚å¸¸æ—¶ï¼Œæ ¹æœ¬ä¸å¯èƒ½çŸ¥é“éœ€è¦æ€ä¹ˆå¤„ç†ï¼Œè¿™å°±éœ€è¦ç›´æ¥å‘ä¸ŠæŠ›å‡ºï¼Œåˆ°äº¤ç»™ä¸šåŠ¡å±‚å¤„ç†ã€‚</p>
<p>ç±»åº“éœ€è¦å°†è‡ªèº«çš„é€»è¾‘ä¸Šçš„å¼‚å¸¸ï¼ŒåŒä¸€å°è£…ã€‚æ¯”å¦‚ï¼Œå¤„ç† Json çš„ç±»åº“ï¼Œå¼‚å¸¸æœ€ç»ˆæŠ›å‡ºæ—¶ï¼Œéƒ½è¢«å°è£…æˆä¸º<code>JsonParseException</code> æˆ– <code>JsonSerializeExcption</code>ã€‚</p>
<p>è¿™æ ·è°ƒç”¨æ–¹ä½¿ç”¨ç±»åº“æ—¶ï¼Œå¼‚å¸¸ä¼šæœ‰ä¸¤ç§ï¼š</p>
<ol>
<li>ç±»åº“å°è£…çš„è‡ªå®šä¹‰å¼‚å¸¸ã€‚è¿™ç§æ˜¯è°ƒç”¨æ—¶å‡ºç°çš„é€»è¾‘é”™è¯¯ï¼Œè°ƒç”¨æ–¹ä»¥ä¸šåŠ¡å¼‚å¸¸æ¥å¤„ç†ã€‚</li>
<li>å…¶ä»–å¼‚å¸¸ã€‚å¯ä»¥è®¤ä¸ºæ˜¯ç±»åº“bugã€‚</li>
</ol>
<h2 id="å¼‚å¸¸å¤„ç†"><a href="#å¼‚å¸¸å¤„ç†" class="headerlink" title="å¼‚å¸¸å¤„ç†"></a>å¼‚å¸¸å¤„ç†</h2><p>æœ‰äº†ä»¥ä¸Šçš„å¼‚å¸¸è®¾è®¡ï¼Œé‚£ä¹ˆå¤„ç†æ—¶å°±å¯ä»¥æŒ‰ç…§ä»¥ä¸‹æµç¨‹ã€‚</p>
<p>ä»¥ http è¯·æ±‚çš„ ExceptionHandler ä¸ºä¾‹ï¼Œæ‰€æœ‰ http è¯·æ±‚å¼‚å¸¸éƒ½ä¼šæ”¾åœ¨è¿™é‡Œå¤„ç†ï¼Œè¿‡ç¨‹ï¼š</p>
<ol>
<li>ex å¼‚å¸¸ä¼ å…¥ã€‚</li>
<li>è£…é¥° ex å¼‚å¸¸ï¼Œ<code>ex = new WebApiException(...,ex)</code>ï¼Œå…¶åŒ…å«æœ‰ <code>message</code>ï¼Œ<code>isLogError</code> å±æ€§<ol>
<li>å¦‚æœ ex æ˜¯é <code>ServiceException</code>ï¼Œé‚£ä¹ˆ<code>message = â€œç³»ç»Ÿå†…éƒ¨é”™è¯¯â€</code>ï¼Œ<code>isLogError = true</code>ã€‚</li>
<li>å¦‚æœ ex æ˜¯ <code>ServiceException</code>ï¼Œé‚£ä¹ˆ<code>message = ex.getUserMessage()</code>ï¼›æ›´è¿›ä¸€æ­¥ï¼Œå¦‚æœæ˜¯ <code>ServiceErrorException</code>ï¼Œé‚£ä¹ˆ<code>isLogError = true</code>ï¼Œå¦åˆ™ <code>isLogError = false</code>ã€‚</li>
</ol>
</li>
<li>å¦‚æœ <code>ex.isLogError == true</code>ï¼Œè®°å½• error logï¼Œå¦åˆ™ï¼Œè®°å½• warn logã€‚</li>
<li>åˆ¤æ–­ http è¯·æ±‚æ˜¯é¡µé¢è¯·æ±‚ï¼Œè¿˜æ˜¯ajaxè¯·æ±‚ã€‚<ol>
<li>å¦‚æœæ˜¯é¡µé¢è¯·æ±‚ã€‚500è½¬é”™è¯¯é¡µï¼Œæ˜¾ç¤º <code>ex.getMessage()</code>ï¼Œå¦‚æœæ˜¯debugç¯å¢ƒæˆ–è€…æ˜¯è¯·æ±‚å¸¦æœ‰debugå‚æ•°ï¼Œä¹ŸæŠŠé”™è¯¯å †æ ˆè¾“å‡ºåœ¨é¡µé¢ä¸Šã€‚</li>
<li>å¦‚æœæ˜¯ ajax è¯·æ±‚ã€‚è¿”å›è¡¨ç¤ºé”™è¯¯çš„ json æ¶ˆæ¯ï¼ŒåŒæ ·ï¼Œå¦‚æœæ˜¯debugç¯å¢ƒæˆ–è€…æ˜¯è¯·æ±‚å¸¦æœ‰debugå‚æ•°ï¼Œæ¶ˆæ¯ä¸­å¸¦ä¸Šå †æ ˆä¿¡æ¯ã€‚</li>
</ol>
</li>
</ol>
<p>ä»¥ä¸Šï¼Œå°±æ˜¯ä¸€ä¸ªç®€å•è€Œæœ‰æ•ˆçš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ä»¥ä¸Šæ˜¯æˆ‘çš„ä¸ªäººå®è·µç»éªŒæ€»ç»“ï¼Œè¯·å„ä½æ‰¹è¯„æŒ‡æ­£ï¼Œæ¬¢è¿è®¨è®ºã€‚</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/03/29/java/spring & spring mvc åˆå§‹åŒ–ä»‹ç»/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/29/java/spring & spring mvc åˆå§‹åŒ–ä»‹ç»/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-03-29T14:58:54+08:00">
                2017-03-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2017-03-30T19:19:32+08:00â€<br>draft = false<br>title = â€œspring &amp; spring mvc åˆå§‹åŒ–ä»‹ç»â€<br>categories = [ â€œspringâ€,â€spring mvcâ€,â€configâ€,â€contextâ€ ]<br>type=â€javaâ€</p>
<p>+++</p>
<h1 id="spring-amp-spring-mvc-åˆå§‹åŒ–ä»‹ç»"><a href="#spring-amp-spring-mvc-åˆå§‹åŒ–ä»‹ç»" class="headerlink" title="spring &amp; spring mvc åˆå§‹åŒ–ä»‹ç»"></a>spring &amp; spring mvc åˆå§‹åŒ–ä»‹ç»</h1><h2 id="webé¡¹ç›®çš„ç»“æ„"><a href="#webé¡¹ç›®çš„ç»“æ„" class="headerlink" title="webé¡¹ç›®çš„ç»“æ„"></a>webé¡¹ç›®çš„ç»“æ„</h2><h3 id="java-servlet-æŠ€æœ¯"><a href="#java-servlet-æŠ€æœ¯" class="headerlink" title="java servlet æŠ€æœ¯"></a>java servlet æŠ€æœ¯</h3><p>java servlet æŠ€æœ¯æ˜¯ java çš„ä¸€ä¸ª web æœåŠ¡è§„èŒƒ, æä¾›äº†ç»Ÿä¸€çš„ servlet api ä¾›å„ä¸ªå®¹å™¨å‚å•†å®ç°, ä»¥ä¿è¯ä¸€ä¸ª java web é¡¹ç›®å¯ä»¥è¿è¡Œåœ¨ä¸åŒå‚å•†çš„æœåŠ¡å™¨ä¸‹.</p>
<p>è¯·çœ‹å®ä¾‹ç®€å•å¤ä¹ ä¸‹ servlet, listner, filter</p>
<p>listner, filter ä¼šåœ¨ web å®¹å™¨å¯åŠ¨æ—¶æ‰§è¡Œ init æ–¹æ³• </p>
<p>servlet ä¼šåœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶è¿›è¡Œåˆå§‹åŒ–. å½“ç„¶ä¹Ÿå¯ä»¥è®¾ç½® init on start</p>
<h3 id="é-servlet-è§„èŒƒçš„-java-web-é¡¹ç›®"><a href="#é-servlet-è§„èŒƒçš„-java-web-é¡¹ç›®" class="headerlink" title="é servlet è§„èŒƒçš„ java web é¡¹ç›®"></a>é servlet è§„èŒƒçš„ java web é¡¹ç›®</h3><p>ä½¿ç”¨nettyä½œä¸ºæœåŠ¡å™¨lib, åŠ å…¥ http åè®®çš„å¤„ç†å±‚,  è‡ªè¡Œå®Œæˆå¤„ç† http è¯·æ±‚è¯»å†™</p>
<h3 id="spring-mvc-çš„çš„å°è£…"><a href="#spring-mvc-çš„çš„å°è£…" class="headerlink" title="spring mvc çš„çš„å°è£…"></a>spring mvc çš„çš„å°è£…</h3><p>æˆ‘ä»¬æœ€å¸¸ç”¨åˆ°çš„ spring mvc æ¡†æ¶å°±æ˜¯å¯¹ servlet æŠ€æœ¯çš„å°è£…, åœ¨ web.xml ä¸­åŠ å…¥å®ç° <code>Listenner</code> çš„ <code>SpringContextListener</code> å’Œå®ç°äº† <code>Servlet</code> çš„ <code>DispatcherServlet</code>, æ¥å¯¹spring å’Œ spring mvc è¿›è¡Œåˆå§‹åŒ–. </p>
<h2 id="spring-context-ç»“æ„"><a href="#spring-context-ç»“æ„" class="headerlink" title="spring context ç»“æ„"></a>spring context ç»“æ„</h2><p>spring context æ˜¯æ•´ä¸ª spring çš„æ ¸å¿ƒ, é€šå¸¸ä¹Ÿè¢«å«åš spring å®¹å™¨. é€šå¸¸è®²çš„ spring åˆå§‹åŒ–è¿‡ç¨‹, å°±æ˜¯åˆå§‹åŒ– spring context çš„è¿‡ç¨‹.</p>
<p>æ ¹æ®åº”ç”¨ä¸åŒ, ä½¿ç”¨çš„ spring  context ç±»å‹ä¹Ÿä¸åŒ</p>
<h3 id="ç»§æ‰¿æ ‘"><a href="#ç»§æ‰¿æ ‘" class="headerlink" title="ç»§æ‰¿æ ‘"></a>ç»§æ‰¿æ ‘</h3><p><img src="http://img.yangxiaochen.com/image/blog/contextç»§æ‰¿.png" alt="contextç»§æ‰¿.png"></p>
<p>å¸¸è§çš„ war åŒ…å½¢å¼çš„ web åº”ç”¨, ä½¿ç”¨çš„æ˜¯ <code>XmlWebApplicationContext</code></p>
<p>spring boot é»˜è®¤ä½¿ç”¨çš„æ˜¯ <code>AnnotationConfigEmbeddedWebApplicationContext</code></p>
<h3 id="é‡è¦ç»„ä»¶"><a href="#é‡è¦ç»„ä»¶" class="headerlink" title="é‡è¦ç»„ä»¶"></a>é‡è¦ç»„ä»¶</h3><ul>
<li><code>BeanFactory</code> é€šç”¨ç»„ä»¶, è´Ÿè´£ bean æ³¨å†Œå’Œåˆå§‹åŒ–</li>
<li><code>Environment</code> é€šç”¨ç»„ä»¶ , åŒ…å«ç³»ç»Ÿå‚æ•°, å¯åŠ¨å‚æ•°ç­‰. è¿˜æœ‰å¯¹å¯åŠ¨å‚æ•°è§£æåçš„å±æ€§, æ¯”å¦‚ profile</li>
<li><code>ApplicationListener</code>s é€šç”¨ç»„ä»¶, ä¿å­˜æ³¨å†Œè¿›æ¥çš„contextäº‹ä»¶listener</li>
<li>ä¸€äº› context çŠ¶æ€æ ‡å¿—, parent</li>
<li><code>ServletContext</code>, <code>ServletConfig</code> WebApplicationContextç±»é‡Œç‰¹æœ‰çš„</li>
</ul>
<ul>
<li>ä¸€äº›ç‰¹å®šçš„å‚æ•°. åœ¨ç‰¹å®šcontextç±»å‹ä¸­, æ¯”å¦‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/** Default config location for the root context */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONFIG_LOCATION = <span class="string">"/WEB-INF/applicationContext.xml"</span>;</div><div class="line"></div><div class="line"><span class="comment">/** Default prefix for building a config location for a namespace */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONFIG_LOCATION_PREFIX = <span class="string">"/WEB-INF/"</span>;</div><div class="line"></div><div class="line"><span class="comment">/** Default suffix for building a config location for a namespace */</span></div><div class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String DEFAULT_CONFIG_LOCATION_SUFFIX = <span class="string">".xml"</span>;</div></pre></td></tr></table></figure>
<h2 id="spring-context-åˆå§‹åŒ–è¿‡ç¨‹æ¦‚å¿µæ¦‚è§ˆ"><a href="#spring-context-åˆå§‹åŒ–è¿‡ç¨‹æ¦‚å¿µæ¦‚è§ˆ" class="headerlink" title="spring context åˆå§‹åŒ–è¿‡ç¨‹æ¦‚å¿µæ¦‚è§ˆ"></a>spring context åˆå§‹åŒ–è¿‡ç¨‹æ¦‚å¿µæ¦‚è§ˆ</h2><p>ä¸€ä¸ª spring context çš„åˆå§‹åŒ–è¿‡ç¨‹å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µ:</p>
<ol>
<li><p>è¯»å–å¹¶è®¾ç½®ç³»ç»Ÿå‚æ•°, ç¯å¢ƒå˜é‡, è·å–ä¸€äº›åˆå§‹åŒ– context éœ€è¦çš„ç»„ä»¶, æ¯”å¦‚ ApplicationContextInitializer ç­‰.</p>
<p>è¿™ä¸ªå±äºcontext åˆå§‹åŒ–çš„å‰ç½®é€»è¾‘, ç”±åº”ç”¨è‡ªå·±æ§åˆ¶, æˆ‘ä»¬ä¹Ÿå¯è‡ªå·±æ¥å†™, ç”¨æ¥ç»™åé¢ context åˆå§‹åŒ–åšå‡†å¤‡</p>
<p>è¿™ä¸€æ­¥æ ¹æ®åº”ç”¨ä¸åŒå·®åˆ«å¾ˆå¤§, æ¯”å¦‚ä¼ ç»Ÿ war åŒ…çš„ ContextLoadListner å’Œ spring boot çš„ SpringApplication ä¸­çš„é€»è¾‘å°±å¾ˆä¸åŒ.</p>
</li>
<li><p>create context</p>
<p>æ ¹æ®åº”ç”¨ä¸é€š, åˆ›å»ºä¸åŒçš„ context</p>
</li>
<li><p>configure context</p>
<p>ç”¨ç¬¬1æ­¥è·å¾—çš„å‚æ•°å’Œç»„ä»¶, æ¥é…ç½®åˆ›å»ºå¥½çš„ context</p>
</li>
<li><p>context.refresh</p>
<p>æ ¸å¿ƒæ­¥éª¤, context åˆå§‹åŒ–çš„å…·ä½“è¿‡ç¨‹å°±åœ¨è¿™é‡Œ. </p>
<p>åŒ…æ‹¬åˆ†é—¨åˆ«ç±»çš„åŠ è½½å„ç§ç‰¹æ®Šçš„ bean, ç„¶ååŠ è½½æ™®é€šçš„ben </p>
</li>
</ol>
<h2 id="spring-åˆå§‹åŒ–è¿‡ç¨‹å®ä¾‹æ¦‚è§ˆ-é-spring-boot-çš„ä¼ ç»ŸwaråŒ…"><a href="#spring-åˆå§‹åŒ–è¿‡ç¨‹å®ä¾‹æ¦‚è§ˆ-é-spring-boot-çš„ä¼ ç»ŸwaråŒ…" class="headerlink" title="spring åˆå§‹åŒ–è¿‡ç¨‹å®ä¾‹æ¦‚è§ˆ(é spring boot çš„ä¼ ç»ŸwaråŒ…)"></a>spring åˆå§‹åŒ–è¿‡ç¨‹å®ä¾‹æ¦‚è§ˆ(é spring boot çš„ä¼ ç»ŸwaråŒ…)</h2><h3 id="ContextLoaderListener"><a href="#ContextLoaderListener" class="headerlink" title="ContextLoaderListener"></a>ContextLoaderListener</h3><p><code>ContextLoaderListener</code> é…ç½®åœ¨ web.xml ä¸­, åœ¨å®¹å™¨å¯åŠ¨æ—¶åˆå§‹åŒ–.</p>
<p><img src="http://img.yangxiaochen.com/image/blog/ContextLoaderListener.png" alt="ContextLoaderListener.png"></p>
<p>éƒ¨åˆ†è¾ƒä¸ºé‡è¦æ­¥éª¤è§£é‡Š:</p>
<ul>
<li><p>3) å†³å®šspring web app contextç±»å‹. ä¸æŒ‡å®šçš„æƒ…å†µä¸‹é»˜è®¤ç­–ç•¥åˆ›å»º <code>XmlWebApplicationContext</code></p>
</li>
<li><p>16) ä»¥ bean çš„ configuration æ–‡ä»¶, å°±æ˜¯ä¸€èˆ¬æˆ‘ä»¬è¯´çš„xmlæ–‡ä»¶ ä¸ºå…¥å£, åŠ è½½ <code>BeanDefinition</code> åˆ° bean factory. æ³¨æ„ä»…ä»…æ˜¯åŠ è½½ bean çš„æè¿°, è€Œæ²¡æœ‰å®ä¾‹åŒ–è¿™äº› bean</p>
</li>
<li><p>17) å®ä¾‹åŒ–æ‰§è¡Œæ‰€æœ‰çš„ <code>BeanFactoryPostProcessor</code>, ä» <code>BeanDefinition</code> ä¸­å’Œ context çš„ <code>beanFactoryPostProcessors</code> å­—æ®µä¸­æŸ¥æ‰¾.</p>
</li>
<li><p><code>BeanFactoryPostProcessor</code>æ˜¯æ„å›¾åœ¨ bean factory åŠ è½½äº†æ‰€æœ‰å®šä¹‰çš„ bean å®šä¹‰ä¹‹å, ä¸”åœ¨è¿™äº› bean å®ä¾‹åŒ–ä¹‹å‰, åšä¸€äº›æ“ä½œ.</p>
<p>è¿™ä¸€æ­¥é€šå¸¸åœ¨è°ƒç”¨å„ä¸ª processor æ—¶, äº§ç”Ÿæ–°çš„ bean å®šä¹‰åˆ° bean factory</p>
</li>
<li><p>18) æ³¨å†Œ <code>BeanPostProcessor</code> , ä» <code>BeanDefinition</code> ä¸­æŸ¥æ‰¾.</p>
</li>
<li><p><code>BeanPostProcessor</code> ä¼šåœ¨ä¹‹åæ¯ä¸ª bean å®ä¾‹åŒ–ä¹‹åè°ƒç”¨, ç”¨æ¥å¯¹ bean åšä¸€äº›å…¶ä»–æ“ä½œ, æ¯”å¦‚æ”¾å…¥ä¸€äº›å‚æ•°: </p>
<p>åƒ <code>AutowiredAnnotationBeanPostProcessor</code> çš„ä½œç”¨å°±æ˜¯æ³¨å…¥ <code>@Autowired</code> å­—æ®µ.</p>
<p>ç”ŸæˆåŠ¨æ€ä»£ç†å¯¹è±¡ä¹Ÿæ˜¯é€šè¿‡  <code>BeanPostProcessor</code> å®ç°çš„.</p>
</li>
<li><p>21) <code>onRefresh</code> æ˜¯ç”¨æ¥åˆå§‹åŒ–å…¶ä»–çš„ç‰¹æ®Šçš„ bean, è¿™éƒ¨åˆ†é€»è¾‘é€šå¸¸åœ¨ç‰¹æ®Šçš„ context å­ç±»å®ç°</p>
<p>æ¯”å¦‚åœ¨ spring boot ä¸­ä½¿ç”¨çš„ <code>AnnotationConfigEmbeddedWebApplicationContext</code> ä¸­, ä¼šåœ¨è¿™é‡Œåˆå§‹åŒ–å¹¶å¯åŠ¨å†…åµŒæœåŠ¡å™¨ </p>
</li>
<li><p>22) å°†åœ¨  <code>BeanDefinition</code> ä¸­çš„, è¿˜æœ‰ä¹‹å‰è®¾ç½®åˆ°contextå±æ€§ä¸­çš„  <code>ApplicationListener</code> åŠ åˆ°å¹¿æ’­åˆ—è¡¨ä¸­</p>
</li>
<li><p>23) å°†  <code>BeanDefinition</code>  ä¸­å…¶ä»–çš„éæ‡’åŠ è½½çš„ bean å®ä¾‹åŒ–.</p>
</li>
<li><p>24) å®ä¾‹åŒ–å¹¶è°ƒç”¨ <code>LifecycleProcessor</code> , ç„¶åå¹¿æ’­ <code>ContextRefreshedEvent</code></p>
</li>
<li><p>26) å°† context æ”¾åˆ° <code>ServletContext</code> çš„ attribute å±æ€§é‡Œ, ä¹‹å <code>DispatcherServlet</code> åˆå§‹åŒ–ä¼šç”¨åˆ°</p>
</li>
</ul>
<blockquote>
<p>*ä»¥ä¸Šè¯´çš„ bean å‡ä¸º singleton çš„ scope</p>
</blockquote>
<h3 id="DispatcherServlet"><a href="#DispatcherServlet" class="headerlink" title="DispatcherServlet"></a>DispatcherServlet</h3><p><code>DispatcherServlet</code> é…ç½®åœ¨ web.xml ä¸­, åœ¨ç¬¬ä¸€æ¬¡è®¿é—®æ—¶åˆå§‹åŒ–.</p>
<p><img src="http://img.yangxiaochen.com/image/blog/DispatcherServlet.png" alt="DispatcherServlet.png"></p>
<p>éƒ¨åˆ†è¾ƒä¸ºé‡è¦æ­¥éª¤è§£é‡Š:</p>
<ul>
<li>5) ä»¥ <code>ContextLoaderListener</code>åˆ›å»ºçš„ context ä¸º parent, åˆ›å»ºæ–°çš„ <code>XmlWebApplicationContext</code></li>
<li>8) åˆ›å»ºä¸€ä¸ª <code>ContextRefreshListener</code> , åŠ å…¥åˆ° context ä¸­, ç›‘å¬ <code>ContextRefreshedEvent</code></li>
<li>9) refresh è¿‡ç¨‹è·Ÿ<code>ContextLoaderListener</code> ä¸€æ ·, ä¸åŒçš„æ˜¯åœ¨æŸ¥æ‰¾ bean æ—¶, èƒ½å¤ŸæŸ¥åˆ° parent context çš„ bean, ä¾›æ–°çš„ context åˆå§‹åŒ–ä½¿ç”¨.</li>
<li>10) è§¦å‘  <code>ContextRefreshedEvent</code> , åˆå§‹åŒ– spring mvc çš„ç»„ä»¶, æ·»åŠ åˆ° <code>DispatcherServlet</code> ä¸­.</li>
</ul>
<h2 id="ä¸€äº›ç‰¹æ®Šç±»å‹Beançš„åˆå§‹åŒ–æ—¶æœº-å¾…å®Œå–„-è¯·æŒç»­è¡¥å……"><a href="#ä¸€äº›ç‰¹æ®Šç±»å‹Beançš„åˆå§‹åŒ–æ—¶æœº-å¾…å®Œå–„-è¯·æŒç»­è¡¥å……" class="headerlink" title="ä¸€äº›ç‰¹æ®Šç±»å‹Beançš„åˆå§‹åŒ–æ—¶æœº (å¾…å®Œå–„, è¯·æŒç»­è¡¥å……)"></a>ä¸€äº›ç‰¹æ®Šç±»å‹Beançš„åˆå§‹åŒ–æ—¶æœº (å¾…å®Œå–„, è¯·æŒç»­è¡¥å……)</h2><h3 id="BeanFactoryPostProccesor"><a href="#BeanFactoryPostProccesor" class="headerlink" title="BeanFactoryPostProccesor"></a>BeanFactoryPostProccesor</h3><p>context refresh ä¹‹å, åˆå§‹åŒ–å¥½ factory ä¹‹å, ä¼šå…ˆæ‰§è¡Œ context è‡ªèº«çš„ factory post æ“ä½œ, ç„¶åå°±ä¼šæ‰§è¡Œ  <code>BeanFactoryPostProccesor</code>  è¿™ç§ç±»å‹ bean æ‰€å®šä¹‰çš„ factory post æ“ä½œ.</p>
<h3 id="BeanDefinitionRegistryPostProcessor"><a href="#BeanDefinitionRegistryPostProcessor" class="headerlink" title="BeanDefinitionRegistryPostProcessor"></a>BeanDefinitionRegistryPostProcessor</h3><p><code>BeanFactoryPostProccesor</code> çš„å­ç±», æ‰§è¡Œä¼˜å…ˆçº§æ¯” <code>BeanFactoryPostProccesor</code> è¦é«˜. é€šå¸¸å¯ä»¥é€šè¿‡ order æ¥æ§åˆ¶<code>BeanDefinitionRegistryPostProcessor</code> ç±»å‹çš„æ‰§è¡Œé¡ºåº, è¿˜è·Ÿè¿™ä¸ª bean å®šä¹‰çš„æ—¶æœºæœ‰å…³, åœ¨ prepare context é˜¶æ®µå®šä¹‰çš„æ€»ä¼šæœ€å…ˆæ‰§è¡Œ.</p>
<p>é€šå¸¸è‡ªå®šä¹‰çš„ xml å’Œ bean é…ç½® ä¼šåœ¨è¿™ä¸ªé˜¶æ®µè¢«å®šä¹‰åˆ° factory.  </p>
<h3 id="BeanPostProccesor"><a href="#BeanPostProccesor" class="headerlink" title="BeanPostProccesor"></a>BeanPostProccesor</h3><p>åœ¨ <code>BeanFactoryPostProccesor</code> éƒ½æ‰§è¡Œå®Œä¹‹åå®ä¾‹åŒ–, å¹¶ apply åˆ° factory ,  åœ¨ä¸€ä¸ª bean åˆå§‹åŒ–ä¹‹åä¼šè¢«è°ƒç”¨.</p>
<h3 id="Aware"><a href="#Aware" class="headerlink" title="Aware"></a>Aware</h3><p>å¦‚ <code>ApplicationContextAware</code> , å®ç°è¿™ä¸ªæ¥å£çš„ bean ä¼šç”±ä¸€ä¸ª <code>BeanPostProccesor</code> ç±»å‹çš„  <code>ApplicationContextAwareProcessor</code> åœ¨åˆå§‹åŒ–ä¹‹å set ä¸€ä¸ª application context</p>
<p>Aware ç›¸å…³ç±»çš„å¾ˆå¤š, éƒ½ç±»ä¼¼</p>
<h3 id="ApplicationListener"><a href="#ApplicationListener" class="headerlink" title="ApplicationListener"></a>ApplicationListener</h3><p>ç”¨æ¥ç›‘å¬ context ç”Ÿå‘½å‘¨æœŸä¸­å„ä¸ªäº‹ä»¶çš„ç±», å¯ä»¥åœ¨ prepare å’Œ refresh é˜¶æ®µæ³¨å…¥</p>
<h3 id="ApplicationContextInitializer"><a href="#ApplicationContextInitializer" class="headerlink" title="ApplicationContextInitializer"></a>ApplicationContextInitializer</h3><p>prepare context é˜¶æ®µæ‰§è¡Œ, åœ¨ context refreshä¹‹å‰æ‰§è¡Œ. å¯ä»¥å¯¹ context æ³¨å…¥ <code>BeanFactoryPostProccesor</code> å’Œ <code>ApplicationListener</code></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2017/03/15/java/gradle-with-idea/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/03/15/java/gradle-with-idea/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2017-03-15T11:29:56+08:00">
                2017-03-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2017-03-28T16:19:32+08:00â€<br>draft = false<br>title = â€œè®ºGradleä¸IDEAçš„ä½¿ç”¨â€<br>categories = [ â€œjavaâ€, â€œgradleâ€ ]<br>type=â€javaâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="è®ºGradleä¸IDEAçš„ä½¿ç”¨"><a href="#è®ºGradleä¸IDEAçš„ä½¿ç”¨" class="headerlink" title="è®ºGradleä¸IDEAçš„ä½¿ç”¨"></a>è®ºGradleä¸IDEAçš„ä½¿ç”¨</h1><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>gradle æ˜¯ä¸€ä¸ªç›¸å¯¹æ¯”è¾ƒæ–°çš„æ„å»ºå·¥å…·, ç›¸å¯¹ä½¿ç”¨äººç¾¤è¾ƒå°‘, ç•¥æœ‰å…¥é—¨é—¨æ§›, ä½†æ˜¯ç”¨äº†ä¹‹åæ¯”è¾ƒå¥½ç”¨çš„å·¥å…·.</p>
<p>å½“ç„¶ä½¿ç”¨ä¸­æœ‰ä¸€äº›å‘, è€Œä¸”è·Ÿ IDEA é…åˆä½¿ç”¨ä¸­ä¹Ÿä¼šé‡åˆ°å¾ˆå¤šé—®é¢˜. æœ¬æ–‡å°±æ˜¯æŠŠæˆ‘ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°çš„é—®é¢˜åšä¸€ä¸‹æ€»ç»“, å¤§å®¶å¯¹ç—‡ä¸‹è¯.</p>
<p>æŒç»­æ›´æ–°ä¸­â€¦</p>
<h2 id="å¸¸è§„ä½¿ç”¨"><a href="#å¸¸è§„ä½¿ç”¨" class="headerlink" title="å¸¸è§„ä½¿ç”¨"></a>å¸¸è§„ä½¿ç”¨</h2><h3 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®" class="headerlink" title="åˆ›å»ºé¡¹ç›®"></a>åˆ›å»ºé¡¹ç›®</h3><p>åˆ›å»º gradle çš„é¡¹ç›®éå¸¸ç®€å•,  ã€Œnewã€-&gt; ã€Œprojectã€-&gt; é€‰æ‹© Gradle é¡¹ç›®</p>
<h3 id="å¼•å…¥å·²æœ‰é¡¹ç›®"><a href="#å¼•å…¥å·²æœ‰é¡¹ç›®" class="headerlink" title="å¼•å…¥å·²æœ‰é¡¹ç›®"></a>å¼•å…¥å·²æœ‰é¡¹ç›®</h3><p>å¦‚æœå·²æœ‰ gradle é¡¹ç›®, å³æ–‡ä»¶ä¸­æœ‰ build.gradle æ„å»ºæ–‡ä»¶. ã€Œopenã€build.gradle æ–‡ä»¶å³å¯.</p>
<h3 id="åœ¨égradleé¡¹ç›®ä¸­åŠ å…¥gradle"><a href="#åœ¨égradleé¡¹ç›®ä¸­åŠ å…¥gradle" class="headerlink" title="åœ¨égradleé¡¹ç›®ä¸­åŠ å…¥gradle"></a>åœ¨égradleé¡¹ç›®ä¸­åŠ å…¥gradle</h3><p>ä¸€ä¸ªé¡¹ç›®å·²ç»æ‰“å¼€, IDEA é‡Œå´æ²¡æœ‰ gradle æ ‡ç­¾æ .</p>
<p>ã€ŒConfigura project structureã€-&gt; ã€ŒModulesã€-&gt; add -&gt; ã€ŒImport Modulesã€, å°† build.gradle æ–‡ä»¶å¼•å…¥.</p>
<h3 id="ä¿®æ”¹gradleæ–‡ä»¶å-æ›´æ–°é¡¹ç›®-è¿™é‡Œæ˜¯é‡ç‚¹å“¦"><a href="#ä¿®æ”¹gradleæ–‡ä»¶å-æ›´æ–°é¡¹ç›®-è¿™é‡Œæ˜¯é‡ç‚¹å“¦" class="headerlink" title="ä¿®æ”¹gradleæ–‡ä»¶å, æ›´æ–°é¡¹ç›®. è¿™é‡Œæ˜¯é‡ç‚¹å“¦"></a>ä¿®æ”¹gradleæ–‡ä»¶å, æ›´æ–°é¡¹ç›®. è¿™é‡Œæ˜¯é‡ç‚¹å“¦</h3><p>å¦‚æœæ˜¯æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤å¯¼å…¥çš„é¡¹ç›®, é‚£ä¹ˆåœ¨æ›´æ–°å®Œ<code>build.gradle</code>æ–‡ä»¶å, éœ€è¦ç‚¹å‡» IDEA å³ä¾§ tab ä¸­ gradle çš„æ ‡ç­¾, ç„¶åç‚¹å‡»åˆ·æ–°. è¿™ä¸ªç›®çš„æ˜¯è®© IDEA è¯†åˆ«<code>build.gradle</code>ä¸­çš„é…ç½®, æ ¹æ®é…ç½®é‡æ–°ç»„ç»‡é¡¹ç›®ç»“æ„, åŒ…æ‹¬ module, libs ç­‰, ä»¥ä¾¿è®© IDEA é…åˆæˆ‘ä»¬å·¥ä½œ.   </p>
<p>è¿™æ—¶å€™, æœ‰æ—¶ä¼šå‡ºç°ç‚¹å‡»åˆ·æ–°å, è¿›åº¦æ¡è¿Ÿè¿Ÿèµ°ä¸å®Œ, ä¸€ç›´åœç•™åœ¨ build çŠ¶æ€. æ²¡æœ‰é”™è¯¯åŸå› , ä¹Ÿä¸åœæ­¢, è¿™æ˜¯ä»¤æˆ‘ä»¬æœ€æ²®ä¸§çš„, ä¸‹é¢å°±æ˜¯è¦è¯´ä¸€è¯´ buildé€Ÿåº¦æ…¢, æˆ–è€…æ— å“åº”çš„é—®é¢˜.</p>
<h2 id="å¸¸è§é—®é¢˜"><a href="#å¸¸è§é—®é¢˜" class="headerlink" title="å¸¸è§é—®é¢˜"></a>å¸¸è§é—®é¢˜</h2><h3 id="æ’ä»¶é€‰æ‹©"><a href="#æ’ä»¶é€‰æ‹©" class="headerlink" title="æ’ä»¶é€‰æ‹©"></a>æ’ä»¶é€‰æ‹©</h3><p>é…åˆ IDEA ä½¿ç”¨, è¯·ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;idea&apos;</div></pre></td></tr></table></figure>
<p>é€šè¿‡è¿™ä¸ªæ’ä»¶, </p>
<ol>
<li>æˆ‘ä»¬å¯ä»¥è®¾ç½®ä¸€äº›å‚æ•°, è®© IDEA åˆ·æ–°çš„æ—¶å€™è¯†åˆ«åˆ°, ä»è€Œèƒ½å¤Ÿåšä¸€äº›æˆ‘ä»¬çš„é…ç½®. </li>
<li>å¯ä»¥å‘½ä»¤è¡Œæ‰‹åŠ¨è¿è¡Œ <code>gradle idea</code> å‘½ä»¤, æ¥çœ‹çœ‹åˆ·æ–°è¿‡ç¨‹æ˜¯ä¸æ˜¯æœ‰é—®é¢˜.</li>
<li><code>gradle idea</code>å‘½ä»¤ä¼šç”Ÿæˆ<code>.iml</code>é¡¹ç›®æ–‡ä»¶, IDEA é€šè¿‡æ‰“å¼€è¿™ä¸ªæ–‡ä»¶ä¹Ÿèƒ½å¤Ÿæ­£ç¡®å¼•å…¥è¿™ä¸ªé¡¹ç›®. ä½†æˆ‘ä»¬å¾ˆå°‘è¿™ä¹ˆåš.</li>
</ol>
<p>é™¤äº†å†…ç½®æ’ä»¶å¤–, å¯ä»¥ <a href="https://plugins.gradle.org/" target="_blank" rel="external">Search Gradle plugins</a>.</p>
<h3 id="buildé€Ÿåº¦æ…¢"><a href="#buildé€Ÿåº¦æ…¢" class="headerlink" title="buildé€Ÿåº¦æ…¢"></a>buildé€Ÿåº¦æ…¢</h3><h4 id="æ›¿æ¢ä»“åº“"><a href="#æ›¿æ¢ä»“åº“" class="headerlink" title="æ›¿æ¢ä»“åº“"></a>æ›¿æ¢ä»“åº“</h4><p>é¦–å…ˆæ¥è¯´å¯ä»¥æ›¿æ¢<code>repositories</code>, ä½¿ç”¨é˜¿é‡Œäº‘çš„ä»“åº“</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">repositories &#123;</div><div class="line">  maven &#123;</div><div class="line">  	url &quot;http://maven.aliyun.com/nexus/content/groups/public&quot;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>å†è€…, æœ‰çš„åŒå­¦ä½¿ç”¨ç§æœ, å¯èƒ½æ˜¯å…¬å¸æ­å»ºçš„. è¿™ä¸ªæœ‰æ—¶å€™ä¼šæœ‰ä¸ç¨³å®š, ä¸”æœ‰æ—¶éœ€è¦è®¤è¯çš„æƒ…å†µ. çœ‹ç¨åçš„ç« èŠ‚.</p>
<h4 id="å¦‚ä½•debug"><a href="#å¦‚ä½•debug" class="headerlink" title="å¦‚ä½•debug"></a>å¦‚ä½•debug</h4><p>gradle è¿è¡Œä¸­çš„æç¤ºå¹¶ä¸ç®—å¾ˆå‹å¥½, å°¤å…¶åœ¨é“¾æ¥ä»“åº“å’Œä¸‹è½½jaråŒ…æ—¶, åœ¨è¿æ¥æœ‰é—®é¢˜çš„æ—¶å€™, ç»å¸¸æ²¡æœ‰æç¤º(æ–°ç‰ˆæœ¬çš„å¯èƒ½å¥½ä¸€äº›.)</p>
<p>ç»å¸¸ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">gradle idea -i</div><div class="line">gradle idea -id</div><div class="line"></div><div class="line">è¿˜å¯ä»¥åŠ å…¥ --no-daemon å‚æ•°æ¥é¿å…daemonå¯åŠ¨äº§ç”Ÿçš„æ—¥å¿—å¹²æ‰°</div><div class="line">gradle idea -id --no-daemon</div><div class="line">ä¸€èˆ¬æ¥è¯´å°±èƒ½å®šä½åˆ°æ„å»ºé—®é¢˜.</div></pre></td></tr></table></figure>
<p>æ¥è·å–æ›´å¤šçš„ä¿¡æ¯. æ¯”è¾ƒå¸¸è§çš„å¡ä½æ˜¯å› ä¸º<code>ä»“åº“é“¾æ¥ä¸ä¸Š</code>, <code>jaråŒ…ä¸‹è½½é“¾æ¥ä¸ä¸Š, åˆä¸è¿”å› response (ç§æœ‰ä»“åº“å¶å°”æœ‰é—®é¢˜)</code>, <code>èµ„æºä¸‹è½½ç¼“æ…¢</code>, <code>ä»“åº“éœ€è¦è®¤è¯ç™»é™†</code></p>
<ul>
<li>ä»“åº“è¿æ¥ä¸ä¸Š: æ£€æŸ¥ä»“åº“åœ°å€, æ£€æŸ¥ç½‘ç»œ.</li>
<li>èµ„æºæ— æ³•è¿æ¥åˆæ²¡æœ‰response: è¿™ç§é€šå¸¸ä¼šåœ¨ä¸Šé¢æ‰“å‡ºçš„æ—¥å¿—ä¸­ä½“ç°, è¯·æ±‚ä¸€ä¸ª url ä¾¿æ²¡æœ‰å“åº”.</li>
<li>ä¸‹è½½ç¼“æ…¢: æ›´æ¢ä»“åº“, æˆ–è€…å¿è€ä¸‹ç¬¬ä¸€æ¬¡, ä»¥åä¼šå¥½å¾ˆå¤š</li>
</ul>
<p>åœ¨ IDEA åˆ·æ–°æœ‰é—®é¢˜æ—¶, å¯ä»¥æ‰§è¡Œè¿™ä¸ªå‘½ä»¤debug, ä¸€èˆ¬è¿™ä¸ªå‘½ä»¤èƒ½æˆåŠŸ, é‚£ä¹ˆ IDEA åˆ·æ–°é€šå¸¸ä¹Ÿèƒ½æˆåŠŸ. (è¯·æ³¨æ„ç‰ˆæœ¬é—®é¢˜, å‘½ä»¤è¡Œé‡Œæ‰§è¡Œçš„ gradle ç‰ˆæœ¬éœ€è¦è·Ÿ IDEA é‡Œé…ç½®çš„ gradle ç‰ˆæœ¬ä¸€è‡´)</p>
<h4 id="ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜"><a href="#ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜" class="headerlink" title="ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜"></a>ç§æœä½¿ç”¨å’ŒåŒ…ç®¡ç†æ··ä¹±å¼•èµ·çš„é—®é¢˜</h4><p>ç§æœä½¿ç”¨ä¸­ä¼šæœ‰ä»¥ä¸‹é—®é¢˜: </p>
<ol>
<li><p>ä¸ç¨³å®š, å¶å°”æœåŠ¡æ— å“åº”.</p>
</li>
<li><p>é…ç½®å‡ºé”™, æ— æ³• proxy maven ä¸»ä»“åº“. æˆ–è€…å‡ºç°ç§æœä¸­å­˜åœ¨ç¬¬ä¸‰æ–¹åŒ…ä½†æ˜¯å´ä¸å®Œæ•´åˆ°æ—¶æ— æ³•ä¸‹è½½.</p>
<p>ä¸€èˆ¬æ¥è¯´ä¼šå°è¯•æŠŠç¬¬ä¸‰æ–¹ä»“åº“é…ç½®åˆ°ç§æœä¹‹å‰:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">maven &#123;</div><div class="line">  url &quot;http://maven.aliyun.com/nexus/content/groups/public&quot;</div><div class="line">&#125;</div><div class="line"></div><div class="line">maven &#123;</div><div class="line">  url &quot;http://ä½ å®¶ç§æœåœ°å€/&quot;</div><div class="line">  credentials &#123;</div><div class="line">    username &quot;xxx&quot;</div><div class="line">    password &quot;xxx&quot;</div><div class="line">  &#125;</div><div class="line">  authentication &#123;</div><div class="line">  	basic(BasicAuthentication)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·å…ˆå»ç¬¬ä¸‰æ–¹æŸ¥æ‰¾, å†åˆ°ç§æœæŸ¥æ‰¾.</p>
</li>
<li><p>ç§æœæœ‰è®¤è¯. å¯ä»¥å‚ç…§ç¬¬äºŒæ¡ç§æœçš„è®¤è¯æ–¹å¼. å…¶ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">authentication &#123;</div><div class="line">	basic(BasicAuthentication)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æ˜¯å¯é€‰å¡«çš„, ä¸å¡«çš„è¯ä¼šè‡ªåŠ¨è¯†åˆ«è®¤è¯æ–¹å¼.</p>
</li>
<li><p>æ‰“åŒ…æ–¹å¼ä¸å®Œæ•´. æœ‰çš„åŒå­¦ä¸Šä¼ åŒ…çš„æ—¶å€™è™½ç„¶åŒ…å«äº†ç¼–è¯‘åçš„jaråŒ…, pomæ–‡ä»¶, ä½†æ˜¯æœ‰æ—¶å´æ²¡æœ‰æŠŠsourceåŒ…ä¸Šä¼ , gradle é»˜è®¤æ˜¯ä¼šä¸‹è½½sourceçš„, å¦‚æœæ²¡æœ‰, ç§æœè¿”å›404è¿˜å¥½, æœ€æ€•ä¼šå¡ä¸»(é‡åˆ°è¿‡ç§æœè™½ç„¶æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶å´è¿Ÿè¿Ÿä¸è¿”å›responseçš„æƒ…å†µ.), æ‰€ä»¥, å¦‚æœé‡åˆ°è¿™ç§é—®é¢˜, å¯ä»¥: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">idea &#123;</div><div class="line">	module &#123;</div><div class="line">		downloadJavadoc = false</div><div class="line">		downloadSources = false</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>ä¸è®© IDEA åˆ·æ–°çš„æ—¶å€™ä¸‹è½½æºç å’Œæ–‡æ¡£, ä¸‡ä¸å¾—å·²è¿˜æ˜¯ä¸è¦ç”¨.</p>
</li>
</ol>
<h3 id="å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°"><a href="#å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°" class="headerlink" title="å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°"></a>å¸¸ç”¨å‘½ä»¤æˆ–å‚æ•°</h3><p><code>--refresh-dependencies</code>   åˆ·æ–°ä¾èµ–</p>
<p><code>gradle tasks</code> åˆ—å‡ºæ‰€æœ‰å¯æ‰§è¡Œçš„task</p>
<p><code>gradle tasks --all</code> åˆ—å‡ºæ‰€æœ‰å¯æ‰§è¡Œçš„task, å¹¶é™„åŠ ä¸Š mudole</p>
<p><code>gradle help --task taskName</code>  æŸ¥çœ‹ä¸€ä¸ªtaskçš„å¸®åŠ©, ä¸è¿‡å¹¶ä¸æ˜¯æ‰€æœ‰taskéƒ½æœ‰, å› ä¸ºtaskéƒ½æ˜¯å¯ä»¥è‡ªå·±æ¥å®ç°çš„.</p>
<p><code>gradle idea -id</code> ç”¨æ¥debug IDEAè¿›è¡Œåˆ·æ–°æ—¶é‡åˆ°çš„é—®é¢˜, ä¸€èˆ¬è¿™ä¸ªä»»åŠ¡èƒ½æˆåŠŸ, åˆ·æ–°å°±èƒ½æˆåŠŸ. æ³¨æ„ä½¿ç”¨çš„ gradle ç‰ˆæœ¬è¦ä¸€è‡´.</p>
<p><code>--no-daemon</code> ä¸æ˜¯ä½¿ç”¨daemonè¿›è¡Œæ„å»º. daemonçš„ä½œç”¨æ˜¯ä¸ç”¨æ¯æ¬¡ build éƒ½å†å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹, èŠ‚çœæ—¶é—´. ä½†å´ä¼šåœ¨æˆ‘ä»¬ debug é—®é¢˜çš„æ—¶å€™ä¸åœçš„ç”Ÿäº§æ—¥å¿—, äº§ç”Ÿå¹²æ‰°.</p>
<h3 id="ä¾èµ–å†²çªå¤„ç†"><a href="#ä¾èµ–å†²çªå¤„ç†" class="headerlink" title="ä¾èµ–å†²çªå¤„ç†"></a>ä¾èµ–å†²çªå¤„ç†</h3><p>å¯ä»¥é€šè¿‡å‘½ä»¤æ¥æŸ¥çœ‹ä¸€ä¸ªé¡¹ç›®çš„ä¾èµ–</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gradle webapp:dependencies --configuration=compile</div></pre></td></tr></table></figure>
<p>gradle ä¾èµ–ä½¿ç”¨çš„æ˜¯ æœ€è¿‘ åŸåˆ™. æ¯”å¦‚ä½ æ„å»ºå¤„äºä¾èµ–é¡¶å±‚çš„ module , é‚£ä¹ˆç‰ˆæœ¬ä¼šä¼˜å…ˆä½¿ç”¨è¿™ä¸ªé¡¶å±‚module çš„<code>build.grale</code> ä¸­å®šä¹‰çš„ç‰ˆæœ¬. æ‰€ä»¥å¯ä»¥åœ¨é¡¶å±‚module ä¸­å¼ºåˆ¶å®šä¹‰ç‰ˆæœ¬</p>
<p>ä¾èµ–æ’é™¤, é€šå¸¸å¯ä»¥ä½¿ç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">compile(&quot;org.springframework.boot:spring-boot-starter-web&quot;) &#123;</div><div class="line">    exclude module: &quot;spring-boot-starter-logging&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>è¿™æ ·çš„è¯­æ³•, è¿˜æœ‰æ›´ä¸ºç²—æš´ç›´æ¥çš„: </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">configurations &#123;</div><div class="line">    all*.exclude group: &apos;ch.qos.logback&apos;, module: &apos;logback-classic&apos;</div><div class="line">    all*.exclude group: &apos;ch.qos.logback&apos;, module: &apos;logback-core&apos;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="é‡åˆ°è¿‡çš„bug"><a href="#é‡åˆ°è¿‡çš„bug" class="headerlink" title="é‡åˆ°è¿‡çš„bug"></a>é‡åˆ°è¿‡çš„bug</h3><h4 id="compileä¾èµ–è¢«ideaè®¾ç½®ä¸ºprovide"><a href="#compileä¾èµ–è¢«ideaè®¾ç½®ä¸ºprovide" class="headerlink" title="compileä¾èµ–è¢«ideaè®¾ç½®ä¸ºprovide"></a>compileä¾èµ–è¢«ideaè®¾ç½®ä¸ºprovide</h4><p>IDEA 2017 ä»¥å‰ç‰ˆæœ¬åœ¨ä½¿ç”¨ gradle 3.4+ ç‰ˆæœ¬æ—¶, åˆ·æ–°å compile çš„ä¾èµ–ä¼šè¢«è§£é‡Šä¸º provideä¾èµ–. åœ¨ä½¿ç”¨ IDEA è¿è¡Œç¨‹åºçš„æ—¶å€™ä¼šæŠ¥ ClassNotFound ä¹‹ç±»çš„é”™è¯¯.</p>
<h3 id="æœ€ä½³å®è·µæ€»ç»“"><a href="#æœ€ä½³å®è·µæ€»ç»“" class="headerlink" title="æœ€ä½³å®è·µæ€»ç»“"></a>æœ€ä½³å®è·µæ€»ç»“</h3><ol>
<li>å°½é‡ç”¨æœ€æ–°ç‰ˆæœ¬çš„ IDEA å’Œ Gradle, æˆªæ­¢åˆ°ç›®å‰, æ˜¯ IDEA 2017.1 å’Œ gradle 3.4.1</li>
<li>é‡åˆ°é—®é¢˜ç”¨ <code>gradle idea -id</code> æ¥debug</li>
<li>å°½é‡æ’é™¤ deamo æ—¥å¿—çš„å¹²æ‰°</li>
<li>é€šè¿‡å‘½ä»¤è¡Œä½¿ç”¨<code>gradle</code>, é€Ÿåº¦å¿«, å¯ä»¥æ£€æµ‹é—®é¢˜.</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2016/09/29/java/å¼‚å¸¸è§„èŒƒ/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/09/29/java/å¼‚å¸¸è§„èŒƒ/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-09-29T11:44:59+08:00">
                2016-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2016-09-29T17:19:32+08:00â€<br>draft = false<br>title = â€œJavaå¼‚å¸¸è§„èŒƒâ€<br>categories = [ â€œjavaâ€ ]<br>type=â€javaâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="å¼‚å¸¸è§„èŒƒ"><a href="#å¼‚å¸¸è§„èŒƒ" class="headerlink" title="å¼‚å¸¸è§„èŒƒ"></a>å¼‚å¸¸è§„èŒƒ</h1><h2 id="å¼‚å¸¸ä»‹ç»"><a href="#å¼‚å¸¸ä»‹ç»" class="headerlink" title="å¼‚å¸¸ä»‹ç»"></a>å¼‚å¸¸ä»‹ç»</h2><h4 id="Throwable"><a href="#Throwable" class="headerlink" title="Throwable"></a>Throwable</h4><p>æ‰€æœ‰Exceptionå’ŒErrorçš„çˆ¶ç±».</p>
<h4 id="Error"><a href="#Error" class="headerlink" title="Error"></a>Error</h4><p>è‡´å‘½é”™è¯¯. é¡¹ç›®è‡ªèº«å­˜åœ¨é—®é¢˜, è¯¸å¦‚æ ¼å¼æœ‰é—®é¢˜, ç¼–è¯‘ç‰ˆæœ¬ä¸å¯¹, å †æ ˆæº¢å‡ºç­‰, é¡¹ç›®åœ¨å‡ºç°ERRORçš„æƒ…å†µä¸‹æ˜¯ä¸åº”è¯¥è¿è¡Œçš„. åŒæ—¶, ç¨‹åºé‡åˆ°Erroræ—¶, ç¨‹åºä¸éœ€è¦, é€šå¸¸ä¹Ÿæ˜¯æ²¡æœ‰èƒ½åŠ›åšå¤„ç†çš„, åªèƒ½å¤Ÿåœæ­¢ç¨‹åºé’ˆå¯¹é¡¹ç›®æˆ–è€…è¿è¡Œç¯å¢ƒåšäººå·¥å¤„ç†æ‰è¡Œ.</p>
<h4 id="Exception"><a href="#Exception" class="headerlink" title="Exception"></a>Exception</h4><p>åŒºåˆ«äºError, æ˜¯ç¨‹åºå¯ä»¥è‡ªå·±å¤„ç†çš„å¼‚å¸¸. Exceptionçš„å­ç±»ä¸­, ç‰¹æ®Šçš„RuntimeExceptionè¢«ç§°ä¸º<strong>è¿è¡Œæ—¶å¼‚å¸¸</strong>, ä¹Ÿå«<strong>éå—æ£€å¼‚å¸¸</strong>; å…¶ä»–çš„å­ç±»åŒ…æ‹¬Exceptionç±»æœ¬èº«éƒ½å«<strong>å—æ£€å¼‚å¸¸</strong></p>
<h5 id="å—æ£€å¼‚å¸¸"><a href="#å—æ£€å¼‚å¸¸" class="headerlink" title="å—æ£€å¼‚å¸¸"></a>å—æ£€å¼‚å¸¸</h5><p>Javaç¼–è¯‘å™¨ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œè¦ä¹ˆç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œè¦ä¹ˆç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œå¦åˆ™ç¼–è¯‘ä¸ä¼šé€šè¿‡ã€‚</p>
<h5 id="éå—æ£€å¼‚å¸¸-è¿è¡Œæ—¶å¼‚å¸¸"><a href="#éå—æ£€å¼‚å¸¸-è¿è¡Œæ—¶å¼‚å¸¸" class="headerlink" title="éå—æ£€å¼‚å¸¸(è¿è¡Œæ—¶å¼‚å¸¸)"></a>éå—æ£€å¼‚å¸¸(è¿è¡Œæ—¶å¼‚å¸¸)</h5><p>ä¸éœ€è¦å¼ºåˆ¶catchæˆ–è€…throwçš„å¼‚å¸¸.</p>
<h2 id="ç¨‹åºä¸­å¦‚ä½•ä½¿ç”¨å¼‚å¸¸"><a href="#ç¨‹åºä¸­å¦‚ä½•ä½¿ç”¨å¼‚å¸¸" class="headerlink" title="ç¨‹åºä¸­å¦‚ä½•ä½¿ç”¨å¼‚å¸¸"></a>ç¨‹åºä¸­å¦‚ä½•ä½¿ç”¨å¼‚å¸¸</h2><p>ç¨‹åºä¸­æˆ‘ä»¬ä¸»è¦å…³æ³¨<strong>å—æ£€å¼‚å¸¸</strong>å’Œ<strong>è¿è¡Œæ—¶å¼‚å¸¸</strong>çš„ä½¿ç”¨</p>
<p><strong>ä¸€äº›åŸåˆ™, è¿™äº›åŸåˆ™å¹¶ä¸ç‹¬ç«‹, äº’ç›¸ä¹‹é—´æœ‰ç…§åº”æˆ–è€…è¡¥å……:</strong></p>
<ol>
<li><p>å‘ç”Ÿå¯æ¢å¤é”™è¯¯çš„æŠ›å‡ºå—æ£€å¼‚å¸¸ï¼Œç¨‹åºé”™è¯¯å°±æŠ›å‡ºè¿è¡Œæ—¶å¼‚å¸¸</p>
</li>
<li><p>å°½é‡ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸. ä»ä¿éšœä»£ç ç®€æ´, æ¸…æ™°, æœ‰æ„ä¹‰çš„è§’åº¦ä¸Šæ¥è¯´.</p>
<p>æ³¨æ„ç»å¯¹ä¸æ˜¯æ— è„‘æŠŠå—æ£€å¼‚å¸¸æ¢ä¸ºè¿è¡Œæ—¶å¼‚å¸¸. </p>
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬è¦å»¶è¿Ÿå¤„ç†å¼‚å¸¸: æ¯”å¦‚æˆ‘ä»¬çš„ä¸€ä¸ªå—æ£€å¼‚å¸¸åœ¨å±‚æ¬¡å¾ˆæ·±çš„åœ°æ–¹æŠ›å‡º, ä½†æ˜¯æˆ‘ä»¬åœ¨ä»£ç å±‚æ¬¡å¾ˆé«˜çš„åœ°æ–¹æ‰èƒ½åšå¤„ç†, é‚£ä¹ˆå—æ£€å¼‚å¸¸ä¼šå‡ºç°åœ¨ä»£ç è°ƒç”¨çš„æ¯ä¸€å±‚. è¿™éå¸¸ç¹ç, ä¹Ÿä¸æ¸…æ™°.</p>
</li>
<li><p>è°¨æ…æŠ›å‡ºå—æ£€å¼‚å¸¸.</p>
<p>å—æ£€å¼‚å¸¸æ˜¯ä¸å—æ¬¢è¿çš„.</p>
<p>é™¤éä½ è®¤ä¸ºä½ æ˜¯åœ¨å¼ºè°ƒè¿™ä¸ªå¼‚å¸¸, è°ƒç”¨è€…åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹éœ€è¦é‡ç‚¹å…³æ³¨è¿™ä¸ªå¼‚å¸¸å¹¶catchè¿™ä¸ªå¼‚å¸¸å¹¶åšå¤„ç†. </p>
<p>ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸å¸¦æ¥çš„ç®€æ´å¹¶ä¸èƒ½å¤Ÿå¼¥è¡¥å¼€å‘äººå‘˜å¿½ç•¥äº†è¿™ä¸ªå¼‚å¸¸å¸¦æ¥çš„é—®é¢˜æ—¶.</p>
</li>
<li><p>ä½œä¸ºå®šä½æ˜¯ç±»åº“çš„æ¨¡å—, å°½é‡ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸, å¹¶å¯¹javaä½å±‚å¼‚å¸¸å°è£…, æŠ›å‡ºç±»åº“ç‰¹æœ‰çš„æ¦‚æ‹¬æ€§çš„å¼‚å¸¸. </p>
<p>å½“ç«™åœ¨è°ƒç”¨è€…çš„è§’åº¦, å¯ä»¥è·æ‚‰è¿™ä¸ªç±»åº“æœ‰å“ªå‡ ç§å¼‚å¸¸, å‡ºç°æ—¶ä»£è¡¨ä»€ä¹ˆäº†.  </p>
<p>ç§»ä½ç±»åº“çš„è°ƒç”¨å¾ˆå¤šæ—¶å€™è·Ÿä¸šåŠ¡æ²¡æœ‰å…³ç³», å½“å‡ºç°é”™è¯¯æ—¶, é€šå¸¸æ˜¯å› ä¸ºæˆ‘ä»¬çš„ä»£ç æ¼æ´é€ æˆçš„, è¿™å¹¶ä¸èƒ½ç®€å•é€šè¿‡try_catchè¿›è¡Œæ¢å¤, æ‰€ä»¥å°½é‡ä¸ä½¿ç”¨å—æ£€å¼‚å¸¸.</p>
</li>
<li><p>ä½œä¸ºå®šä½æ˜¯æœåŠ¡çš„æ¨¡å—, å¯ä»¥ä½¿ç”¨ä¸€äº›å—æ£€å¼‚å¸¸.</p>
<p>å› ä¸ºå½“è°ƒç”¨æœåŠ¡å‡ºç°é”™è¯¯, ä¸€èˆ¬æ˜¯ä¸€ä¸ªå¯ä»¥è§£é‡Šçš„ä¸šåŠ¡é”™è¯¯, å¦‚æœæ˜¯æƒ³è¦è°ƒç”¨è€…éå¸¸æ³¨æ„çš„é”™è¯¯, å¯ä»¥ä½¿ç”¨å—æ£€å¼‚å¸¸.</p>
<p>æœåŠ¡çš„è°ƒç”¨ä¸€èˆ¬ä»£ç å±‚æ¬¡æ¯”è¾ƒæµ…, å¹¶ä¸”æ˜¯å’Œä¸šåŠ¡æ¯”è¾ƒç›¸å…³çš„.</p>
</li>
<li><p>ä¸šåŠ¡å¼‚å¸¸éœ€è¦å•ç‹¬å°è£…æˆæ–°çš„å¼‚å¸¸æ¥è¡¨è¾¾ä¸€ç±»æˆ–è€…ä¸€ä¸ªæ¨¡å—çš„ä¸šåŠ¡é”™è¯¯, å¯ä»¥ä½¿ç”¨å—æ£€å¼‚å¸¸. ä½†ä¹Ÿå‚ç…§1, 2, 3</p>
<p>å¯ä»¥æŠŠä¸€äº›éä¸šåŠ¡å¼‚å¸¸å°è£…æˆä¸ºä¸šåŠ¡å¼‚å¸¸, å¦‚æœä½ çŸ¥é“åœ¨è¿™ä¸ªåœ°æ–¹è¿™ç§éä¸šåŠ¡å¼‚å¸¸åœ¨ä¸šåŠ¡ä¸Šå¯ä»¥è¡¨è¾¾ä¸€äº›å«ä¹‰.</p>
<p>æ¯”å¦‚æŸä¸ªä½ç½®æŠ›å‡ºäº†jsonè§£æå¼‚å¸¸, æˆ‘ä»¬å¯ä»¥è¯´ä¼ å…¥çš„æŸä¸ªæ•°æ®æ ¼å¼æ˜¯é”™è¯¯çš„.</p>
<p>ä¸ºäº†ç»™å¤§å®¶å»ºç«‹å¼‚å¸¸ä½“ç³»ç»“æ„, ä¸šåŠ¡å¼‚å¸¸å®šä¹‰ä¸ºå—æ£€å¼‚å¸¸, å¼ºåˆ¶è®©å¤§å®¶å…³æ³¨ä¸‹.</p>
</li>
<li><p>éä¸šåŠ¡å¼‚å¸¸, ä»£ç åº•å±‚å¼‚å¸¸, å¦‚æœå‡ºç°çš„è¯å¯ä»¥å®šä¹‰ä¸ºä»£ç bugçš„, ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸</p>
<p>å³ä½¿æ²¡æœ‰catchä½çš„åæœæ˜¯åœ¨ç³»ç»Ÿè¿è¡Œæ—¶æŠ›ç»™äº†ç”¨æˆ·, ä¹Ÿä¸åº”è¯¥catch. å½“ç„¶åœ¨é¡¹ç›®ä¸­éœ€è¦ä¸€ä¸ªæœ€é«˜å±‚æ¬¡çš„å¼‚å¸¸å¤„ç†, å¯¹éä¸šåŠ¡å¼‚å¸¸ç»Ÿä¸€catchè®°å½•æŠ¥è­¦è€Œä¸è¦æš´éœ²ç»™ç”¨æˆ·</p>
</li>
<li><p>ä¸šåŠ¡å¼‚å¸¸å¦‚æœå¯ä»¥, ä¸è¦è·¨å±‚(è·¨æ¨¡å—)</p>
<p>æ¯”å¦‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">controller -&gt; service -&gt; adaptor -&gt; UC dubbo</div></pre></td></tr></table></figure>
<p>UC dubbo æŠ›å‡ºçš„å¼‚å¸¸, åº”è¯¥åœ¨adaptoræˆ–è€…serviceåšå¤„ç†å°è£…æ–°çš„å¼‚å¸¸, ä¸è¦è®©controllerç›´é¢UC dubboçš„å¼‚å¸¸.</p>
</li>
<li><p>å¼‚å¸¸åº”è¯¥æºå¸¦æ›´å¤šä¿¡æ¯. </p>
<p>å°¤å…¶å¯¹ä¸šåŠ¡å¼‚å¸¸æ¥è¯´, çŸ¥é“å¼‚å¸¸å‘ç”Ÿæ—¶çš„ä¸šåŠ¡æ•°æ®æ˜¯å¾ˆé‡è¦çš„, æ–¹ä¾¿æŸ¥æ‰¾å®šä½é—®é¢˜.</p>
</li>
<li><p>åœ¨apiå±‚(controllerå±‚), å°†ä¸€äº›ä¸šåŠ¡å¼‚å¸¸å°è£…ä¸ºAPIå¼‚å¸¸, è¿™ç±»å¼‚å¸¸å°†ç›´æ¥ç»™ç”¨æˆ·apiå¼‚å¸¸çš„æç¤º, ä¸”æœ‰æ—¶å¯ä»¥è®¤ä¸ºè¿™äº›å¼‚å¸¸æ˜¯æ­£å¸¸çš„, ä¸éœ€è¦æŠ¥è­¦çš„.</p>
</li>
<li><p>æœ‰æ•ˆçš„ä¸šåŠ¡å¼‚å¸¸ç±»åˆ’åˆ†å’Œå¼‚å¸¸codeå®šä¹‰, æœ‰åŠ©äºç»Ÿä¸€å¤„ç†å¼‚å¸¸æ—¶åŒºåˆ«å¼‚å¸¸çš„ç­‰çº§åˆé€‚å¦éœ€è¦æŠ¥è­¦.</p>
<p>åœ¨è®¾è®¡å¼‚å¸¸æ—¶è¯·è€ƒè™‘è¿™ä¸€ç‚¹.</p>
</li>
<li><p>å¦‚æœä¸çŸ¥é“è‡ªå·±çš„å¼‚å¸¸åº”è¯¥æ˜¯ä½¿ç”¨å—æ£€å¼‚å¸¸è¿˜æ˜¯è¿è¡Œæ—¶å¼‚å¸¸, ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸.</p>
<p>å…ˆæŠ¥å‡ºé”™è¯¯, ä¸åšå¯¹æœªçŸ¥çš„è®¾è®¡ </p>
</li>
</ol>
<h2 id="å¦‚ä½•å¤„ç†å¼‚å¸¸"><a href="#å¦‚ä½•å¤„ç†å¼‚å¸¸" class="headerlink" title="å¦‚ä½•å¤„ç†å¼‚å¸¸"></a>å¦‚ä½•å¤„ç†å¼‚å¸¸</h2><ol>
<li>ç»å¯¹ç¦æ­¢catchåä»€ä¹ˆéƒ½ä¸åš!</li>
<li>åœ¨catchä¹‹åå°è£…æˆæ–°å¼‚å¸¸æŠ›å‡ºçš„æ—¶å€™, ä¸è¦è®°å½•æ—¥å¿—. å› ä¸ºä½ æŠ›å‡ºäº†, ä¼šæœ‰ä¸Šå±‚æ¥å¤„ç†è®°å½•æ—¥å¿—, åªè¦æ²¡æœ‰1è¿™ç§æƒ…å†µ, æ€»ä¼šæœ‰ä¿¡æ¯çš„. è¿™é‡Œå†è®°å½•æ—¥å¿—å°±é‡å¤äº†.</li>
<li>åœ¨éœ€è¦æ—¶ä¸€å®šè¦ä½¿ç”¨ä¸Šfinally</li>
<li>å¤„ç†å¼‚å¸¸æ—¶è®°å½•çš„æ—¥å¿—ä¸€èˆ¬è¦æŠŠå¼‚å¸¸çš„å †æ ˆç»™è®°å½•ä¸‹æ¥.</li>
</ol>
<h2 id="å…·ä½“å®æ–½æ–¹æ¡ˆ"><a href="#å…·ä½“å®æ–½æ–¹æ¡ˆ" class="headerlink" title="å…·ä½“å®æ–½æ–¹æ¡ˆ"></a>å…·ä½“å®æ–½æ–¹æ¡ˆ</h2><ol>
<li><p>æ‰€æœ‰ç±»åº“</p>
<ul>
<li><a href="http://git.lianjia.com/fnrd/fn-commons" target="_blank" rel="external">fn-commons</a></li>
<li><a href="http://git.lianjia.com/fnrd/common-search" target="_blank" rel="external">common-search</a></li>
<li><a href="http://git.lianjia.com/fnrd/api-common" target="_blank" rel="external">api-common</a></li>
</ul>
<p>æ¯ä¸ªé¡¹ç›®, masteræ‰“tag, åˆ‡æ–°ç‰ˆæœ¬åˆ†æ”¯, å‡çº§å¤§ç‰ˆæœ¬, ä¾‹å¦‚1.0 -&gt; 2.0</p>
<p>ç›®æ ‡: åŸºæœ¬éƒ½æ˜¯ç”¨è¿è¡Œæ—¶å¼‚å¸¸,å‡è½»è°ƒç”¨è´Ÿæ‹…, çœ‹æƒ…å†µå†³å®šæ˜¯å¦è‡ªå®šä¹‰å¼‚å¸¸. ç±»åº“å°½é‡å°‘è®°log, å°¤å…¶ä¸èƒ½è®°infoçš„log. è¿™ä¸ªå‡ºlogè§„èŒƒçš„æ—¶å€™å†è¯´ </p>
</li>
<li><p>é‡ç‚¹é¡¹ç›®<a href="http://git.lianjia.com/fnrd/fnrd-gte" target="_blank" rel="external">fnrd-gte</a></p>
<p>åˆ‡ä¸ªexception-refactoråˆ†æ”¯</p>
<ol>
<li><p>æ›´æ–°ç±»åº“ä¾èµ–. æ›´æ”¹ç”±ä¾èµ–æ›´æ–°å¼•èµ·çš„ä»£ç é”™è¯¯.</p>
</li>
<li><p>é›†ä¸­åœ¨serviceåŒ…:</p>
<ul>
<li><p>adaptor</p>
<p>æ–°å»ºä¸€ä¸ªRPCException, ç»§æ‰¿RuntimeException, æ›¿æ¢ç°æœ‰çš„ç›´æ¥ç”¨RuntimeExceptionæŠ›å‡º.</p>
<p>RPCExceptionå¯ä»¥å¸¦ä¸€äº›è¯·æ±‚å‚æ•°ä¿¡æ¯.</p>
</li>
<li><p>apiåŒ…</p>
<p>å¼ºçƒˆå»ºè®®ä½¿ç”¨<a href="http://git.lianjia.com/fnrd/api-common" target="_blank" rel="external">api-common</a>, ä¸è¿‡æ¶‰åŠè¾ƒå¤š, å¯ä»¥é€æ­¥æ”¹æ”¹</p>
</li>
<li><p>implåŒ…, æ ¸å¿ƒæµç¨‹é€»è¾‘</p>
<p>é‡ç‚¹å¤„ç†çš„ä½ç½®, æŒ¨ä¸ªæ–‡ä»¶çœ‹, ç„¶åä»ä½å‘ä¸Šé‡æ„</p>
<p>å®šä¹‰FlowExceptionä½œä¸ºä¸»è¦æµç¨‹ä¸šåŠ¡å¼‚å¸¸, ç»Ÿä¸€å¤„ç†æ—¶å°†ä¼šä½¿ç”¨å…¶ä¸­msgé€šçŸ¥ç”¨æˆ·, <strong>éFlowExceptionå°†ä¼šç»Ÿä¸€å°è£…å‹å¥½æç¤º</strong>.</p>
<p>å¯ä»¥å®šä¹‰æ›´åŠ ç»†è‡´çš„å¼‚å¸¸ç»§æ‰¿FlowExceptionå¼‚å¸¸, ä»¥åº”å¯¹æ›´ç»†è‡´çš„éœ€è¦.</p>
</li>
<li><p>event, listner</p>
</li>
<li><p>äº¤æ˜“, é‡‘èä¸šåŠ¡ç›¸å…³çš„å¢åˆ æ”¹æŸ¥serviceç­‰.</p>
<p>å¯ä»¥æ–°å®šä¹‰FnServiceExcetion, TeServiceException, ä¹Ÿä½œä¸ºä¸€ç±»ä¸šåŠ¡å¼‚å¸¸.</p>
</li>
</ul>
</li>
<li><p>controller</p>
<p>é€‰æ‹©æ€§çš„å¯¹ä¸€äº›å¼‚å¸¸å°è£…, WebApiException, msgç›´æ¥ç»™ç”¨æˆ·æ˜¾ç¤º.</p>
</li>
</ol>
</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2016/06/22/git/git-in-use/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/22/git/git-in-use/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-06-22T17:07:32+08:00">
                2016-06-22
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2016-07-04T21:52:32+08:00â€<br>draft = false<br>title = â€œgitå®é™…å¼€å‘è¯­å¥â€<br>categories = [ â€œgitâ€ ]<br>type=â€gitâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="gitå®é™…ä½¿ç”¨æŒ‡å—"><a href="#gitå®é™…ä½¿ç”¨æŒ‡å—" class="headerlink" title="gitå®é™…ä½¿ç”¨æŒ‡å—"></a>gitå®é™…ä½¿ç”¨æŒ‡å—</h1><h2 id="frameworkä¸Šå·¥ä½œgitæŒ‡å—"><a href="#frameworkä¸Šå·¥ä½œgitæŒ‡å—" class="headerlink" title="frameworkä¸Šå·¥ä½œgitæŒ‡å—"></a>frameworkä¸Šå·¥ä½œgitæŒ‡å—</h2><ol>
<li><p>åˆ‡åˆ°<code>framework</code>åˆ†æ”¯</p>
<pre><code>git checkout framework
</code></pre></li>
<li><p>å¼€åˆ†æ”¯</p>
<pre><code>git checkout -b bug/JRTE-333-é—®é¢˜æè¿°
</code></pre><p> æˆ–è€…</p>
<pre><code>git checkout -b feature/JRTE-333-éœ€æ±‚æè¿°
</code></pre></li>
<li><p>å¼€å‘</p>
<pre><code>.....
</code></pre></li>
<li><p>æäº¤åˆ†æ”¯</p>
<pre><code>git push origin [ä½ çš„åˆ†æ”¯åå­—]
</code></pre></li>
<li><p>å‘èµ·<code>merge request</code></p>
<pre><code>ç™»é™†git.lianjia.comå‘èµ·
</code></pre></li>
<li><p>å¦‚æœä¸€åˆ‡æ­£å¸¸, å°±ç»“æŸäº†. å¦‚æœå‘ç°<code>merge request</code>æœ‰å†²çª, ä¸èƒ½åˆå¹¶, è½¬ <code>7</code></p>
</li>
<li><p><code>merge request</code>æœ‰å†²çª</p>
<ol>
<li><p>åˆ‡æ¢åˆ°<code>framework</code>, æ›´æ–°ä¹‹.</p>
<pre><code>git co framework
git pull
</code></pre></li>
<li><p>åˆ‡å›ä½ çš„åˆ†æ”¯.</p>
<pre><code>git co [ä½ çš„åˆ†æ”¯åå­—]
</code></pre></li>
<li><p>rebase! éš¾ä»¥ç†è§£è€Œåˆå¤æ‚çš„ä¸€æ­¥. ä½†åšè¿‡ä¸€æ¬¡ä½ å°±ä¼šäº†! </p>
<p> è¿›è¡Œrebase</p>
<pre><code>git rebase framework
</code></pre><p> <code>git rebase framework</code> çš„æ„æ€æ˜¯å°†<code>ä½ çš„åˆ†æ”¯</code>ä¸Šçš„æ¯ä¸€æ¬¡æäº¤, åº”ç”¨åˆ°<code>framework</code>åˆ†æ”¯çš„å°¾éƒ¨.</p>
</li>
<li><p>å¦‚æœæç¤ºæœ‰å†²çª, è½¬<code>7.5</code>. å¦‚æœæ²¡æœ‰å†²çª:</p>
<p> å› ä¸ºä½ pushè¿‡ä½ çš„åˆ†æ”¯, æ‰€ä»¥<code>è¿œç¨‹ä½ çš„åˆ†æ”¯</code>å’Œ<code>æœ¬åœ°ä½ çš„åˆ†æ”¯</code>å·²ç»ä¸ä¸€è‡´äº†. æ‰€ä»¥å¼ºè¡Œè¦†ç›–<code>ä½ çš„è¿œç¨‹åˆ†æ”¯</code></p>
<pre><code>git push -f origin [ä½ çš„åˆ†æ”¯åå­—]
</code></pre><p> ç„¶åä½ å°±å‘ç°ä½ çš„<code>merge request</code>æ˜¾ç¤ºå¯ä»¥è‡ªåŠ¨åˆå¹¶äº†. </p>
</li>
<li><p>è§£å†³å†²çª, ç„¶åæ ¹æ®æç¤ºæ‰§è¡Œ:</p>
<pre><code>git add [å†²çªæ–‡ä»¶]
git rebase --continue
</code></pre><p> å¦‚æœè¿˜æœ‰å†²çª, è½¬<code>7.5</code>, å¦‚æœæ²¡æœ‰, è½¬<code>7.4</code>.</p>
</li>
</ol>
</li>
</ol>
<h2 id="å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µ-å¾ˆæœ‰å¯èƒ½ä½ å°±é”™äº†"><a href="#å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µ-å¾ˆæœ‰å¯èƒ½ä½ å°±é”™äº†" class="headerlink" title="å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µ, å¾ˆæœ‰å¯èƒ½ä½ å°±é”™äº†"></a>å¦‚æœå‡ºç°ä»¥ä¸‹æƒ…å†µ, å¾ˆæœ‰å¯èƒ½ä½ å°±é”™äº†</h2><ul>
<li><p>æŠŠ<code>framework</code>ä¸Šçš„ä»£ç mergeåˆ°åˆ†æ”¯:</p>
<pre><code>git merge framework
</code></pre></li>
<li><p>åœ¨<code>framework</code>ä¸Šmergeåˆ†æ”¯ä»£ç </p>
</li>
<li><p>åœ¨frameworkä¸Šæ‰§è¡Œ<code>git pull</code>å‘ç°ä¸æ˜¯<code>fast forward</code></p>
</li>
<li><p>åœ¨ä»»ä½•åˆ†æ”¯ä¸Šæ‰§è¡Œ<code>git pull</code>å‘ç°ä¸æ˜¯<code>fast forward</code></p>
</li>
</ul>
<h2 id="åˆå¹¶ä¸ºä¸€æ¬¡æäº¤"><a href="#åˆå¹¶ä¸ºä¸€æ¬¡æäº¤" class="headerlink" title="åˆå¹¶ä¸ºä¸€æ¬¡æäº¤"></a>åˆå¹¶ä¸ºä¸€æ¬¡æäº¤</h2><h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><pre><code>git reset [åˆ†æ”¯å¼€å§‹version]
git add .
git commit
</code></pre><h3 id="æ–¹æ³•äºŒ-ä¿è¯æ²¡æœ‰å†²çª-ä¸”åˆå¹¶ä¸ºä¸€æ¬¡æäº¤"><a href="#æ–¹æ³•äºŒ-ä¿è¯æ²¡æœ‰å†²çª-ä¸”åˆå¹¶ä¸ºä¸€æ¬¡æäº¤" class="headerlink" title="æ–¹æ³•äºŒ, ä¿è¯æ²¡æœ‰å†²çª, ä¸”åˆå¹¶ä¸ºä¸€æ¬¡æäº¤!"></a>æ–¹æ³•äºŒ, ä¿è¯æ²¡æœ‰å†²çª, ä¸”åˆå¹¶ä¸ºä¸€æ¬¡æäº¤!</h3><p>åœ¨<code>4. æäº¤åˆ†æ”¯</code> æ—¶, å…ˆæ›´æ–°<code>frameworkåˆ†æ”¯</code>, ç„¶ååœ¨<code>ä½ çš„åˆ†æ”¯</code>æ‰§è¡Œ</p>
<pre><code>git rebase framework -i
</code></pre><p> æŠŠé™¤äº†ç¬¬ä¸€ä¸ª<code>pick</code>å…¨æ”¹æˆ<code>s</code>æˆ–è€…<code>squash</code>. æç¤ºå¾ˆå…¨, è¯•è¯•å§.</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2016/06/21/git/git-in-action/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/21/git/git-in-action/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-06-21T11:35:26+08:00">
                2016-06-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2016-06-21T14:52:32+08:00â€<br>draft = false<br>title = â€œgitåˆ†æ”¯ç®¡ç†ä¸ä½¿ç”¨è§„èŒƒâ€<br>categories = [ â€œgitâ€ ]<br>type=â€gitâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="gitåˆ†æ”¯ç®¡ç†ä¸ä½¿ç”¨è§„èŒƒ"><a href="#gitåˆ†æ”¯ç®¡ç†ä¸ä½¿ç”¨è§„èŒƒ" class="headerlink" title="gitåˆ†æ”¯ç®¡ç†ä¸ä½¿ç”¨è§„èŒƒ"></a>gitåˆ†æ”¯ç®¡ç†ä¸ä½¿ç”¨è§„èŒƒ</h1><h2 id="åˆ†æ”¯ç®¡ç†"><a href="#åˆ†æ”¯ç®¡ç†" class="headerlink" title="åˆ†æ”¯ç®¡ç†"></a>åˆ†æ”¯ç®¡ç†</h2><h3 id="flow"><a href="#flow" class="headerlink" title="flow"></a>flow</h3><ul>
<li>git flow</li>
<li>github flow</li>
<li>gitlab flow</li>
<li>fn flow</li>
</ul>
<h3 id="åˆ†æ”¯ä¸å¼€å‘å®šä¹‰"><a href="#åˆ†æ”¯ä¸å¼€å‘å®šä¹‰" class="headerlink" title="åˆ†æ”¯ä¸å¼€å‘å®šä¹‰"></a>åˆ†æ”¯ä¸å¼€å‘å®šä¹‰</h3><h4 id="ä¸»è¦åˆ†æ”¯"><a href="#ä¸»è¦åˆ†æ”¯" class="headerlink" title="ä¸»è¦åˆ†æ”¯"></a>ä¸»è¦åˆ†æ”¯</h4><ul>
<li><p>master</p>
<p>  çº¿ä¸Šåˆ†æ”¯, ä¸€ç›´å­˜åœ¨</p>
</li>
<li><p>develop</p>
<p>  å¸¸è§„å¼€å‘åˆ†æ”¯, ä¸€ç›´å­˜åœ¨</p>
</li>
<li><p>masterfix</p>
<p>  çº¿ä¸Šbugä¿®æ”¹åˆ†æ”¯, ä¸€ç›´å­˜åœ¨ </p>
</li>
</ul>
<h4 id="è¾…åŠ©åˆ†æ”¯"><a href="#è¾…åŠ©åˆ†æ”¯" class="headerlink" title="è¾…åŠ©åˆ†æ”¯"></a>è¾…åŠ©åˆ†æ”¯</h4><ul>
<li><p>feature/*</p>
<p>  åŠŸèƒ½å¼€å‘åˆ†æ”¯, ä»developåˆ†æ”¯è€Œæ¥, ç„¶ååˆå¹¶å…¥develop, æœ€ç»ˆåˆ é™¤.</p>
</li>
<li><p>release/*</p>
<p>  ä¸Šçº¿åˆ†æ”¯, ä»developåˆ†æ”¯è€Œæ¥, ç„¶ååˆå¹¶å…¥master, å¹¶åº”ç”¨åˆ°develop, æœ€ç»ˆåˆ é™¤.</p>
</li>
<li><p>hotfix/*</p>
<p>  çº¿ä¸Šbugä¿®æ”¹åˆ†æ”¯, ä»masterfixåˆ†æ”¯è€Œæ¥, ç„¶ååˆå¹¶å…¥masterfix, æœ€ç»ˆåˆ é™¤.</p>
</li>
</ul>
<h3 id="å¦‚ä½•ä½¿ç”¨å„ç§åˆ†æ”¯"><a href="#å¦‚ä½•ä½¿ç”¨å„ç§åˆ†æ”¯" class="headerlink" title="å¦‚ä½•ä½¿ç”¨å„ç§åˆ†æ”¯"></a>å¦‚ä½•ä½¿ç”¨å„ç§åˆ†æ”¯</h3><h4 id="init"><a href="#init" class="headerlink" title="init"></a>init</h4><p>ä¸€ä¸ªé¡¹ç›®åˆå§‹æœ‰masteråˆ†æ”¯, éœ€è¦æ–°å»ºç«‹ä¸€ä¸ªdevelopåˆ†æ”¯å’Œmasterfixåˆ†æ”¯.</p>
<pre><code>git br -b develop 
git push origin develop

git br -b masterfix
git push origin masterfix
</code></pre><h4 id="feature"><a href="#feature" class="headerlink" title="feature"></a>feature</h4><p>å¸¸è§„åŠŸèƒ½å¼€å‘éœ€è¦ä»developåˆ†æ”¯checkoutå‡ºfeatureåˆ†æ”¯.</p>
<pre><code>git checkout -b feature/GET-1008-æ·»åŠ ç”¨æˆ·æŸ¥è¯¢åˆ—è¡¨ [develop]
</code></pre><p>å¼€å‘å®Œæ¯•ååˆå¹¶å›developåˆ†æ”¯</p>
<pre><code>git checkout develop
git pull // å…ˆæ›´æ–°develop
git merge feature/GET-1008-æ·»åŠ ç”¨æˆ·æŸ¥è¯¢åˆ—è¡¨ --no-ff
git push origin develop

git branch -d feature/GET-1008-æ·»åŠ ç”¨æˆ·æŸ¥è¯¢åˆ—è¡¨
</code></pre><h4 id="Release"><a href="#Release" class="headerlink" title="Release"></a>Release</h4><p>å¼€å‘å®Œæ¯•, å‡†å¤‡å‘å¸ƒ:</p>
<pre><code>git checkout -b release/1.0.0 [develop]
</code></pre><p>ç„¶ååœ¨å‘å¸ƒåˆ†æ”¯ä¸Šå¤„ç†ä¸€äº›å‘å¸ƒæ“ä½œ, æ¯”å¦‚æ›´æ”¹ç‰ˆæœ¬å·, ä¸Šçº¿å‰æµ‹è¯•, é—®é¢˜ä¿®æ”¹ç­‰ç­‰. å½“åˆ†æ”¯å¯ä»¥è¿›è¡Œä¸Šçº¿å‘å¸ƒå:</p>
<pre><code>git checkout master
git merge release/1.0.0 --no-ff 
git tag -a 1.0.0
</code></pre><p>è‡³æ­¤releaseå®Œæˆ, ä½†æ˜¯éœ€è¦å°†åœ¨releaseåˆ†æ”¯ä¸Šçš„ä¿®æ”¹åº”ç”¨åˆ°developä¸Š.</p>
<pre><code>git checkout develop
git merge release/1.0.0 --no-ff

git branch -d release/1.0.0
</code></pre><p>ç„¶å, æˆ‘ä»¬å¯ä»¥æ¿€æ´»masterfixåˆ†æ”¯, åŒæ­¥ä¸€ä¸‹å·²ç»ä¸Šçº¿çš„masteråˆ†æ”¯, ä¸ºä¿®æ”¹å°†è¦å‡ºç°çš„çº¿ä¸Šbugåšå‡†å¤‡</p>
<pre><code>git checkout masterfix
git merge master // åœ¨æ­£å¸¸æƒ…å†µä¸‹, è¿™é‡Œä¸€å®šæ˜¯fast-faward
</code></pre><h2 id="hotfix"><a href="#hotfix" class="headerlink" title="hotfix"></a>hotfix</h2><p>å½“å‡ºç°bugæ—¶, æˆ‘ä»¬éœ€è¦ä»masteræˆ–è€…æ˜¯masterfixåˆ†æ”¯ä¸Šåˆ†å‡ºhotfixåˆ†æ”¯æ¥ä¿®æ”¹bug.</p>
<pre><code>git checkout -b hotfix/ä¿®æ”¹ç©ºæŒ‡é’ˆ masterfix
</code></pre><p>ä¿®æ”¹å®Œæ¯•å</p>
<pre><code>git checkout masterfix
git merge hotfix/ä¿®æ”¹ç©ºæŒ‡é’ˆ --no-ff
</code></pre><p>æœŸé—´å¯ä»¥è¿›è¡Œå¤šæ¬¡hotfix, æœ€åå½“masterfixæµ‹è¯•åæ²¡æœ‰é—®é¢˜, å‡†å¤‡ä¸Šçº¿:</p>
<pre><code>git checkout master
git merge masterfix --no-ff
</code></pre><p>åœ¨masterä¸Šæ‰“ä¸‹å½“å‰ä¸Šçº¿çš„tag</p>
<pre><code>git tag -a 1.0.1
</code></pre><p>åŒæ ·, è¿™äº›ä¿®æ”¹è¦åº”ç”¨åˆ°developåˆ†æ”¯ä¸Š</p>
<pre><code>git checkout develop
git merge masterfix --no-ff
</code></pre><h3 id="åˆ†æ”¯ä¸ç¯å¢ƒå¯¹åº”"><a href="#åˆ†æ”¯ä¸ç¯å¢ƒå¯¹åº”" class="headerlink" title="åˆ†æ”¯ä¸ç¯å¢ƒå¯¹åº”?"></a>åˆ†æ”¯ä¸ç¯å¢ƒå¯¹åº”?</h3><ul>
<li>master    â€“  online</li>
<li>release   â€“  off</li>
<li>develop   â€“  ci</li>
<li>masterfix â€“  online-bug-fix</li>
<li>feature   â€“  local, dev</li>
</ul>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><h2 id="ä½¿ç”¨è§„èŒƒ"><a href="#ä½¿ç”¨è§„èŒƒ" class="headerlink" title="ä½¿ç”¨è§„èŒƒ"></a>ä½¿ç”¨è§„èŒƒ</h2><h3 id="é¼“åŠ±å¼€åˆ†æ”¯"><a href="#é¼“åŠ±å¼€åˆ†æ”¯" class="headerlink" title="é¼“åŠ±å¼€åˆ†æ”¯"></a>é¼“åŠ±å¼€åˆ†æ”¯</h3><p>é¼“åŠ±æœ¬åœ°å¼€åˆ†æ”¯å¼€å‘, ç‹¬ç«‹åŠŸèƒ½ç‹¬ç«‹åˆ†æ”¯.</p>
<h3 id="å°†åˆ†æ”¯ä¸Šæäº¤åˆå¹¶"><a href="#å°†åˆ†æ”¯ä¸Šæäº¤åˆå¹¶" class="headerlink" title="å°†åˆ†æ”¯ä¸Šæäº¤åˆå¹¶"></a>å°†åˆ†æ”¯ä¸Šæäº¤åˆå¹¶</h3><p>åˆ†æ”¯ä¸Šå¼€å‘çš„commitå»ºè®®åˆå¹¶ä¸ºä¸€ä¸ªcommit, è¿™æ ·æ˜“è¯», æ–¹ä¾¿ä¸»åˆ†æ”¯ç®¡ç†.</p>
<p>ä¸€ç§æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•</p>
<pre><code>git reset [åˆ†æ”¯å¼€å§‹å¤„]
git commit -m &quot;...&quot;
</code></pre><p>å¦ä¸€ç§æ–¹æ³•, åœ¨featureåˆ†æ”¯ä¸Šæ‰§è¡Œ</p>
<pre><code>git rebase -i develop // å°†featureåˆ†æ”¯çš„ä¿®æ”¹åº”ç”¨åˆ°developä¸Š

// åç»­æ“ä½œ
http://www.ruanyifeng.com/blog/2015/08/git-use-process.html
</code></pre><h3 id="ä¿ç•™åˆ†æ”¯ä¿¡æ¯"><a href="#ä¿ç•™åˆ†æ”¯ä¿¡æ¯" class="headerlink" title="ä¿ç•™åˆ†æ”¯ä¿¡æ¯"></a>ä¿ç•™åˆ†æ”¯ä¿¡æ¯</h3><p>åœ¨ä¸åŒåˆ†æ”¯åˆå¹¶æ—¶ä½¿ç”¨ <code>--no-ff</code> å‚æ•°ç”Ÿæˆmerge commit</p>
<pre><code>commit e562022b423f7bf29f77927dea4d13cb05230681
Merge: d88f815 799b7f8
Author: æ¨æ™“è¾° &lt;yangxiaochen@yangxiaochendemacbook-pro.local&gt;
Date:   Tue May 31 17:10:41 2016 +0800

    Merge branch &apos;feature/welcome&apos; into develop

commit 799b7f87b99d5f5c49acf2edd8a6a363ff44f29f
Author: æ¨æ™“è¾° &lt;yangxiaochen@yangxiaochendemacbook-pro.local&gt;
Date:   Tue May 31 17:10:11 2016 +0800

    ä¹Ÿä¿®æ”¹auth

commit 18e7893f1583559003f7a4bb41fd03b937b3ed42
Author: æ¨æ™“è¾° &lt;yangxiaochen@yangxiaochendemacbook-pro.local&gt;
Date:   Tue May 31 17:08:04 2016 +0800

    ä¿®æ”¹ auth
</code></pre><h3 id="å‡å°‘ä»¥åŠæ¶ˆé™¤æ— æ„ä¹‰çš„åˆ†æ”¯å†…merge"><a href="#å‡å°‘ä»¥åŠæ¶ˆé™¤æ— æ„ä¹‰çš„åˆ†æ”¯å†…merge" class="headerlink" title="å‡å°‘ä»¥åŠæ¶ˆé™¤æ— æ„ä¹‰çš„åˆ†æ”¯å†…merge"></a>å‡å°‘ä»¥åŠæ¶ˆé™¤æ— æ„ä¹‰çš„åˆ†æ”¯å†…merge</h3><p>åŒä¸€åˆ†æ”¯æ›´æ–°æ—¶è¦é¿å…äº§ç”Ÿæ— æ„ä¹‰çš„merge</p>
<p>å¦‚æœæ˜¯ä¸€ä¸ªäººä½¿ç”¨git-flow, ä½ ä¼šå‘ç°ä½ æ‰€æœ‰çš„commitä»¥åŠcommit logéƒ½æ˜¯æœ‰æ„ä¹‰çš„. ä½ æ‰€æœ‰çš„æ›´æ”¹, featureåˆå¹¶éƒ½æ˜¯æœ‰æ˜ç¡®è®°å½•çš„.</p>
<p>ä½†æ˜¯åœ¨å¤šäººä½¿ç”¨ä¸‹, å¤§å®¶å„è‡ªåœ¨æœ¬åœ°å¼€å‘, å¾€developåˆ†æ”¯ä¸Šmerge, é‚£ä¹ˆå°±ä¼šå‡ºç°æ¯ä¸ªäººçš„developåˆ†æ”¯ä¸ä¸€è‡´. é‚£ä¹ˆå½“ä¸€ä¸ªäººæŠŠè‡ªå·±çš„developåˆ†æ”¯pushåˆ°è¿œç«¯æ—¶, å…¶ä»–äººpullçš„æ—¶å€™å°±ä¼šå‡ºç°åˆ†æ”¯åˆå¹¶, äº§ç”Ÿ â€œMerge branch â€˜developâ€™ of remote into developâ€ çš„ç±»ä¼¼commit. </p>
<p>å¾ˆå¤šæ—¶å€™, åˆå¹¶æ—¶æ²¡æœ‰å†²çª, è‡ªåŠ¨å®Œæˆ. è¿™ç§mergeäº§ç”Ÿçš„commitæ˜¯æ²¡æœ‰æ„ä¹‰çš„, è€Œä¸”ä¼šè®©åˆ†æ”¯çœ‹èµ·æ¥æ··ä¹±.</p>
<p>æŒ‰ç…§ä»¥ä¸‹è§„åˆ™å¯ä»¥å‡å°‘ç”šè‡³æ¶ˆé™¤è¿™ç§æ— æ„ä¹‰çš„commit:</p>
<ol>
<li>æœ¬åœ°åœ¨å¾€developåˆ†æ”¯è¿›è¡Œåˆå¹¶æ—¶, <strong> <code>å…ˆåœ¨developä¸Šæ‰§è¡Œgit pull</code> </strong>, å½“ä½ æ²¡æœ‰åœ¨æœ¬åœ°å¯¹developåˆ†æ”¯æœ‰commitæ—¶, æ‰§è¡Œ<code>git pull</code>æ˜¯ä¼šå‘ç”ŸFast-forwardåˆå¹¶çš„, è¿™ç§é»˜è®¤å¹¶ä¸äº§ç”Ÿcommit.</li>
<li>å°†featureåˆå¹¶åˆ°developä¸Š.</li>
<li>push develop. å°†ä½ çš„ä¿®æ”¹æäº¤åˆ°è¿œç«¯.</li>
</ol>
<p>å¤šæ•°æ—¶å€™, å¦‚æœå¤šä¸ªäººåˆ†å¼€æ‰§è¡Œä»¥ä¸Šæ“ä½œ, æ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„.</p>
<p>å¦‚æœå¤šä¸ªäººåŒæ—¶è¿›è¡Œä»¥ä¸Šæ“ä½œ, é‚£ä¹ˆåœ¨è¿›è¡Œç¬¬ä¸‰æ­¥çš„æ—¶å€™, æ˜¯pushä¸ä¸Šå»çš„, éœ€è¦å…ˆpull, é‚£ä¹ˆåˆä¼šäº§ç”Ÿæ‰€è°“çš„æ— æ„ä¹‰commit, è¯¥æ€ä¹ˆåŠå‘¢:</p>
<p>è¿™æ—¶ä¸è¦ç”¨<code>git pull</code>æ¥æ‹‰å–æ›´æ”¹, æ”¹ä¸ºä½¿ç”¨:</p>
<pre><code>git pull --rebase
</code></pre><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†è¿œç«¯ä»£developæ‹‰ä¸‹æ¥, ç„¶åä»æœ¬åœ°developä¸Šè·Ÿè¿œç«¯developåˆ†å‰çš„åœ°æ–¹å¼€å§‹, å°†æœ¬åœ°çš„commitä¸€ä¸ªä¸ªåº”ç”¨åˆ°è¿œç«¯developçš„æœ«ç«¯, ä½¿ä¹‹æˆä¸ºä¸€æ¡ç›´çº¿, ä»è€Œæ²¡æœ‰äº†merge commit.</p>
<p>å…³äºå†²çª, rebaseçš„æ—¶å€™ä¹Ÿä¼šæœ‰å†²çª:</p>
<p>æ¯”å¦‚è¿œç«¯ <code>a-&gt;b-&gt;c</code></p>
<p>ä½ çš„ <code>a-&gt;b-&gt;d</code></p>
<p>è¿›è¡Œrebaseä¹‹å <code>a-&gt;b-&gt;c-&gt;e</code>, å…¶ä¸­<code>e</code>çš„æ›´æ”¹å†…å®¹å’Œlogå°±æ˜¯ä½ çš„<code>d</code>, å¦‚æœæœ‰å†²çª, å†²çªçš„ä¿®æ”¹ä¹Ÿæ˜¯æç°åœ¨<code>e</code>ä¸­</p>
<h3 id="å†²çªæäº¤"><a href="#å†²çªæäº¤" class="headerlink" title="å†²çªæäº¤"></a>å†²çªæäº¤</h3><p>ä¿®æ”¹å®Œå†²çª, æˆ‘ä»¬ä¼šè¿›è¡Œcommitæäº¤å†²çªä¿®æ”¹. <strong>ä¸è¦ä½¿ç”¨<code>git commit -m</code>, è¯·ç›´æ¥ä½¿ç”¨<code>git commit</code>, gitä¼šè¯†åˆ«ä½ è¿™æ˜¯ä¸€ä¸ªå†²çªæäº¤.</strong></p>
<h3 id="å¸¸ç”¨æ“ä½œ"><a href="#å¸¸ç”¨æ“ä½œ" class="headerlink" title="å¸¸ç”¨æ“ä½œ"></a>å¸¸ç”¨æ“ä½œ</h3><p>å›æ»š<br>    git reset â€“hard [version]  // ä¸¢å¼ƒç‰ˆæœ¬åçš„æ‰€æœ‰ä¿®æ”¹<br>    git reset [version]         // ä¿ç•™ç‰ˆæœ¬åçš„æ‰€æœ‰å·²æäº¤ä¿®æ”¹<br>    git reset â€“soft [version]  // ä¿ç•™ç‰ˆæœ¬åçš„æ‰€æœ‰å·²æäº¤ä¿®æ”¹åˆ°commit stage</p>
<p>è¡¥å……æäº¤</p>
<pre><code>git commit --amend
</code></pre><p>æäº¤tagåˆ°æœåŠ¡å™¨</p>
<pre><code>git push origin --tags
</code></pre><p>æ—¥å¿—ä¸diff</p>
<pre><code>sourcetree // è½¯ä»¶
</code></pre><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="http://nvie.com/posts/a-successful-git-branching-model/" target="_blank" rel="external">http://nvie.com/posts/a-successful-git-branching-model/</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2015/12/git-workflow.html" target="_blank" rel="external">Git å·¥ä½œæµç¨‹</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2015/08/git-use-process.html" target="_blank" rel="external">åˆå¹¶commit</a></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://blog.yangxiaochen.com/2016/06/12/git/git-flow-in-action/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Michael">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="æŠ€æœ¯è®°äº‹æœ¬">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/06/12/git/git-flow-in-action/" itemprop="url">æœªå‘½å</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              
              <time title="åˆ›å»ºäº" itemprop="dateCreated datePublished" datetime="2016-06-12T12:05:08+08:00">
                2016-06-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>+++<br>date = â€œ2016-06-12T13:52:32+08:00â€<br>draft = false<br>title = â€œgit-flowå®è·µâ€<br>categories = [ â€œgitâ€ ]<br>type=â€gitâ€<br>payable=â€trueâ€<br>+++</p>
<h1 id="git-flow-æ“ä½œå®è·µ"><a href="#git-flow-æ“ä½œå®è·µ" class="headerlink" title="git-flow æ“ä½œå®è·µ"></a>git-flow æ“ä½œå®è·µ</h1><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><pre><code>brew install git-flow
</code></pre><h2 id="init"><a href="#init" class="headerlink" title="init"></a>init</h2><pre><code>$ git flow init

Initialized empty Git repository in ~/project/.git/
No branches exist yet. Base branches must be created now.
Branch name for production releases: [master]
Branch name for &quot;next release&quot; development: [develop]

How to name your supporting branch prefixes?
Feature branches? [feature/]
Release branches? [release/]
Hotfix branches? [hotfix/]
Support branches? [support/]
Version tag prefix? []
</code></pre><p>è¿™æ—¶ä¼šåœ¨å½“å‰ç›®å½•æ‰§è¡Œgit initæ“ä½œ. å¹¶ä¸”ç”Ÿæˆ4ä¸ªåˆ†æ”¯åå­—, å¹¶ä¸”é»˜è®¤åœ¨developåˆ†æ”¯ä¸Š, developåˆ†æ”¯å°±æ˜¯æˆ‘ä»¬ä¸»è¦å·¥ä½œçš„åœ°æ–¹.</p>
<pre><code>$ git branch
* develop
master
</code></pre><p>æˆ‘ä»¬é™¤äº†è¦æŠŠmasteråˆ†æ”¯æ¨åˆ°è¿œç«¯ä»“åº“, developåŒæ ·ä¹Ÿè¦æ¨åˆ°è¿œç«¯ä»“åº“ <code>git push origin develop</code></p>
<h2 id="Feature-branches"><a href="#Feature-branches" class="headerlink" title="Feature branches"></a>Feature branches</h2><p>å¼€å§‹ä¸€ä¸ªæ–°åŠŸèƒ½æ·»åŠ , æˆ–è€…æ˜¯ä¸€èˆ¬bugä¿®å¤, æˆ–è€…æ˜¯å…¶ä»–åŠŸèƒ½. æˆ‘ä»¬éœ€è¦å¼€ä¸€ä¸ªfeatureåˆ†æ”¯. æˆ‘ä»¬åœ¨æœ¬åœ°çš„ä¸»è¦å·¥ä½œéƒ½æ˜¯è¦å¼€featureåˆ†æ”¯å®Œæˆçš„. <strong> ä¸è¦åœ¨develop åˆ†æ”¯ä¸Šå¼€å‘. </strong></p>
<pre><code>$ git flow feature start authentication
Switched to a new branch &apos;feature/authentication&apos;

Summary of actions:
- A new branch &apos;feature/authentication&apos; was created, based on &apos;develop&apos;
- You are now on branch &apos;feature/authentication&apos;

Now, start committing on your feature. When done, use:

    git flow feature finish authentication
</code></pre><p>ç„¶åä½ å¯ä»¥åšè‡ªå·±çš„ä¿®æ”¹äº†, å®Œæˆå, éœ€è¦å°†featureåˆå¹¶å›developåˆ†æ”¯.</p>
<pre><code>$ git flow feature finish authentication
Switched to branch &apos;develop&apos;
Updating 9060376..00bafe4
Fast-forward
authentication.txt | 1 +
1 file changed, 1 insertion(+)
create mode 100644 authentication.txt
Deleted branch feature/authentication (was 00bafe4).

Summary of actions:
- The feature branch &apos;feature/authentication&apos; was merged into &apos;develop&apos;
- Feature branch &apos;feature/authentication&apos; has been removed
- You are now on branch &apos;develop&apos;
</code></pre><blockquote>
<p>å¤šä¸ªå¼€å‘è€…è¿›è¡Œå¼€å‘æ—¶, ä¼šå‡ºç°æ¯ä¸ªäººæœ¬åœ°çš„developåˆ†æ”¯ä¸ä¸€è‡´çš„æƒ…å†µ, è¿™æ ·åœ¨æ¯æ¬¡æ‹‰å–è¿œç«¯developåˆ†æ”¯æ—¶, ä¼šå‡ºç°å¾ˆå¤šmergeæäº¤. å…³äºè¿™ä¸ªé—®é¢˜, åœ¨æœ€åçš„<code>å‡å°‘ä»¥åŠæ¶ˆç­æ— ç”¨çš„merge commit</code>ç« èŠ‚ä¸­è¯´æ˜.</p>
</blockquote>
<h2 id="releases"><a href="#releases" class="headerlink" title="releases"></a>releases</h2><p>åœ¨æ²¡æœ‰ä½¿ç”¨git-flowå·¥å…·æ—¶, å‘å¸ƒæ˜¯ä¸€ä»¶å¾ˆç¹ççš„äº‹æƒ…, è¦ä¿ç•™ä¸€ä¸ªç”¨äºreleasesçš„åˆ†æ”¯, æ‰“tagç­‰. ä½¿ç”¨git-flowå¯ä»¥ç”¨ç®€å•å‘½ä»¤è§£å†³.</p>
<pre><code>$ git flow release start 0.1.0
Switched to a new branch &apos;release/0.1.0&apos;

Summary of actions:
- A new branch &apos;release/0.1.0&apos; was created, based on &apos;develop&apos;
- You are now on branch &apos;release/0.1.0&apos;

Follow-up actions:
- Bump the version number now!
- Start committing last-minute fixes in preparing your release
- When done, run:

    git flow release finish &apos;0.1.0&apos; 
</code></pre><p>ä½ å°†å¼€å§‹ä¸€ä¸ªå‘å¸ƒ, ä¸€èˆ¬å¯ä»¥ç›´æ¥finishi</p>
<pre><code>$ git flow release finish 0.1.0
Switched to branch &apos;master&apos;
Merge made by the &apos;recursive&apos; strategy.
authentication.txt | 1 +
1 file changed, 1 insertion(+)
create mode 100644 authentication.txt
Deleted branch release/0.1.0 (was 1b26f7c).

Summary of actions:
- Latest objects have been fetched from &apos;origin&apos;
- Release branch has been merged into &apos;master&apos;
- The release was tagged &apos;0.1.0&apos;
- Release branch has been back-merged into &apos;develop&apos;
- Release branch &apos;release/0.1.0&apos; has been deleted
</code></pre><p>è¿™æ—¶developåˆ†æ”¯å›åˆå¹¶åˆ°masteråˆ†æ”¯, å¹¶æ‰“tag. ä¹‹åæˆ‘ä»¬åªè¦æŠŠmasterå’Œtagéƒ½æ¨åˆ°è¿œç«¯ä»“åº“å³å¯.</p>
<h2 id="Hotfixing-production-code"><a href="#Hotfixing-production-code" class="headerlink" title="Hotfixing production code"></a>Hotfixing production code</h2><p>ç´§æ€¥bugä¿®å¤, åœ¨å·²ç»å‘å¸ƒçš„ä»£ç ä¸Šæ›´æ­£. ä¼šä»masterå¼€å‡ºhotfixåˆ†æ”¯, ç„¶ååˆå¹¶å›master, ä¹Ÿä¼šåˆå¹¶å›develop.</p>
<pre><code>$ git flow hotfix start assets
Switched to a new branch &apos;hotfix/assets&apos;

Summary of actions:
- A new branch &apos;hotfix/assets&apos; was created, based on &apos;master&apos;
- You are now on branch &apos;hotfix/assets&apos;

Follow-up actions:
- Bump the version number now!
- Start committing your hot fixes
- When done, run:

    git flow hotfix finish &apos;assets&apos;
</code></pre><p>ç„¶åä¿®æ”¹é—®é¢˜, ä¹‹åæäº¤:</p>
<pre><code>$ git flow hotfix finish assets
Switched to branch &apos;master&apos;
Merge made by the &apos;recursive&apos; strategy.
assets.txt | 1 +
1 file changed, 1 insertion(+)
create mode 100644 assets.txt
Switched to branch &apos;develop&apos;
Merge made by the &apos;recursive&apos; strategy.
assets.txt | 1 +
1 file changed, 1 insertion(+)
create mode 100644 assets.txt
Deleted branch hotfix/assets (was 08edb94).

Summary of actions:
- Latest objects have been fetched from &apos;origin&apos;
- Hotfix branch has been merged into &apos;master&apos;
- The hotfix was tagged &apos;0.1.1&apos;
- Hotfix branch has been back-merged into &apos;develop&apos;
- Hotfix branch &apos;hotfix/assets&apos; has been deleted
</code></pre><blockquote>
<p>åœ¨å¾€ä¸‹é˜…è¯»ä¹‹å‰, ä½ æœ€å¥½å°†ä»¥ä¸Šçš„å‘½ä»¤å®è·µä¸€é, æ„Ÿå—git-flowçš„æ“ä½œä¸åˆ†æ”¯æµå‘. æ¨èSourceTreeæ¥è·Ÿè¸ªå˜åŒ–.</p>
</blockquote>
<h2 id="å‡å°‘ä»¥åŠæ¶ˆç­æ— ç”¨çš„merge-commit"><a href="#å‡å°‘ä»¥åŠæ¶ˆç­æ— ç”¨çš„merge-commit" class="headerlink" title="å‡å°‘ä»¥åŠæ¶ˆç­æ— ç”¨çš„merge commit"></a>å‡å°‘ä»¥åŠæ¶ˆç­æ— ç”¨çš„merge commit</h2><p>å¦‚æœæ˜¯ä¸€ä¸ªäººä½¿ç”¨git-flow, ä½ ä¼šå‘ç°ä½ æ‰€æœ‰çš„commitä»¥åŠcommit logéƒ½æ˜¯æœ‰æ„ä¹‰çš„. ä½ æ‰€æœ‰çš„æ›´æ”¹, featureåˆå¹¶éƒ½æ˜¯æœ‰æ˜ç¡®è®°å½•çš„.</p>
<p>ä½†æ˜¯åœ¨å¤šäººä½¿ç”¨ä¸‹, å¤§å®¶å„è‡ªåœ¨æœ¬åœ°å¼€å‘, å¾€developåˆ†æ”¯ä¸Šmerge, é‚£ä¹ˆå°±ä¼šå‡ºç°æ¯ä¸ªäººçš„developåˆ†æ”¯ä¸ä¸€è‡´. é‚£ä¹ˆå½“ä¸€ä¸ªäººæŠŠè‡ªå·±çš„developåˆ†æ”¯pushåˆ°è¿œç«¯æ—¶, å…¶ä»–äººpullçš„æ—¶å€™å°±ä¼šå‡ºç°åˆ†æ”¯åˆå¹¶, äº§ç”Ÿ â€œMerge branch â€˜developâ€™ of remote into developâ€ çš„ç±»ä¼¼commit. </p>
<p>å¾ˆå¤šæ—¶å€™, åˆå¹¶æ—¶æ²¡æœ‰å†²çª, è‡ªåŠ¨å®Œæˆ. è¿™ç§mergeäº§ç”Ÿçš„commitæ˜¯æ²¡æœ‰æ„ä¹‰çš„, è€Œä¸”ä¼šè®©åˆ†æ”¯çœ‹èµ·æ¥æ··ä¹±.</p>
<p>æŒ‰ç…§ä»¥ä¸‹è§„åˆ™å¯ä»¥å‡å°‘ç”šè‡³æ¶ˆé™¤è¿™ç§æ— æ„ä¹‰çš„commit:</p>
<ol>
<li>æœ¬åœ°åœ¨å¾€developåˆ†æ”¯è¿›è¡Œåˆå¹¶æ—¶, <strong> <code>å…ˆåœ¨developä¸Šæ‰§è¡Œgit pull</code> </strong>, å½“ä½ æ²¡æœ‰åœ¨æœ¬åœ°å¯¹developåˆ†æ”¯æœ‰commitæ—¶, æ‰§è¡Œ<code>git pull</code>æ˜¯ä¼šå‘ç”ŸFast-forwardåˆå¹¶çš„, è¿™ç§é»˜è®¤å¹¶ä¸äº§ç”Ÿcommit.</li>
<li>å°†featureåˆå¹¶åˆ°developä¸Š.</li>
<li>push develop. å°†ä½ çš„ä¿®æ”¹æäº¤åˆ°è¿œç«¯.</li>
</ol>
<p>å¤šæ•°æ—¶å€™, å¦‚æœå¤šä¸ªäººåˆ†å¼€æ‰§è¡Œä»¥ä¸Šæ“ä½œ, æ˜¯ä¸ä¼šæœ‰é—®é¢˜çš„.</p>
<p>å¦‚æœå¤šä¸ªäººåŒæ—¶è¿›è¡Œä»¥ä¸Šæ“ä½œ, é‚£ä¹ˆåœ¨è¿›è¡Œç¬¬ä¸‰æ­¥çš„æ—¶å€™, æ˜¯pushä¸ä¸Šå»çš„, éœ€è¦å…ˆpull, é‚£ä¹ˆåˆä¼šäº§ç”Ÿæ‰€è°“çš„æ— æ„ä¹‰commit, è¯¥æ€ä¹ˆåŠå‘¢:</p>
<p>è¿™æ—¶ä¸è¦ç”¨<code>git pull</code>æ¥æ‹‰å–æ›´æ”¹, æ”¹ä¸ºä½¿ç”¨:</p>
<pre><code>git pull --rebase
</code></pre><p>è¿™ä¸ªå‘½ä»¤ä¼šå°†è¿œç«¯ä»£developæ‹‰ä¸‹æ¥, ç„¶åä»æœ¬åœ°developä¸Šè·Ÿè¿œç«¯developåˆ†å‰çš„åœ°æ–¹å¼€å§‹, å°†æœ¬åœ°çš„commitä¸€ä¸ªä¸ªåº”ç”¨åˆ°è¿œç«¯developçš„æœ«ç«¯, ä½¿ä¹‹æˆä¸ºä¸€æ¡ç›´çº¿, ä»è€Œæ²¡æœ‰äº†merge commit.</p>
<p>å…³äºå†²çª, rebaseçš„æ—¶å€™ä¹Ÿä¼šæœ‰å†²çª:</p>
<p>æ¯”å¦‚è¿œç«¯ <code>a-&gt;b-&gt;c</code></p>
<p>ä½ çš„ <code>a-&gt;b-&gt;d</code></p>
<p>è¿›è¡Œrebaseä¹‹å <code>a-&gt;b-&gt;c-&gt;e</code>, å…¶ä¸­<code>e</code>çš„æ›´æ”¹å†…å®¹å’Œlogå°±æ˜¯ä½ çš„<code>d</code>, å¦‚æœæœ‰å†²çª, å†²çªçš„ä¿®æ”¹ä¹Ÿæ˜¯æç°åœ¨<code>e</code>ä¸­</p>
<blockquote>
<p>ä¿®æ”¹å®Œå†²çª, æˆ‘ä»¬ä¼šè¿›è¡Œcommitæäº¤å†²çªä¿®æ”¹. <strong>ä¸è¦ä½¿ç”¨<code>git commit -m</code>, è¯·ç›´æ¥ä½¿ç”¨<code>git commit</code>, gitä¼šè¯†åˆ«ä½ è¿™æ˜¯ä¸€ä¸ªå†²çªæäº¤.</strong></p>
<p>å½“ç„¶, æ“ä½œçš„ç–å¿½ä¾ç„¶ä¼šäº§ç”Ÿæ— æ„ä¹‰çš„commit, ä½†è¿™å¹¶ä¸è‡´å‘½, æ³¨æ„å°±å¥½.</p>
<p>å¦‚æœçœŸçš„è¦æ¶ˆç­æ— æ„ä¹‰commit: åœ¨ä½ <code>git pull</code>ä¹‹åå‘ç°è‡ªåŠ¨åˆå¹¶äº†, é‚£ä¹ˆç”¨<code>git reset --hard [åˆšåˆšä½ æœ¬åœ°çš„æäº¤commit version]</code>è¿›è¡Œæœ¬åœ°ç‰ˆæœ¬å›æ»š, ç„¶åå†<code>git pull --rebase</code></p>
<p>æˆ‘å¯¹rebaseçš„ç†è§£ä¹Ÿä¸æ˜¯å¾ˆå¤š, ä»¥ä¸Šåªæ˜¯åº”ç”¨ä¸­çš„ä½¿ç”¨ä½“ä¼š, è‚¯å®šè¿˜å­˜åœ¨å¾ˆå¤šæ²¡æœ‰æƒ³åˆ°çš„æƒ…å†µå’Œå¤„ç†ä¸å½“çš„åœ°æ–¹, è¯·å¤§å®¶å¤šæå‡ºæ¥æŒ‡æ­£, å…±åŒè®¨è®º.</p>
</blockquote>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><ul>
<li><a href="http://jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/" target="_blank" rel="external">http://jeffkreeftmeijer.com/2010/why-arent-you-using-git-flow/</a></li>
<li><a href="https://git-scm.com/book/zh/v1/Git-åˆ†æ”¯-åˆ†æ”¯çš„è¡åˆ" target="_blank" rel="external">https://git-scm.com/book/zh/v1/Git-åˆ†æ”¯-åˆ†æ”¯çš„è¡åˆ</a></li>
</ul>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Michael" />
          <p class="site-author-name" itemprop="name">Michael</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">38</span>
                <span class="site-state-item-name">æ—¥å¿—</span>
              </a>
            </div>
          

          

          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Michael</span>
</div>


<div class="powered-by">
  ç”± <a class="theme-link" href="https://hexo.io">Hexo</a> å¼ºåŠ›é©±åŠ¨
</div>

<div class="theme-info">
  ä¸»é¢˜ -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Muse
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>
