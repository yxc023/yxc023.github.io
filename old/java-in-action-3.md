+++
date = "2016-04-19T23:47:32+08:00"
draft = false
title = "Java开发实践(三. 配置趋势--Programmatically)"
categories = [ "java" ]
type="java"
payable="true"
+++


以spring的配置为例, 我们习惯于applicationContext.xml配置.

诚然, 软件开发的配置经历了 `硬编码 -> 配置文件` 这个过程. 开发人员在不需要更改代码重新编译, 就可以修改配置信息.

然而, 这也带来了一些问题, 就是xml的泛滥. 对于复杂的项目, 面对一堆xml, 我们会发现:

    1. 这些xml的内容并不好读. 标记语言结构冗长, 可读性差.
    2. 谁使用了这些配置. 这些配置是被谁加载的, 如何使用的, 追根麻烦.
    3. 对照费劲. 当你代码中使用一个bean, 需要翻看每一个xml文件来寻找这个bean. (虽然有IDE可以帮助查找)
    4. 配置文件书写复杂. 很多ide并没有补全提示, 你需要记住会用到什么标签, 以及属性.
    5. ...
<!-- more -->

对于spring的一些配置文件来说, 其实是把一些逻辑给加入到配置文件当中了. 比如配置切面, 比如配置访问控制等. 这势必会造成程序的不易理解, 因为代码语法固定, 大家都很熟悉, 但是配置文件就不是了, 而且来回翻看容易混乱.

## Programmatically配置

> 用代码的方式来做配置. JAVA-BASED. 对各个组件的注入声明, 构建初始化, 采用代码的方式来做. 目前Spring中有一些JAVA-BASED配置的相关章节.

有人会说了, 你这就是硬编码了! 容我解释:

    1. 对于bean, 业务, 各种组件的加载, 初始化. 使用Programmatically的方式来做配置.
    2. 用一个`application.yaml`来作为配置属性的存放.
    3. `application.yaml`拥有多个`application.[env].yaml`的覆盖版本, 用来在不同环境覆盖配置.`application.[env].yaml`可以只是`application.yaml`内容的一部分. 使用构建脚本如gradle来实现覆盖逻辑, 或者在Programmatically配置时实现覆盖逻辑.
    4. `application.yaml`存放所有配置参数. 如各种服务端口, 组件是否加载, 组件的加载参数等等...

所以, 我们不是硬编码, 我们把不易变得部分进行了代码化, 使程序员易读, 理解其中加载细节, 同时, 使IDE跳转查找更加方便.

另外, yaml文件的易读性要比xml好很多, 配置属性查找方便.

配置覆盖策略保证各个环境运行的便捷性.

## 配合注解

Programmatically配置, 合理配合注解, 也可以实现很多更简便的配置.

## 不完全抛弃xml

事实上, 一般能用xml配置的框架或者项目或者类库, 都可以用代码来实现配置. 如果不行, 引入xml也是可以的.

> 我们的目的就是减少xml, 使用更纯粹的配置方式, 统一配置信息入口. 易懂, 易读, 易查.

> spring-boot就有点这种配置的感觉, 我在之前项目中应用了一些也感觉良好, 所以有理有据推荐~ 饱含实践经验.
